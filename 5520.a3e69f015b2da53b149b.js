/*! For license information please see 5520.a3e69f015b2da53b149b.js.LICENSE.txt */
(("undefined"!=typeof self?self:this).webpackChunk_subwallet_sub_connect=("undefined"!=typeof self?self:this).webpackChunk_subwallet_sub_connect||[]).push([[5520],{5520:(t,e,n)=>{"use strict";n.d(e,{sequence:()=>Am});var r={};n.r(r),n.d(r,{walletContracts:()=>b});var i={};n.r(i),n.d(i,{API:()=>T,SequenceAPIClient:()=>R,SmartRampOrderStatus:()=>k,SmartRampTxnStatus:()=>C,SortOrder:()=>N,WebRPCSchemaHash:()=>A,WebRPCSchemaVersion:()=>I,WebRPCVersion:()=>E});var s={};n.r(s);var o={};n.r(o);var a={};n.r(a),n.d(a,{OG:()=>Ji,My:()=>Gi,Ph:()=>qi,lX:()=>ji,Id:()=>zi,fg:()=>Xi,qj:()=>Ki,aT:()=>Vi,lq:()=>Wi,z:()=>Hi,Q5:()=>ts});var c={};n.r(c),n.d(c,{Logger:()=>Ll,base64Decode:()=>Nl,base64DecodeObject:()=>Tl,base64Encode:()=>kl,base64EncodeObject:()=>Cl,checkProperties:()=>Xl,configureLogger:()=>Fl,deepCopy:()=>th,defineReadOnly:()=>Jl,encodeMessageDigest:()=>Ol,encodeTypedDataDigest:()=>zl,encodeTypedDataHash:()=>Kl,getRandomInt:()=>Gl,getStatic:()=>Yl,isBigNumberish:()=>nh,isBrowser:()=>_l,isNode:()=>Rl,jwtDecodeClaims:()=>Pl,logger:()=>Ml,packMessageData:()=>xl,promisify:()=>Dl,queryStringFromObject:()=>$l,queryStringToObject:()=>Vl,resolveProperties:()=>Zl,sanitizeAlphanumeric:()=>jl,sanitizeHost:()=>Wl,sanitizeNumberString:()=>ql,shallowCopy:()=>Ql,sleep:()=>Hl,subDigestOf:()=>Sl,urlClean:()=>eh});var l={};n.r(l),n.d(l,{Multicall:()=>mh,providers:()=>bh});var h={};n.r(h),n.d(h,{ConfigFinder:()=>Lh,SequenceUtilsFinder:()=>Fh,SignatureType:()=>jh,WalletContractBytecode:()=>vh,addressOf:()=>xh,buildStubSignature:()=>tu,compareAddr:()=>Ph,createWalletConfig:()=>Nh,decodeSignature:()=>Wh,editConfig:()=>Bh,encodeSignature:()=>Zh,genConfig:()=>Uh,imageHash:()=>Sh,isConfigEqual:()=>_h,isDecodedAddress:()=>Dh,isDecodedEOASigner:()=>$h,isDecodedEOASplitSigner:()=>Vh,isDecodedFullSigner:()=>qh,isDecodedSigner:()=>Gh,isUsableConfig:()=>Th,isValidConfigSigners:()=>Oh,joinSignatures:()=>Jh,joinTwoSignatures:()=>Yh,mutateSignature:()=>Qh,recoverEOASigner:()=>zh,signerOf:()=>Xh,sortConfig:()=>Rh,splitDecodedEOASigner:()=>Kh});var u={};n.r(u),n.d(u,{ContractType:()=>su,EventLogDataType:()=>au,EventLogType:()=>ou,Indexer:()=>du,SequenceIndexerClient:()=>yu,SequenceIndexerServices:()=>gu,SortOrder:()=>uu,TransactionStatus:()=>lu,TransactionType:()=>hu,TxnTransferType:()=>cu,WebRPCSchemaHash:()=>iu,WebRPCSchemaVersion:()=>ru,WebRPCVersion:()=>nu});var d={};n.r(d),n.d(d,{ContractType:()=>Iu,Metadata:()=>Nu,PropertyType:()=>Au,SequenceMetadataClient:()=>Su,SortOrder:()=>Cu,SwapType:()=>ku,WebRPCSchemaHash:()=>Eu,WebRPCSchemaVersion:()=>vu,WebRPCVersion:()=>bu});var f={};n.r(f),n.d(f,{MetaTransactionsType:()=>Zu,appendNonce:()=>ud,computeMetaTxnHash:()=>nd,decodeNonce:()=>gd,digestOfTransactions:()=>td,digestOfTransactionsNonce:()=>ed,encodeNonce:()=>pd,flattenAuxTransactions:()=>id,fromTransactionish:()=>yd,hasSequenceTransactions:()=>cd,isAsyncSendable:()=>od,isSequenceTransaction:()=>ad,isSignedTransactions:()=>md,makeAfterNonce:()=>fd,makeExpirable:()=>dd,packMetaTransactionsData:()=>Xu,packMetaTransactionsNonceData:()=>Qu,readSequenceNonce:()=>ld,sequenceTxAbiEncode:()=>hd,toSequenceTransaction:()=>sd,toSequenceTransactions:()=>rd});var p={};n.r(p),n.d(p,{Guard:()=>Wd,WebRPCSchemaHash:()=>jd,WebRPCSchemaVersion:()=>qd,WebRPCVersion:()=>Vd});var g={};n.r(g),n.d(g,{BaseRelayer:()=>Zd,BaseRelayerDefaults:()=>Yd,LocalRelayer:()=>rf,ProviderRelayer:()=>ef,ProviderRelayerDefaults:()=>Qd,RpcRelayer:()=>yf,RpcRelayerProto:()=>df,isBaseRelayerOptions:()=>Jd,isLocalRelayerOptions:()=>nf,isProviderRelayerOptions:()=>tf,isRelayer:()=>bf,isRpcRelayerOptions:()=>gf,proto:()=>df});var m={};n.r(m),n.d(m,{AuthError:()=>Df,DEFAULT_SESSION_EXPIRATION:()=>Pf,ErrAccountIsRequired:()=>Gf,LONG_SESSION_EXPIRATION:()=>Bf,Session:()=>Uf,ValidateSequenceDeployedWalletProof:()=>$f,ValidateSequenceUndeployedWalletProof:()=>Vf,signAuthorization:()=>Ff});var y={};n.r(y),n.d(y,{AllowProvider:()=>vp,CachedProvider:()=>Ip,ChainId:()=>ip,EagerProvider:()=>Ap,JsonRpcExternalProvider:()=>bp,JsonRpcProvider:()=>Rp,JsonRpcRouter:()=>fp,JsonRpcSender:()=>wp,JsonRpcVersion:()=>dp,PublicProvider:()=>xp,SigningProvider:()=>Op,SingleflightMiddleware:()=>Sp,allowProviderMiddleware:()=>Ep,checkNetworkConfig:()=>tp,createJsonRpcMiddlewareStack:()=>pp,ensureUniqueNetworks:()=>Yf,ensureValidNetworks:()=>Jf,exceptionProviderMiddleware:()=>kp,findNetworkConfig:()=>Qf,getAuthNetwork:()=>Kf,getChainId:()=>Wf,indexerURL:()=>sp,isJsonRpcHandler:()=>mp,isJsonRpcProvider:()=>gp,isNetworkConfig:()=>jf,isValidNetworkConfig:()=>zf,loggingProviderMiddleware:()=>Cp,mainnetNetworks:()=>lp,maybeChainId:()=>Hf,networkProviderMiddleware:()=>Np,networks:()=>cp,networksIndex:()=>ep,nodesURL:()=>ap,relayerURL:()=>op,sequenceContext:()=>up,sortNetworks:()=>np,stringTemplate:()=>rp,testnetNetworks:()=>hp,updateNetworkConfig:()=>Zf,validateAndSortNetworks:()=>Xf});var w={};n.r(w),n.d(w,{BaseInjectedTransport:()=>Yg,BaseProviderTransport:()=>dg,BaseWalletTransport:()=>Fg,CHANNEL_ID:()=>Kg,DefaultProviderConfig:()=>im,ErrSignedInRequired:()=>cg,EventType:()=>ig,ExtensionMessageHandler:()=>zg,ExtensionMessageProvider:()=>Jg,InitState:()=>og,LocalStorage:()=>Ug,LocalStore:()=>Lg,LocalWeb3Provider:()=>yg,MuxMessageProvider:()=>qg,OpenState:()=>sg,PROVIDER_OPEN_TIMEOUT:()=>lg,ProviderError:()=>ag,ProxyMessageChannel:()=>Dg,ProxyMessageChannelPort:()=>Gg,ProxyMessageHandler:()=>Vg,ProxyMessageProvider:()=>$g,UnrealMessageHandler:()=>em,UnrealMessageProvider:()=>tm,Wallet:()=>rm,WalletRequestHandler:()=>fg,Web3Provider:()=>gg,Web3Signer:()=>wg,WindowMessageHandler:()=>Hg,WindowMessageProvider:()=>Wg,WindowSessionParams:()=>rg,getWallet:()=>cm,initWallet:()=>om,isBrowserExtension:()=>_g,isSequenceProvider:()=>mg,isUnityPlugin:()=>Pg,isValidMessageSignature:()=>xg,isValidSignature:()=>Og,isValidTypedDataSignature:()=>Sg,isWalletUpToDate:()=>Bg,messageToBytes:()=>Ng,nextMessageIdx:()=>ug,prefixEIP191Message:()=>Tg,recoverWalletConfig:()=>Rg,unregisterWallet:()=>am});const b={erc1271:Object.freeze({__proto__:null,abi:[{type:"function",name:"isValidSignature",constant:!0,inputs:[{type:"bytes32"},{type:"bytes"}],outputs:[{type:"bytes4"}],payable:!1,stateMutability:"view"}],returns:{isValidSignatureBytes32:"0x1626ba7e"}}),factory:Object.freeze({__proto__:null,abi:[{type:"function",name:"deploy",constant:!1,inputs:[{type:"address"},{type:"bytes32"}],outputs:[],payable:!0,stateMutability:"payable"}]}),mainModule:Object.freeze({__proto__:null,abi:[{type:"function",name:"nonce",constant:!0,inputs:[],outputs:[{type:"uint256"}],payable:!1,stateMutability:"view"},{type:"function",name:"readNonce",constant:!0,inputs:[{type:"uint256"}],outputs:[{type:"uint256"}],payable:!1,stateMutability:"view"},{type:"function",name:"updateImplementation",constant:!1,inputs:[{type:"address"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"selfExecute",constant:!1,inputs:[{components:[{type:"bool",name:"delegateCall"},{type:"bool",name:"revertOnError"},{type:"uint256",name:"gasLimit"},{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"data"}],type:"tuple[]"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"execute",constant:!1,inputs:[{components:[{type:"bool",name:"delegateCall"},{type:"bool",name:"revertOnError"},{type:"uint256",name:"gasLimit"},{type:"address",name:"target"},{type:"uint256",name:"value"},{type:"bytes",name:"data"}],type:"tuple[]"},{type:"uint256"},{type:"bytes"}],outputs:[],payable:!1,stateMutability:"nonpayable"},{type:"function",name:"createContract",inputs:[{type:"bytes"}],payable:!0,stateMutability:"payable"}]}),mainModuleUpgradable:Object.freeze({__proto__:null,abi:[{type:"function",name:"updateImageHash",constant:!0,inputs:[{type:"bytes32"}],outputs:[],payable:!1,stateMutability:"view"},{type:"function",name:"imageHash",constant:!0,inputs:[],outputs:[{type:"bytes32"}],payable:!1,stateMutability:"view"}]}),sequenceUtils:Object.freeze({__proto__:null,abi:[{inputs:[{internalType:"address",name:"_factory",type:"address"},{internalType:"address",name:"_mainModule",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_wallet",type:"address"},{indexed:!0,internalType:"bytes32",name:"_imageHash",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"_threshold",type:"uint256"},{indexed:!1,internalType:"bytes",name:"_signers",type:"bytes"}],name:"RequiredConfig",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_wallet",type:"address"},{indexed:!0,internalType:"address",name:"_signer",type:"address"}],name:"RequiredSigner",type:"event"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callBalanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callBlockNumber",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_i",type:"uint256"}],name:"callBlockhash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"callChainId",outputs:[{internalType:"uint256",name:"id",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCode",outputs:[{internalType:"bytes",name:"code",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCodeHash",outputs:[{internalType:"bytes32",name:"codeHash",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"callCodeSize",outputs:[{internalType:"uint256",name:"size",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callCoinbase",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"callDifficulty",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasLeft",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasLimit",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callGasPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"callOrigin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"callTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"knownImageHashes",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"lastImageHashUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"lastSignerUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"lastWalletUpdate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bool",name:"delegateCall",type:"bool"},{internalType:"bool",name:"revertOnError",type:"bool"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct IModuleCalls.Transaction[]",name:"_txs",type:"tuple[]"}],name:"multiCall",outputs:[{internalType:"bool[]",name:"_successes",type:"bool[]"},{internalType:"bytes[]",name:"_results",type:"bytes[]"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"uint256",name:"_threshold",type:"uint256"},{components:[{internalType:"uint256",name:"weight",type:"uint256"},{internalType:"address",name:"signer",type:"address"}],internalType:"struct RequireUtils.Member[]",name:"_members",type:"tuple[]"},{internalType:"bool",name:"_index",type:"bool"}],name:"publishConfig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"bytes32",name:"_hash",type:"bytes32"},{internalType:"uint256",name:"_sizeMembers",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"},{internalType:"bool",name:"_index",type:"bool"}],name:"publishInitialSigners",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_wallet",type:"address"},{internalType:"uint256",name:"_nonce",type:"uint256"}],name:"requireMinNonce",outputs:[],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_expiration",type:"uint256"}],name:"requireNonExpired",outputs:[],stateMutability:"view",type:"function"}]}),requireFreshSigner:Object.freeze({__proto__:null,abi:[{inputs:[{internalType:"address",name:"",type:"address"}],name:"requireFreshSigner",outputs:[],stateMutability:"nonpayable",type:"function"}]})};function v(){return v=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v.apply(this,arguments)}const E="v1",I="v0.4.0",A="e4aaaf3a3c07a1f339226fcac3b8addcb3120c7b";let k,C,N;!function(t){t.UNKNOWN="UNKNOWN",t.RUNNING_CHECKS="RUNNING_CHECKS",t.PROCESSING="PROCESSING",t.FAILED="FAILED",t.COMPLETE="COMPLETE"}(k||(k={})),function(t){t.UNKNOWN="UNKNOWN",t.SUCCESSFUL="SUCCESSFUL",t.FAILED="FAILED"}(C||(C={})),function(t){t.DESC="DESC",t.ASC="ASC"}(N||(N={}));class T{constructor(t,e){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/API/",this.ping=t=>this.fetch(this.url("Ping"),O({},t)).then(t=>x(t).then(t=>({status:t.status}))),this.version=t=>this.fetch(this.url("Version"),O({},t)).then(t=>x(t).then(t=>({version:t.version}))),this.runtimeStatus=t=>this.fetch(this.url("RuntimeStatus"),O({},t)).then(t=>x(t).then(t=>({status:t.status}))),this.getSequenceContext=t=>this.fetch(this.url("GetSequenceContext"),O({},t)).then(t=>x(t).then(t=>({data:t.data}))),this.getAuthToken=(t,e)=>this.fetch(this.url("GetAuthToken"),O(t,e)).then(t=>x(t).then(t=>({status:t.status,jwtToken:t.jwtToken,address:t.address,user:t.user}))),this.sendPasswordlessLink=(t,e)=>this.fetch(this.url("SendPasswordlessLink"),O(t,e)).then(t=>x(t).then(t=>({status:t.status}))),this.friendList=(t,e)=>this.fetch(this.url("FriendList"),O(t,e)).then(t=>x(t).then(t=>({page:t.page,friends:t.friends}))),this.getFriendByAddress=(t,e)=>this.fetch(this.url("GetFriendByAddress"),O(t,e)).then(t=>x(t).then(t=>({status:t.status,friend:t.friend}))),this.searchFriends=(t,e)=>this.fetch(this.url("SearchFriends"),O(t,e)).then(t=>x(t).then(t=>({friends:t.friends}))),this.addFriend=(t,e)=>this.fetch(this.url("AddFriend"),O(t,e)).then(t=>x(t).then(t=>({status:t.status,friend:t.friend}))),this.updateFriendNickname=(t,e)=>this.fetch(this.url("UpdateFriendNickname"),O(t,e)).then(t=>x(t).then(t=>({status:t.status,friend:t.friend}))),this.removeFriend=(t,e)=>this.fetch(this.url("RemoveFriend"),O(t,e)).then(t=>x(t).then(t=>({status:t.status}))),this.contractCall=(t,e)=>this.fetch(this.url("ContractCall"),O(t,e)).then(t=>x(t).then(t=>({returns:t.returns}))),this.decodeContractCall=(t,e)=>this.fetch(this.url("DecodeContractCall"),O(t,e)).then(t=>x(t).then(t=>({call:t.call}))),this.lookupContractCallSelectors=(t,e)=>this.fetch(this.url("LookupContractCallSelectors"),O(t,e)).then(t=>x(t).then(t=>({signatures:t.signatures}))),this.userStorageFetch=(t,e)=>this.fetch(this.url("UserStorageFetch"),O(t,e)).then(t=>x(t).then(t=>({object:t.object}))),this.userStorageSave=(t,e)=>this.fetch(this.url("UserStorageSave"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok}))),this.userStorageDelete=(t,e)=>this.fetch(this.url("UserStorageDelete"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok}))),this.userStorageFetchAll=(t,e)=>this.fetch(this.url("UserStorageFetchAll"),O(t,e)).then(t=>x(t).then(t=>({objects:t.objects}))),this.getMoonpayLink=(t,e)=>this.fetch(this.url("GetMoonpayLink"),O(t,e)).then(t=>x(t).then(t=>({signedUrl:t.signedUrl}))),this.getSardineClientToken=t=>this.fetch(this.url("GetSardineClientToken"),O({},t)).then(t=>x(t).then(t=>({token:t.token}))),this.isUsingGoogleMail=(t,e)=>this.fetch(this.url("IsUsingGoogleMail"),O(t,e)).then(t=>x(t).then(t=>({yes:t.yes}))),this.resolveENSAddress=(t,e)=>this.fetch(this.url("ResolveENSAddress"),O(t,e)).then(t=>x(t).then(t=>({address:t.address,ok:t.ok}))),this.isValidSignature=(t,e)=>this.fetch(this.url("IsValidSignature"),O(t,e)).then(t=>x(t).then(t=>({isValid:t.isValid}))),this.isValidMessageSignature=(t,e)=>this.fetch(this.url("IsValidMessageSignature"),O(t,e)).then(t=>x(t).then(t=>({isValid:t.isValid}))),this.isValidTypedDataSignature=(t,e)=>this.fetch(this.url("IsValidTypedDataSignature"),O(t,e)).then(t=>x(t).then(t=>({isValid:t.isValid}))),this.isValidETHAuthProof=(t,e)=>this.fetch(this.url("IsValidETHAuthProof"),O(t,e)).then(t=>x(t).then(t=>({isValid:t.isValid}))),this.getCoinPrices=(t,e)=>this.fetch(this.url("GetCoinPrices"),O(t,e)).then(t=>x(t).then(t=>({tokenPrices:t.tokenPrices}))),this.getCollectiblePrices=(t,e)=>this.fetch(this.url("GetCollectiblePrices"),O(t,e)).then(t=>x(t).then(t=>({tokenPrices:t.tokenPrices}))),this.getExchangeRate=(t,e)=>this.fetch(this.url("GetExchangeRate"),O(t,e)).then(t=>x(t).then(t=>({exchangeRate:t.exchangeRate}))),this.memoryStore=(t,e)=>this.fetch(this.url("MemoryStore"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok}))),this.memoryLoad=(t,e)=>this.fetch(this.url("MemoryLoad"),O(t,e)).then(t=>x(t).then(t=>({value:t.value}))),this.listPayCardsOnFile=t=>this.fetch(this.url("ListPayCardsOnFile"),O({},t)).then(t=>x(t).then(t=>({payCards:t.payCards}))),this.savePayCard=(t,e)=>this.fetch(this.url("SavePayCard"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok,payCard:t.payCard}))),this.updatePayCardCVC=(t,e)=>this.fetch(this.url("UpdatePayCardCVC"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok}))),this.deletePayCard=(t,e)=>this.fetch(this.url("DeletePayCard"),O(t,e)).then(t=>x(t).then(t=>({ok:t.ok}))),this.smartRampQuote=(t,e)=>this.fetch(this.url("SmartRampQuote"),O(t,e)).then(t=>x(t).then(t=>({status:t.status,quoteDetails:t.quoteDetails}))),this.smartRampPurchase=(t,e)=>this.fetch(this.url("SmartRampPurchase"),O(t,e)).then(t=>x(t).then(t=>({processing:t.processing,receipt:t.receipt}))),this.smartRampWaitOrderConfirmation=(t,e)=>this.fetch(this.url("SmartRampWaitOrderConfirmation"),O(t,e)).then(t=>x(t).then(t=>({done:t.done,receipt:t.receipt}))),this.smartRampGetOrder=(t,e)=>this.fetch(this.url("SmartRampGetOrder"),O(t,e)).then(t=>x(t).then(t=>({order:t.order}))),this.smartRampCheckCardAuthorization=(t,e)=>this.fetch(this.url("SmartRampCheckCardAuthorization"),O(t,e)).then(t=>x(t).then(t=>({cardAuth:t.cardAuth}))),this.smartRampOrdersList=(t,e)=>this.fetch(this.url("SmartRampOrdersList"),O(t,e)).then(t=>x(t).then(t=>({page:t.page,orders:t.orders}))),this.smartRampGetOrderTxnHash=(t,e)=>this.fetch(this.url("SmartRampGetOrderTxnHash"),O(t,e)).then(t=>x(t).then(t=>({txnHash:t.txnHash,txnSuccessful:t.txnSuccessful}))),this.smartRampSubmitCardAuthorization=(t,e)=>this.fetch(this.url("SmartRampSubmitCardAuthorization"),O(t,e)).then(t=>x(t).then(t=>({status:t.status}))),this.adminSmartRampGetOrder=(t,e)=>this.fetch(this.url("AdminSmartRampGetOrder"),O(t,e)).then(t=>x(t).then(t=>({order:t.order}))),this.adminSmartRampListCompletedOrders=(t,e)=>this.fetch(this.url("AdminSmartRampListCompletedOrders"),O(t,e)).then(t=>x(t).then(t=>({orders:t.orders}))),this.adminSmartRampListPendingOrders=(t,e)=>this.fetch(this.url("AdminSmartRampListPendingOrders"),O(t,e)).then(t=>x(t).then(t=>({pendingOrders:t.pendingOrders}))),this.getInviteInfo=t=>this.fetch(this.url("GetInviteInfo"),O({},t)).then(t=>x(t).then(t=>({inviteInfo:t.inviteInfo}))),this.isValidAccessCode=(t,e)=>this.fetch(this.url("IsValidAccessCode"),O(t,e)).then(t=>x(t).then(t=>({status:t.status}))),this.internalClaimAccessCode=(t,e)=>this.fetch(this.url("InternalClaimAccessCode"),O(t,e)).then(t=>x(t).then(t=>({status:t.status}))),this.walletRecover=(t,e)=>this.fetch(this.url("WalletRecover"),O(t,e)).then(t=>x(t).then(t=>({encryptedWallet:t.encryptedWallet}))),this.blockNumberAtTime=(t,e)=>this.fetch(this.url("BlockNumberAtTime"),O(t,e)).then(t=>x(t).then(t=>({blocks:t.blocks}))),this.paperSessionSecret=(t,e)=>this.fetch(this.url("PaperSessionSecret"),O(t,e)).then(t=>x(t).then(t=>({secret:t.secret}))),this.paperSessionSecret2=(t,e)=>this.fetch(this.url("PaperSessionSecret2"),O(t,e)).then(t=>x(t).then(t=>({secret:t.secret}))),this.hostname=t,this.fetch=(t,n)=>e(t,n)}url(t){return this.hostname+this.path+t}}const O=(t={},e={})=>({method:"POST",headers:v({},e,{"Content-Type":"application/json"}),body:JSON.stringify(t||{})}),x=t=>t.text().then(e=>{let n;try{n=JSON.parse(e)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${e}`,status:t.status}}if(!t.ok)throw n;return n}),S="object"==typeof n.g?n.g.fetch:window.fetch;class R extends T{constructor(t,e){super(t.endsWith("/")?t.slice(0,-1):t,S),this.jwtAuth=e,this._fetch=(t,e)=>{const n={};return this.jwtAuth&&this.jwtAuth.length>0&&(n.Authorization=`BEARER ${this.jwtAuth}`),e.headers=v({},e.headers,n),S(t,e)},this.fetch=this._fetch}}const _="6.15.0";function P(t,e,n){const r=e.split("|").map(t=>t.trim());for(let n=0;n<r.length;n++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${n}`,i.value=t,i}async function B(t){const e=Object.keys(t);return(await Promise.all(e.map(e=>Promise.resolve(t[e])))).reduce((t,n,r)=>(t[e[r]]=n,t),{})}function U(t,e,n){for(let r in e){let i=e[r];const s=n?n[r]:null;s&&P(i,s,r),Object.defineProperty(t,r,{enumerable:!0,value:i,writable:!1})}}function L(t,e){if(null==t)return"null";if(null==e&&(e=new Set),"object"==typeof t){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(t=>L(t,e)).join(", ")+" ]";if(t instanceof Uint8Array){const e="0123456789abcdef";let n="0x";for(let r=0;r<t.length;r++)n+=e[t[r]>>4],n+=e[15&t[r]];return n}if("object"==typeof t&&"function"==typeof t.toJSON)return L(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const n=Object.keys(t);return n.sort(),"{ "+n.map(n=>`${L(n,e)}: ${L(t[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function M(t,e){return t&&t.code===e}function F(t){return M(t,"CALL_EXCEPTION")}function D(t,e,n){let r,i=t;{const r=[];if(n){if("message"in n||"code"in n||"name"in n)throw new Error(`value will overwrite populated values: ${L(n)}`);for(const t in n){if("shortMessage"===t)continue;const e=n[t];r.push(t+"="+L(e))}}r.push(`code=${e}`),r.push(`version=${_}`),r.length&&(t+=" ("+r.join(", ")+")")}switch(e){case"INVALID_ARGUMENT":r=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":r=new RangeError(t);break;default:r=new Error(t)}return U(r,{code:e}),n&&Object.assign(r,n),null==r.shortMessage&&U(r,{shortMessage:i}),r}function G(t,e,n,r){if(!t)throw D(e,n,r)}function $(t,e,n,r){G(t,e,"INVALID_ARGUMENT",{argument:n,value:r})}function V(t,e,n){null==n&&(n=""),n&&(n=": "+n),G(t>=e,"missing argument"+n,"MISSING_ARGUMENT",{count:t,expectedCount:e}),G(t<=e,"too many arguments"+n,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}const q=["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test"!=="test".normalize(e))throw new Error("bad");if("NFD"===e){if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken")}t.push(e)}catch(t){}return t},[]);function j(t){G(q.indexOf(t)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:t}})}function W(t,e,n){if(null==n&&(n=""),t!==e){let t=n,e="new";n&&(t+=".",e+=" "+n),G(!1,`private constructor; use ${t}from* methods`,"UNSUPPORTED_OPERATION",{operation:e})}}const H={};function K(t,e){let n=!1;return e<0&&(n=!0,e*=-1),new Y(H,`${n?"":"u"}int${e}`,t,{signed:n,width:e})}function z(t,e){return new Y(H,`bytes${e||""}`,t,{size:e})}const J=Symbol.for("_ethers_typed");class Y{type;value;#t;_typedSymbol;constructor(t,e,n,r){null==r&&(r=null),W(H,t,"Typed"),U(this,{_typedSymbol:J,type:e,value:n}),this.#t=r,this.format()}format(){if("array"===this.type)throw new Error("");if("dynamicArray"===this.type)throw new Error("");return"tuple"===this.type?`tuple(${this.value.map(t=>t.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return"string"===this.type}get tupleName(){if("tuple"!==this.type)throw TypeError("not a tuple");return this.#t}get arrayLength(){if("array"!==this.type)throw TypeError("not an array");return!0===this.#t?-1:!1===this.#t?this.value.length:null}static from(t,e){return new Y(H,t,e)}static uint8(t){return K(t,8)}static uint16(t){return K(t,16)}static uint24(t){return K(t,24)}static uint32(t){return K(t,32)}static uint40(t){return K(t,40)}static uint48(t){return K(t,48)}static uint56(t){return K(t,56)}static uint64(t){return K(t,64)}static uint72(t){return K(t,72)}static uint80(t){return K(t,80)}static uint88(t){return K(t,88)}static uint96(t){return K(t,96)}static uint104(t){return K(t,104)}static uint112(t){return K(t,112)}static uint120(t){return K(t,120)}static uint128(t){return K(t,128)}static uint136(t){return K(t,136)}static uint144(t){return K(t,144)}static uint152(t){return K(t,152)}static uint160(t){return K(t,160)}static uint168(t){return K(t,168)}static uint176(t){return K(t,176)}static uint184(t){return K(t,184)}static uint192(t){return K(t,192)}static uint200(t){return K(t,200)}static uint208(t){return K(t,208)}static uint216(t){return K(t,216)}static uint224(t){return K(t,224)}static uint232(t){return K(t,232)}static uint240(t){return K(t,240)}static uint248(t){return K(t,248)}static uint256(t){return K(t,256)}static uint(t){return K(t,256)}static int8(t){return K(t,-8)}static int16(t){return K(t,-16)}static int24(t){return K(t,-24)}static int32(t){return K(t,-32)}static int40(t){return K(t,-40)}static int48(t){return K(t,-48)}static int56(t){return K(t,-56)}static int64(t){return K(t,-64)}static int72(t){return K(t,-72)}static int80(t){return K(t,-80)}static int88(t){return K(t,-88)}static int96(t){return K(t,-96)}static int104(t){return K(t,-104)}static int112(t){return K(t,-112)}static int120(t){return K(t,-120)}static int128(t){return K(t,-128)}static int136(t){return K(t,-136)}static int144(t){return K(t,-144)}static int152(t){return K(t,-152)}static int160(t){return K(t,-160)}static int168(t){return K(t,-168)}static int176(t){return K(t,-176)}static int184(t){return K(t,-184)}static int192(t){return K(t,-192)}static int200(t){return K(t,-200)}static int208(t){return K(t,-208)}static int216(t){return K(t,-216)}static int224(t){return K(t,-224)}static int232(t){return K(t,-232)}static int240(t){return K(t,-240)}static int248(t){return K(t,-248)}static int256(t){return K(t,-256)}static int(t){return K(t,-256)}static bytes1(t){return z(t,1)}static bytes2(t){return z(t,2)}static bytes3(t){return z(t,3)}static bytes4(t){return z(t,4)}static bytes5(t){return z(t,5)}static bytes6(t){return z(t,6)}static bytes7(t){return z(t,7)}static bytes8(t){return z(t,8)}static bytes9(t){return z(t,9)}static bytes10(t){return z(t,10)}static bytes11(t){return z(t,11)}static bytes12(t){return z(t,12)}static bytes13(t){return z(t,13)}static bytes14(t){return z(t,14)}static bytes15(t){return z(t,15)}static bytes16(t){return z(t,16)}static bytes17(t){return z(t,17)}static bytes18(t){return z(t,18)}static bytes19(t){return z(t,19)}static bytes20(t){return z(t,20)}static bytes21(t){return z(t,21)}static bytes22(t){return z(t,22)}static bytes23(t){return z(t,23)}static bytes24(t){return z(t,24)}static bytes25(t){return z(t,25)}static bytes26(t){return z(t,26)}static bytes27(t){return z(t,27)}static bytes28(t){return z(t,28)}static bytes29(t){return z(t,29)}static bytes30(t){return z(t,30)}static bytes31(t){return z(t,31)}static bytes32(t){return z(t,32)}static address(t){return new Y(H,"address",t)}static bool(t){return new Y(H,"bool",!!t)}static bytes(t){return new Y(H,"bytes",t)}static string(t){return new Y(H,"string",t)}static array(t,e){throw new Error("not implemented yet")}static tuple(t,e){throw new Error("not implemented yet")}static overrides(t){return new Y(H,"overrides",Object.assign({},t))}static isTyped(t){return t&&"object"==typeof t&&"_typedSymbol"in t&&t._typedSymbol===J}static dereference(t,e){if(Y.isTyped(t)){if(t.type!==e)throw new Error(`invalid type: expecetd ${e}, got ${t.type}`);return t.value}return t}}function Z(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function X(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Q(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Z(t.outputLen),Z(t.blockLen)}function tt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function et(t,e){X(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const nt=BigInt(2**32-1),rt=BigInt(32);function it(t,e=!1){return e?{h:Number(t&nt),l:Number(t>>rt&nt)}:{h:0|Number(t>>rt&nt),l:0|Number(t&nt)}}function st(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:o}=it(t[i],e);[n[i],r[i]]=[s,o]}return[n,r]}const ot=(t,e,n)=>t<<n|e>>>32-n,at=(t,e,n)=>e<<n|t>>>32-n,ct=(t,e,n)=>e<<n-32|t>>>64-n,lt=(t,e,n)=>t<<n-32|e>>>64-n,ht={fromBig:it,split:st,toBig:(t,e)=>BigInt(t>>>0)<<rt|BigInt(e>>>0),shrSH:(t,e,n)=>t>>>n,shrSL:(t,e,n)=>t<<32-n|e>>>n,rotrSH:(t,e,n)=>t>>>n|e<<32-n,rotrSL:(t,e,n)=>t<<32-n|e>>>n,rotrBH:(t,e,n)=>t<<64-n|e>>>n-32,rotrBL:(t,e,n)=>t>>>n-32|e<<64-n,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:ot,rotlSL:at,rotlBH:ct,rotlBL:lt,add:function(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}},add3L:(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),add3H:(t,e,n,r)=>e+n+r+(t/2**32|0)|0,add4L:(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),add4H:(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0,add5H:(t,e,n,r,i,s)=>e+n+r+i+s+(t/2**32|0)|0,add5L:(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0)},ut="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,dt=t=>t instanceof Uint8Array,ft=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),pt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),gt=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");const mt=async()=>{};async function yt(t,e,n){let r=Date.now();for(let i=0;i<t;i++){n(i);const t=Date.now()-r;t>=0&&t<e||(await mt(),r+=t)}}function wt(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!dt(t))throw new Error("expected Uint8Array, got "+typeof t);return t}class bt{clone(){return this._cloneInto()}}const vt={}.toString;function Et(t,e){if(void 0!==e&&"[object Object]"!==vt.call(e))throw new Error("Options should be object or undefined");return Object.assign(t,e)}function It(t){const e=e=>t().update(wt(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function At(t=32){if(ut&&"function"==typeof ut.getRandomValues)return ut.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}const[kt,Ct,Nt]=[[],[],[]],Tt=BigInt(0),Ot=BigInt(1),xt=BigInt(2),St=BigInt(7),Rt=BigInt(256),_t=BigInt(113);for(let t=0,e=Ot,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],kt.push(2*(5*r+n)),Ct.push((t+1)*(t+2)/2%64);let i=Tt;for(let t=0;t<7;t++)e=(e<<Ot^(e>>St)*_t)%Rt,e&xt&&(i^=Ot<<(Ot<<BigInt(t))-Ot);Nt.push(i)}const[Pt,Bt]=st(Nt,!0),Ut=(t,e,n)=>n>32?ct(t,e,n):ot(t,e,n),Lt=(t,e,n)=>n>32?lt(t,e,n):at(t,e,n);class Mt extends bt{constructor(t,e,n,r=!1,i=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Z(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ft(this.state)}keccak(){!function(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let e=0;e<10;e++)n[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const r=(e+8)%10,i=(e+2)%10,s=n[i],o=n[i+1],a=Ut(s,o,1)^n[r],c=Lt(s,o,1)^n[r+1];for(let n=0;n<50;n+=10)t[e+n]^=a,t[e+n+1]^=c}let e=t[2],i=t[3];for(let n=0;n<24;n++){const r=Ct[n],s=Ut(e,i,r),o=Lt(e,i,r),a=kt[n];e=t[a],i=t[a+1],t[a]=s,t[a+1]=o}for(let e=0;e<50;e+=10){for(let r=0;r<10;r++)n[r]=t[e+r];for(let r=0;r<10;r++)t[e+r]^=~n[(r+2)%10]&n[(r+4)%10]}t[0]^=Pt[r],t[1]^=Bt[r]}n.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){tt(this);const{blockLen:e,state:n}=this,r=(t=wt(t)).length;for(let i=0;i<r;){const s=Math.min(e-this.pos,r-i);for(let e=0;e<s;e++)n[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:r}=this;t[n]^=e,128&e&&n===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){tt(this,!1),X(t),this.finish();const e=this.state,{blockLen:n}=this;for(let r=0,i=t.length;r<i;){this.posOut>=n&&this.keccak();const s=Math.min(n-this.posOut,i-r);t.set(e.subarray(this.posOut,this.posOut+s),r),this.posOut+=s,r+=s}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Z(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(et(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:r,rounds:i,enableXOF:s}=this;return t||(t=new Mt(e,n,r,s,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=r,t.enableXOF=s,t.destroyed=this.destroyed,t}}const Ft=((t,e,n)=>It(()=>new Mt(e,t,n)))(1,136,32);function Dt(t,e,n){if(t instanceof Uint8Array)return n?new Uint8Array(t):t;if("string"==typeof t&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const e=new Uint8Array((t.length-2)/2);let n=2;for(let r=0;r<e.length;r++)e[r]=parseInt(t.substring(n,n+2),16),n+=2;return e}$(!1,"invalid BytesLike value",e||"value",t)}function Gt(t,e){return Dt(t,e,!1)}function $t(t,e){return Dt(t,e,!0)}function Vt(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/)||"number"==typeof e&&t.length!==2+2*e||!0===e&&t.length%2!=0)}function qt(t){return Vt(t,!0)||t instanceof Uint8Array}const jt="0123456789abcdef";function Wt(t){const e=Gt(t);let n="0x";for(let t=0;t<e.length;t++){const r=e[t];n+=jt[(240&r)>>4]+jt[15&r]}return n}function Ht(t){return"0x"+t.map(t=>Wt(t).substring(2)).join("")}function Kt(t){return Vt(t,!0)?(t.length-2)/2:Gt(t).length}function zt(t,e,n){const r=Gt(t);return null!=n&&n>r.length&&G(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:n}),Wt(r.slice(null==e?0:e,null==n?r.length:n))}function Jt(t,e,n){const r=Gt(t);G(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),n?i.set(r,e-r.length):i.set(r,0),Wt(i)}function Yt(t,e){return Jt(t,e,!0)}let Zt=!1;const Xt=function(t){return Ft(t)};let Qt=Xt;function te(t){const e=Gt(t,"data");return Wt(Qt(e))}function ee(t,e,n,r,i){if("BAD_PREFIX"===t||"UNEXPECTED_CONTINUE"===t){let t=0;for(let r=e+1;r<n.length&&n[r]>>6==2;r++)t++;return t}return"OVERRUN"===t?n.length-e-1:0}te._=Xt,te.lock=function(){Zt=!0},te.register=function(t){if(Zt)throw new TypeError("keccak256 is locked");Qt=t},Object.freeze(te);const ne=Object.freeze({error:function(t,e,n,r,i){$(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",n)},ignore:ee,replace:function(t,e,n,r,i){return"OVERLONG"===t?($("number"==typeof i,"invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),ee(t,e,n))}});function re(t,e){$("string"==typeof t,"invalid string value","str",t),null!=e&&(j(e),t=t.normalize(e));let n=[];for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(r<128)n.push(r);else if(r<2048)n.push(r>>6|192),n.push(63&r|128);else if(55296==(64512&r)){e++;const i=t.charCodeAt(e);$(e<t.length&&56320==(64512&i),"invalid surrogate pair","str",t);const s=65536+((1023&r)<<10)+(1023&i);n.push(s>>18|240),n.push(s>>12&63|128),n.push(s>>6&63|128),n.push(63&s|128)}else n.push(r>>12|224),n.push(r>>6&63|128),n.push(63&r|128)}return new Uint8Array(n)}function ie(t,e){return function(t,e){null==e&&(e=ne.error);const n=Gt(t,"bytes"),r=[];let i=0;for(;i<n.length;){const t=n[i++];if(!(t>>7)){r.push(t);continue}let s=null,o=null;if(192==(224&t))s=1,o=127;else if(224==(240&t))s=2,o=2047;else{if(240!=(248&t)){i+=e(128==(192&t)?"UNEXPECTED_CONTINUE":"BAD_PREFIX",i-1,n,r);continue}s=3,o=65535}if(i-1+s>=n.length){i+=e("OVERRUN",i-1,n,r);continue}let a=t&(1<<8-s-1)-1;for(let t=0;t<s;t++){let t=n[i];if(128!=(192&t)){i+=e("MISSING_CONTINUE",i,n,r),a=null;break}a=a<<6|63&t,i++}null!==a&&(a>1114111?i+=e("OUT_OF_RANGE",i-1-s,n,r,a):a>=55296&&a<=57343?i+=e("UTF16_SURROGATE",i-1-s,n,r,a):a<=o?i+=e("OVERLONG",i-1-s,n,r,a):r.push(a))}return r}(t,e).map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10&1023),56320+(1023&t)))).join("")}function se(t){return te(re(t))}const oe=BigInt(0),ae=BigInt(1),ce=9007199254740991;function le(t,e){let n=ue(t,"value");const r=BigInt(ge(e,"width")),i=ae<<r-ae;return n<oe?(n=-n,G(n<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),(~n&(ae<<r)-ae)+ae):(G(n<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t}),n)}function he(t,e){const n=de(t,"value"),r=BigInt(ge(e,"bits"));return n&(ae<<r)-ae}function ue(t,e){switch(typeof t){case"bigint":return t;case"number":return $(Number.isInteger(t),"underflow",e||"value",t),$(t>=-ce&&t<=ce,"overflow",e||"value",t),BigInt(t);case"string":try{if(""===t)throw new Error("empty string");return"-"===t[0]&&"-"!==t[1]?-BigInt(t.substring(1)):BigInt(t)}catch(n){$(!1,`invalid BigNumberish string: ${n.message}`,e||"value",t)}}$(!1,"invalid BigNumberish value",e||"value",t)}function de(t,e){const n=ue(t,e);return G(n>=oe,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),n}const fe="0123456789abcdef";function pe(t){if(t instanceof Uint8Array){let e="0x0";for(const n of t)e+=fe[n>>4],e+=fe[15&n];return BigInt(e)}return ue(t)}function ge(t,e){switch(typeof t){case"bigint":return $(t>=-ce&&t<=ce,"overflow",e||"value",t),Number(t);case"number":return $(Number.isInteger(t),"underflow",e||"value",t),$(t>=-ce&&t<=ce,"overflow",e||"value",t),t;case"string":try{if(""===t)throw new Error("empty string");return ge(BigInt(t),e)}catch(n){$(!1,`invalid numeric string: ${n.message}`,e||"value",t)}}$(!1,"invalid numeric value",e||"value",t)}function me(t,e){let n=de(t,"value").toString(16);if(null==e)n.length%2&&(n="0"+n);else{const r=ge(e,"width");for(G(2*r>=n.length,`value exceeds width (${r} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});n.length<2*r;)n="0"+n}return"0x"+n}function ye(t){const e=de(t,"value");if(e===oe)return new Uint8Array([]);let n=e.toString(16);n.length%2&&(n="0"+n);const r=new Uint8Array(n.length/2);for(let t=0;t<r.length;t++){const e=2*t;r[t]=parseInt(n.substring(e,e+2),16)}return r}const we=32,be=new Uint8Array(we),ve=["then"],Ee={},Ie=new WeakMap;function Ae(t){return Ie.get(t)}function ke(t,e){Ie.set(t,e)}function Ce(t,e){const n=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw n.error=e,n}function Ne(t,e,n){return t.indexOf(null)>=0?e.map((t,e)=>t instanceof Te?Ne(Ae(t),t,n):t):t.reduce((t,r,i)=>{let s=e.getValue(r);return r in t||(n&&s instanceof Te&&(s=Ne(Ae(s),s,n)),t[r]=s),t},{})}class Te extends Array{#e;constructor(...t){const e=t[0];let n=t[1],r=(t[2]||[]).slice(),i=!0;e!==Ee&&(n=t,r=[],i=!1),super(n.length),n.forEach((t,e)=>{this[e]=t});const s=r.reduce((t,e)=>("string"==typeof e&&t.set(e,(t.get(e)||0)+1),t),new Map);if(ke(this,Object.freeze(n.map((t,e)=>{const n=r[e];return null!=n&&1===s.get(n)?n:null}))),this.#e=[],null==this.#e&&this.#e,!i)return;Object.freeze(this);const o=new Proxy(this,{get:(t,e,n)=>{if("string"==typeof e){if(e.match(/^[0-9]+$/)){const n=ge(e,"%index");if(n<0||n>=this.length)throw new RangeError("out of result range");const r=t[n];return r instanceof Error&&Ce(`index ${n}`,r),r}if(ve.indexOf(e)>=0)return Reflect.get(t,e,n);const r=t[e];if(r instanceof Function)return function(...e){return r.apply(this===n?t:this,e)};if(!(e in t))return t.getValue.apply(this===n?t:this,[e])}return Reflect.get(t,e,n)}});return ke(o,Ae(this)),o}toArray(t){const e=[];return this.forEach((n,r)=>{n instanceof Error&&Ce(`index ${r}`,n),t&&n instanceof Te&&(n=n.toArray(t)),e.push(n)}),e}toObject(t){const e=Ae(this);return e.reduce((n,r,i)=>(G(null!=r,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),Ne(e,this,t)),{})}slice(t,e){null==t&&(t=0),t<0&&(t+=this.length)<0&&(t=0),null==e&&(e=this.length),e<0&&(e+=this.length)<0&&(e=0),e>this.length&&(e=this.length);const n=Ae(this),r=[],i=[];for(let s=t;s<e;s++)r.push(this[s]),i.push(n[s]);return new Te(Ee,r,i)}filter(t,e){const n=Ae(this),r=[],i=[];for(let s=0;s<this.length;s++){const o=this[s];o instanceof Error&&Ce(`index ${s}`,o),t.call(e,o,s,this)&&(r.push(o),i.push(n[s]))}return new Te(Ee,r,i)}map(t,e){const n=[];for(let r=0;r<this.length;r++){const i=this[r];i instanceof Error&&Ce(`index ${r}`,i),n.push(t.call(e,i,r,this))}return n}getValue(t){const e=Ae(this).indexOf(t);if(-1===e)return;const n=this[e];return n instanceof Error&&Ce(`property ${JSON.stringify(t)}`,n.error),n}static fromItems(t,e){return new Te(Ee,t,e)}}function Oe(t){let e=ye(t);return G(e.length<=we,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:we,offset:e.length}),e.length!==we&&(e=$t(Ht([be.slice(e.length%we),e]))),e}class xe{name;type;localName;dynamic;constructor(t,e,n,r){U(this,{name:t,type:e,localName:n,dynamic:r},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(t,e){$(!1,t,this.localName,e)}}class Se{#n;#r;constructor(){this.#n=[],this.#r=0}get data(){return Ht(this.#n)}get length(){return this.#r}#i(t){return this.#n.push(t),this.#r+=t.length,t.length}appendWriter(t){return this.#i($t(t.data))}writeBytes(t){let e=$t(t);const n=e.length%we;return n&&(e=$t(Ht([e,be.slice(n)]))),this.#i(e)}writeValue(t){return this.#i(Oe(t))}writeUpdatableValue(){const t=this.#n.length;return this.#n.push(be),this.#r+=we,e=>{this.#n[t]=Oe(e)}}}class Re{allowLoose;#n;#s;#o;#a;#c;constructor(t,e,n){U(this,{allowLoose:!!e}),this.#n=$t(t),this.#o=0,this.#a=null,this.#c=null!=n?n:1024,this.#s=0}get data(){return Wt(this.#n)}get dataLength(){return this.#n.length}get consumed(){return this.#s}get bytes(){return new Uint8Array(this.#n)}#l(t){if(this.#a)return this.#a.#l(t);this.#o+=t,G(this.#c<1||this.#o<=this.#c*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#c} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:$t(this.#n),offset:this.#s,length:t,info:{bytesRead:this.#o,dataLength:this.dataLength}})}#h(t,e,n){let r=Math.ceil(e/we)*we;return this.#s+r>this.#n.length&&(this.allowLoose&&n&&this.#s+e<=this.#n.length?r=e:G(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:$t(this.#n),length:this.#n.length,offset:this.#s+r})),this.#n.slice(this.#s,this.#s+r)}subReader(t){const e=new Re(this.#n.slice(this.#s+t),this.allowLoose,this.#c);return e.#a=this,e}readBytes(t,e){let n=this.#h(0,t,!!e);return this.#l(t),this.#s+=n.length,n.slice(0,t)}readValue(){return pe(this.readBytes(we))}readIndex(){return ge(pe(this.readBytes(we)))}}const _e=BigInt(0),Pe=BigInt(36);function Be(t){const e=(t=t.toLowerCase()).substring(2).split(""),n=new Uint8Array(40);for(let t=0;t<40;t++)n[t]=e[t].charCodeAt(0);const r=Gt(te(n));for(let t=0;t<40;t+=2)r[t>>1]>>4>=8&&(e[t]=e[t].toUpperCase()),(15&r[t>>1])>=8&&(e[t+1]=e[t+1].toUpperCase());return"0x"+e.join("")}const Ue={};for(let t=0;t<10;t++)Ue[String(t)]=String(t);for(let t=0;t<26;t++)Ue[String.fromCharCode(65+t)]=String(10+t);const Le=function(){const t={};for(let e=0;e<36;e++)t["0123456789abcdefghijklmnopqrstuvwxyz"[e]]=BigInt(e);return t}();function Me(t){if($("string"==typeof t,"invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=Be(t);return $(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){$(t.substring(2,4)===function(t){let e=(t=(t=t.toUpperCase()).substring(4)+t.substring(0,2)+"00").split("").map(t=>Ue[t]).join("");for(;e.length>=15;){let t=e.substring(0,15);e=parseInt(t,10)%97+e.substring(t.length)}let n=String(98-parseInt(e,10)%97);for(;n.length<2;)n="0"+n;return n}(t),"bad icap checksum","address",t);let e=function(t){t=t.toLowerCase();let e=_e;for(let n=0;n<t.length;n++)e=e*Pe+Le[t[n]];return e}(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Be("0x"+e)}$(!1,"invalid address","address",t)}class Fe extends xe{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,e){let n=Y.dereference(e,"string");try{n=Me(n)}catch(t){return this._throwError(t.message,e)}return t.writeValue(n)}decode(t){return Me(me(t.readValue(),20))}}class De extends xe{coder;constructor(t){super(t.name,t.type,"_",t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,e){return this.coder.encode(t,e)}decode(t){return this.coder.decode(t)}}function Ge(t,e,n){let r=[];if(Array.isArray(n))r=n;else if(n&&"object"==typeof n){let t={};r=e.map(e=>{const r=e.localName;return G(r,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),G(!t[r],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:e},value:n}),t[r]=!0,n[r]})}else $(!1,"invalid tuple value","tuple",n);$(e.length===r.length,"types/value length mismatch","tuple",n);let i=new Se,s=new Se,o=[];e.forEach((t,e)=>{let n=r[e];if(t.dynamic){let e=s.length;t.encode(s,n);let r=i.writeUpdatableValue();o.push(t=>{r(t+e)})}else t.encode(i,n)}),o.forEach(t=>{t(i.length)});let a=t.appendWriter(i);return a+=t.appendWriter(s),a}function $e(t,e){let n=[],r=[],i=t.subReader(0);return e.forEach(e=>{let s=null;if(e.dynamic){let n=t.readIndex(),r=i.subReader(n);try{s=e.decode(r)}catch(t){if(M(t,"BUFFER_OVERRUN"))throw t;s=t,s.baseType=e.name,s.name=e.localName,s.type=e.type}}else try{s=e.decode(t)}catch(t){if(M(t,"BUFFER_OVERRUN"))throw t;s=t,s.baseType=e.name,s.name=e.localName,s.type=e.type}if(null==s)throw new Error("investigate");n.push(s),r.push(e.localName||null)}),Te.fromItems(n,r)}class Ve extends xe{coder;length;constructor(t,e,n){super("array",t.type+"["+(e>=0?e:"")+"]",n,-1===e||t.dynamic),U(this,{coder:t,length:e})}defaultValue(){const t=this.coder.defaultValue(),e=[];for(let n=0;n<this.length;n++)e.push(t);return e}encode(t,e){const n=Y.dereference(e,"array");Array.isArray(n)||this._throwError("expected array value",n);let r=this.length;-1===r&&(r=n.length,t.writeValue(n.length)),V(n.length,r,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let t=0;t<n.length;t++)i.push(this.coder);return Ge(t,i,n)}decode(t){let e=this.length;-1===e&&(e=t.readIndex(),G(e*we<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:e*we,length:t.dataLength}));let n=[];for(let t=0;t<e;t++)n.push(new De(this.coder));return $e(t,n)}}class qe extends xe{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,e){const n=Y.dereference(e,"bool");return t.writeValue(n?1:0)}decode(t){return!!t.readValue()}}class je extends xe{constructor(t,e){super(t,t,e,!0)}defaultValue(){return"0x"}encode(t,e){e=$t(e);let n=t.writeValue(e.length);return n+=t.writeBytes(e),n}decode(t){return t.readBytes(t.readIndex(),!0)}}class We extends je{constructor(t){super("bytes",t)}decode(t){return Wt(super.decode(t))}}class He extends xe{size;constructor(t,e){let n="bytes"+String(t);super(n,n,e,!1),U(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(t,e){let n=$t(Y.dereference(e,this.type));return n.length!==this.size&&this._throwError("incorrect data length",e),t.writeBytes(n)}decode(t){return Wt(t.readBytes(this.size))}}const Ke=new Uint8Array([]);class ze extends xe{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,e){return null!=e&&this._throwError("not null",e),t.writeBytes(Ke)}decode(t){return t.readBytes(0),null}}const Je=BigInt(0),Ye=BigInt(1),Ze=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Xe extends xe{size;signed;constructor(t,e,n){const r=(e?"int":"uint")+8*t;super(r,r,n,!1),U(this,{size:t,signed:e},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,e){let n=ue(Y.dereference(e,this.type)),r=he(Ze,256);if(this.signed){let t=he(r,8*this.size-1);(n>t||n<-(t+Ye))&&this._throwError("value out-of-bounds",e),n=le(n,256)}else(n<Je||n>he(r,8*this.size))&&this._throwError("value out-of-bounds",e);return t.writeValue(n)}decode(t){let e=he(t.readValue(),8*this.size);return this.signed&&(e=function(t,e){const n=de(t,"value"),r=BigInt(ge(e,"width"));return G(n>>r===oe,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),n>>r-ae?-((~n&(ae<<r)-ae)+ae):n}(e,8*this.size)),e}}class Qe extends je{constructor(t){super("string",t)}defaultValue(){return""}encode(t,e){return super.encode(t,re(Y.dereference(e,"string")))}decode(t){return ie(super.decode(t))}}class tn extends xe{coders;constructor(t,e){let n=!1;const r=[];t.forEach(t=>{t.dynamic&&(n=!0),r.push(t.type)}),super("tuple","tuple("+r.join(",")+")",e,n),U(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(e=>{t.push(e.defaultValue())});const e=this.coders.reduce((t,e)=>{const n=e.localName;return n&&(t[n]||(t[n]=0),t[n]++),t},{});return this.coders.forEach((n,r)=>{let i=n.localName;i&&1===e[i]&&("length"===i&&(i="_length"),null==t[i]&&(t[i]=t[r]))}),Object.freeze(t)}encode(t,e){const n=Y.dereference(e,"tuple");return Ge(t,this.coders,n)}decode(t){return $e(t,this.coders)}}function en(t){const e=new Set;return t.forEach(t=>e.add(t)),Object.freeze(e)}const nn=en("external public payable override".split(" ")),rn="constant external internal payable private public pure view override",sn=en(rn.split(" ")),on="constructor error event fallback function receive struct",an=en(on.split(" ")),cn="calldata memory storage payable indexed",ln=en(cn.split(" ")),hn=en([on,cn,"tuple returns",rn].join(" ").split(" ")),un={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},dn=new RegExp("^(\\s*)"),fn=new RegExp("^([0-9]+)"),pn=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),gn=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),mn=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class yn{#s;#u;get offset(){return this.#s}get length(){return this.#u.length-this.#s}constructor(t){this.#s=0,this.#u=t.slice()}clone(){return new yn(this.#u)}reset(){this.#s=0}#d(t=0,e=0){return new yn(this.#u.slice(t,e).map(e=>Object.freeze(Object.assign({},e,{match:e.match-t,linkBack:e.linkBack-t,linkNext:e.linkNext-t}))))}popKeyword(t){const e=this.peek();if("KEYWORD"!==e.type||!t.has(e.text))throw new Error(`expected keyword ${e.text}`);return this.pop().text}popType(t){if(this.peek().type!==t){const e=this.peek();throw new Error(`expected ${t}; got ${e.type} ${JSON.stringify(e.text)}`)}return this.pop().text}popParen(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=this.#d(this.#s+1,t.match+1);return this.#s=t.match+1,e}popParams(){const t=this.peek();if("OPEN_PAREN"!==t.type)throw new Error("bad start");const e=[];for(;this.#s<t.match-1;){const t=this.peek().linkNext;e.push(this.#d(this.#s+1,t)),this.#s=t}return this.#s=t.match+1,e}peek(){if(this.#s>=this.#u.length)throw new Error("out-of-bounds");return this.#u[this.#s]}peekKeyword(t){const e=this.peekType("KEYWORD");return null!=e&&t.has(e)?e:null}peekType(t){if(0===this.length)return null;const e=this.peek();return e.type===t?e.text:null}pop(){const t=this.peek();return this.#s++,t}toString(){const t=[];for(let e=this.#s;e<this.#u.length;e++){const n=this.#u[e];t.push(`${n.type}:${n.text}`)}return`<TokenString ${t.join(" ")}>`}}function wn(t){const e=[],n=e=>{const n=s<t.length?JSON.stringify(t[s]):"$EOI";throw new Error(`invalid token ${n} at ${s}: ${e}`)};let r=[],i=[],s=0;for(;s<t.length;){let o=t.substring(s),a=o.match(dn);a&&(s+=a[1].length,o=t.substring(s));const c={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(c);let l=un[o[0]]||"";if(l){if(c.type=l,c.text=o[0],s++,"OPEN_PAREN"===l)r.push(e.length-1),i.push(e.length-1);else if("CLOSE_PAREN"==l)0===r.length&&n("no matching open bracket"),c.match=r.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1;else if("COMMA"===l)c.linkBack=i.pop(),e[c.linkBack].linkNext=e.length-1,i.push(e.length-1);else if("OPEN_BRACKET"===l)c.type="BRACKET";else if("CLOSE_BRACKET"===l){let t=e.pop().text;if(e.length>0&&"NUMBER"===e[e.length-1].type){const n=e.pop().text;t=n+t,e[e.length-1].value=ge(n)}if(0===e.length||"BRACKET"!==e[e.length-1].type)throw new Error("missing opening bracket");e[e.length-1].text+=t}}else if(a=o.match(pn),a){if(c.text=a[1],s+=c.text.length,hn.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(mn)){c.type="TYPE";continue}c.type="ID"}else{if(a=o.match(fn),!a)throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${s}`);c.text=a[1],c.type="NUMBER",s+=c.text.length}}return new yn(e.map(t=>Object.freeze(t)))}function bn(t,e){let n=[];for(const r in e.keys())t.has(r)&&n.push(r);if(n.length>1)throw new Error(`conflicting types: ${n.join(", ")}`)}function vn(t,e){if(e.peekKeyword(an)){const n=e.pop().text;if(n!==t)throw new Error(`expected ${t}, got ${n}`)}return e.popType("ID")}function En(t,e){const n=new Set;for(;;){const r=t.peekType("KEYWORD");if(null==r||e&&!e.has(r))break;if(t.pop(),n.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);n.add(r)}return Object.freeze(n)}function In(t){let e=En(t,sn);return bn(e,en("constant payable nonpayable".split(" "))),bn(e,en("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function An(t,e){return t.popParams().map(t=>Mn.from(t,e))}function kn(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return ue(t.pop().text);throw new Error("invalid gas")}return null}function Cn(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const Nn=new RegExp(/^(.*)\[([0-9]*)\]$/);function Tn(t){const e=t.match(mn);if($(e,"invalid type","type",t),"uint"===t)return"uint256";if("int"===t)return"int256";if(e[2]){const n=parseInt(e[2]);$(0!==n&&n<=32,"invalid bytes length","type",t)}else if(e[3]){const n=parseInt(e[3]);$(0!==n&&n<=256&&n%8==0,"invalid numeric width","type",t)}return t}const On={},xn=Symbol.for("_ethers_internal"),Sn="_ParamTypeInternal",Rn="_ErrorInternal",_n="_EventInternal",Pn="_ConstructorInternal",Bn="_FallbackInternal",Un="_FunctionInternal",Ln="_StructInternal";class Mn{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(t,e,n,r,i,s,o,a){if(W(t,On,"ParamType"),Object.defineProperty(this,xn,{value:Sn}),s&&(s=Object.freeze(s.slice())),"array"===r){if(null==o||null==a)throw new Error("")}else if(null!=o||null!=a)throw new Error("");if("tuple"===r){if(null==s)throw new Error("")}else if(null!=s)throw new Error("");U(this,{name:e,type:n,baseType:r,indexed:i,components:s,arrayLength:o,arrayChildren:a})}format(t){if(null==t&&(t="sighash"),"json"===t){const e=this.name||"";if(this.isArray()){const t=JSON.parse(this.arrayChildren.format("json"));return t.name=e,t.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(t)}const n={type:"tuple"===this.baseType?"tuple":this.type,name:e};return"boolean"==typeof this.indexed&&(n.indexed=this.indexed),this.isTuple()&&(n.components=this.components.map(e=>JSON.parse(e.format(t)))),JSON.stringify(n)}let e="";return this.isArray()?(e+=this.arrayChildren.format(t),e+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?e+="("+this.components.map(e=>e.format(t)).join("full"===t?", ":",")+")":e+=this.type,"sighash"!==t&&(!0===this.indexed&&(e+=" indexed"),"full"===t&&this.name&&(e+=" "+this.name)),e}isArray(){return"array"===this.baseType}isTuple(){return"tuple"===this.baseType}isIndexable(){return null!=this.indexed}walk(t,e){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(-1!==this.arrayLength&&t.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return t.map(t=>n.arrayChildren.walk(t,e))}if(this.isTuple()){if(!Array.isArray(t))throw new Error("invalid tuple value");if(t.length!==this.components.length)throw new Error("array is wrong length");const n=this;return t.map((t,r)=>n.components[r].walk(t,e))}return e(this.type,t)}#f(t,e,n,r){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(-1!==this.arrayLength&&e.length!==this.arrayLength)throw new Error("array is wrong length");const i=this.arrayChildren,s=e.slice();return s.forEach((e,r)=>{i.#f(t,e,n,t=>{s[r]=t})}),void r(s)}if(this.isTuple()){const i=this.components;let s;if(Array.isArray(e))s=e.slice();else{if(null==e||"object"!=typeof e)throw new Error("invalid tuple value");s=i.map(t=>{if(!t.name)throw new Error("cannot use object value with unnamed components");if(!(t.name in e))throw new Error(`missing value for component ${t.name}`);return e[t.name]})}if(s.length!==this.components.length)throw new Error("array is wrong length");return s.forEach((e,r)=>{i[r].#f(t,e,n,t=>{s[r]=t})}),void r(s)}const i=n(this.type,e);i.then?t.push(async function(){r(await i)}()):r(i)}async walkAsync(t,e){const n=[],r=[t];return this.#f(n,t,e,t=>{r[0]=t}),n.length&&await Promise.all(n),r[0]}static from(t,e){if(Mn.isParamType(t))return t;if("string"==typeof t)try{return Mn.from(wn(t),e)}catch(e){$(!1,"invalid param type","obj",t)}else if(t instanceof yn){let n="",r="",i=null;En(t,en(["tuple"])).has("tuple")||t.peekType("OPEN_PAREN")?(r="tuple",i=t.popParams().map(t=>Mn.from(t)),n=`tuple(${i.map(t=>t.format()).join(",")})`):(n=Tn(t.popType("TYPE")),r=n);let s=null,o=null;for(;t.length&&t.peekType("BRACKET");){const e=t.pop();s=new Mn(On,"",n,r,null,i,o,s),o=e.value,n+=e.text,r="array",i=null}let a=null;if(En(t,ln).has("indexed")){if(!e)throw new Error("");a=!0}const c=t.peekType("ID")?t.pop().text:"";if(t.length)throw new Error("leftover tokens");return new Mn(On,c,n,r,a,i,o,s)}const n=t.name;$(!n||"string"==typeof n&&n.match(gn),"invalid name","obj.name",n);let r=t.indexed;null!=r&&($(e,"parameter cannot be indexed","obj.indexed",t.indexed),r=!!r);let i=t.type,s=i.match(Nn);if(s){const e=parseInt(s[2]||"-1"),o=Mn.from({type:s[1],components:t.components});return new Mn(On,n||"",i,"array",r,null,e,o)}if("tuple"===i||i.startsWith("tuple(")||i.startsWith("(")){const e=null!=t.components?t.components.map(t=>Mn.from(t)):null;return new Mn(On,n||"",i,"tuple",r,e,null,null)}return i=Tn(t.type),new Mn(On,n||"",i,i,r,null,null,null)}static isParamType(t){return t&&t[xn]===Sn}}class Fn{type;inputs;constructor(t,e,n){W(t,On,"Fragment"),U(this,{type:e,inputs:n=Object.freeze(n.slice())})}static from(t){if("string"==typeof t){try{Fn.from(JSON.parse(t))}catch(t){}return Fn.from(wn(t))}if(t instanceof yn)switch(t.peekKeyword(an)){case"constructor":return qn.from(t);case"error":return $n.from(t);case"event":return Vn.from(t);case"fallback":case"receive":return jn.from(t);case"function":return Wn.from(t);case"struct":return Hn.from(t)}else if("object"==typeof t){switch(t.type){case"constructor":return qn.from(t);case"error":return $n.from(t);case"event":return Vn.from(t);case"fallback":case"receive":return jn.from(t);case"function":return Wn.from(t);case"struct":return Hn.from(t)}G(!1,`unsupported type: ${t.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}$(!1,"unsupported frgament object","obj",t)}static isConstructor(t){return qn.isFragment(t)}static isError(t){return $n.isFragment(t)}static isEvent(t){return Vn.isFragment(t)}static isFunction(t){return Wn.isFragment(t)}static isStruct(t){return Hn.isFragment(t)}}class Dn extends Fn{name;constructor(t,e,n,r){super(t,e,r),$("string"==typeof n&&n.match(gn),"invalid identifier","name",n),r=Object.freeze(r.slice()),U(this,{name:n})}}function Gn(t,e){return"("+e.map(e=>e.format(t)).join("full"===t?", ":",")+")"}class $n extends Dn{constructor(t,e,n){super(t,"error",e,n),Object.defineProperty(this,xn,{value:Rn})}get selector(){return se(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("error"),e.push(this.name+Gn(t,this.inputs)),e.join(" ")}static from(t){if($n.isFragment(t))return t;if("string"==typeof t)return $n.from(wn(t));if(t instanceof yn){const e=vn("error",t),n=An(t);return Cn(t),new $n(On,e,n)}return new $n(On,t.name,t.inputs?t.inputs.map(Mn.from):[])}static isFragment(t){return t&&t[xn]===Rn}}class Vn extends Dn{anonymous;constructor(t,e,n,r){super(t,"event",e,n),Object.defineProperty(this,xn,{value:_n}),U(this,{anonymous:r})}get topicHash(){return se(this.format("sighash"))}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("event"),e.push(this.name+Gn(t,this.inputs)),"sighash"!==t&&this.anonymous&&e.push("anonymous"),e.join(" ")}static getTopicHash(t,e){return e=(e||[]).map(t=>Mn.from(t)),new Vn(On,t,e,!1).topicHash}static from(t){if(Vn.isFragment(t))return t;if("string"==typeof t)try{return Vn.from(wn(t))}catch(e){$(!1,"invalid event fragment","obj",t)}else if(t instanceof yn){const e=vn("event",t),n=An(t,!0),r=!!En(t,en(["anonymous"])).has("anonymous");return Cn(t),new Vn(On,e,n,r)}return new Vn(On,t.name,t.inputs?t.inputs.map(t=>Mn.from(t,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[xn]===_n}}class qn extends Fn{payable;gas;constructor(t,e,n,r,i){super(t,e,n),Object.defineProperty(this,xn,{value:Pn}),U(this,{payable:r,gas:i})}format(t){if(G(null!=t&&"sighash"!==t,"cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),"json"===t)return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(e=>JSON.parse(e.format(t)))});const e=[`constructor${Gn(t,this.inputs)}`];return this.payable&&e.push("payable"),null!=this.gas&&e.push(`@${this.gas.toString()}`),e.join(" ")}static from(t){if(qn.isFragment(t))return t;if("string"==typeof t)try{return qn.from(wn(t))}catch(e){$(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof yn){En(t,en(["constructor"]));const e=An(t),n=!!En(t,nn).has("payable"),r=kn(t);return Cn(t),new qn(On,"constructor",e,n,r)}return new qn(On,"constructor",t.inputs?t.inputs.map(Mn.from):[],!!t.payable,null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[xn]===Pn}}class jn extends Fn{payable;constructor(t,e,n){super(t,"fallback",e),Object.defineProperty(this,xn,{value:Bn}),U(this,{payable:n})}format(t){const e=0===this.inputs.length?"receive":"fallback";if("json"===t){const t=this.payable?"payable":"nonpayable";return JSON.stringify({type:e,stateMutability:t})}return`${e}()${this.payable?" payable":""}`}static from(t){if(jn.isFragment(t))return t;if("string"==typeof t)try{return jn.from(wn(t))}catch(e){$(!1,"invalid fallback fragment","obj",t)}else if(t instanceof yn){const e=t.toString();if($(t.peekKeyword(en(["fallback","receive"])),"type must be fallback or receive","obj",e),"receive"===t.popKeyword(en(["fallback","receive"]))){const e=An(t);return $(0===e.length,"receive cannot have arguments","obj.inputs",e),En(t,en(["payable"])),Cn(t),new jn(On,[],!0)}let n=An(t);n.length?$(1===n.length&&"bytes"===n[0].type,"invalid fallback inputs","obj.inputs",n.map(t=>t.format("minimal")).join(", ")):n=[Mn.from("bytes")];const r=In(t);if($("nonpayable"===r||"payable"===r,"fallback cannot be constants","obj.stateMutability",r),En(t,en(["returns"])).has("returns")){const e=An(t);$(1===e.length&&"bytes"===e[0].type,"invalid fallback outputs","obj.outputs",e.map(t=>t.format("minimal")).join(", "))}return Cn(t),new jn(On,n,"payable"===r)}if("receive"===t.type)return new jn(On,[],!0);if("fallback"===t.type){const e=[Mn.from("bytes")],n="payable"===t.stateMutability;return new jn(On,e,n)}$(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[xn]===Bn}}class Wn extends Dn{constant;outputs;stateMutability;payable;gas;constructor(t,e,n,r,i,s){super(t,"function",e,r),Object.defineProperty(this,xn,{value:Un}),U(this,{constant:"view"===n||"pure"===n,gas:s,outputs:i=Object.freeze(i.slice()),payable:"payable"===n,stateMutability:n})}get selector(){return se(this.format("sighash")).substring(0,10)}format(t){if(null==t&&(t="sighash"),"json"===t)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:null!=this.gas?this.gas:void 0,inputs:this.inputs.map(e=>JSON.parse(e.format(t))),outputs:this.outputs.map(e=>JSON.parse(e.format(t)))});const e=[];return"sighash"!==t&&e.push("function"),e.push(this.name+Gn(t,this.inputs)),"sighash"!==t&&("nonpayable"!==this.stateMutability&&e.push(this.stateMutability),this.outputs&&this.outputs.length&&(e.push("returns"),e.push(Gn(t,this.outputs))),null!=this.gas&&e.push(`@${this.gas.toString()}`)),e.join(" ")}static getSelector(t,e){return e=(e||[]).map(t=>Mn.from(t)),new Wn(On,t,"view",e,[],null).selector}static from(t){if(Wn.isFragment(t))return t;if("string"==typeof t)try{return Wn.from(wn(t))}catch(e){$(!1,"invalid function fragment","obj",t)}else if(t instanceof yn){const e=vn("function",t),n=An(t),r=In(t);let i=[];En(t,en(["returns"])).has("returns")&&(i=An(t));const s=kn(t);return Cn(t),new Wn(On,e,r,n,i,s)}let e=t.stateMutability;return null==e&&(e="payable","boolean"==typeof t.constant?(e="view",t.constant||(e="payable","boolean"!=typeof t.payable||t.payable||(e="nonpayable"))):"boolean"!=typeof t.payable||t.payable||(e="nonpayable")),new Wn(On,t.name,e,t.inputs?t.inputs.map(Mn.from):[],t.outputs?t.outputs.map(Mn.from):[],null!=t.gas?t.gas:null)}static isFragment(t){return t&&t[xn]===Un}}class Hn extends Dn{constructor(t,e,n){super(t,"struct",e,n),Object.defineProperty(this,xn,{value:Ln})}format(){throw new Error("@TODO")}static from(t){if("string"==typeof t)try{return Hn.from(wn(t))}catch(e){$(!1,"invalid struct fragment","obj",t)}else if(t instanceof yn){const e=vn("struct",t),n=An(t);return Cn(t),new Hn(On,e,n)}return new Hn(On,t.name,t.inputs?t.inputs.map(Mn.from):[])}static isFragment(t){return t&&t[xn]===Ln}}const Kn=new Map;Kn.set(0,"GENERIC_PANIC"),Kn.set(1,"ASSERT_FALSE"),Kn.set(17,"OVERFLOW"),Kn.set(18,"DIVIDE_BY_ZERO"),Kn.set(33,"ENUM_RANGE_ERROR"),Kn.set(34,"BAD_STORAGE_DATA"),Kn.set(49,"STACK_UNDERFLOW"),Kn.set(50,"ARRAY_RANGE_ERROR"),Kn.set(65,"OUT_OF_MEMORY"),Kn.set(81,"UNINITIALIZED_FUNCTION_CALL");const zn=new RegExp(/^bytes([0-9]*)$/),Jn=new RegExp(/^(u?int)([0-9]*)$/);let Yn=null,Zn=1024;class Xn{#p(t){if(t.isArray())return new Ve(this.#p(t.arrayChildren),t.arrayLength,t.name);if(t.isTuple())return new tn(t.components.map(t=>this.#p(t)),t.name);switch(t.baseType){case"address":return new Fe(t.name);case"bool":return new qe(t.name);case"string":return new Qe(t.name);case"bytes":return new We(t.name);case"":return new ze(t.name)}let e=t.type.match(Jn);if(e){let n=parseInt(e[2]||"256");return $(0!==n&&n<=256&&n%8==0,"invalid "+e[1]+" bit length","param",t),new Xe(n/8,"int"===e[1],t.name)}if(e=t.type.match(zn),e){let n=parseInt(e[1]);return $(0!==n&&n<=32,"invalid bytes length","param",t),new He(n,t.name)}$(!1,"invalid type","type",t.type)}getDefaultValue(t){const e=t.map(t=>this.#p(Mn.from(t)));return new tn(e,"_").defaultValue()}encode(t,e){V(e.length,t.length,"types/values length mismatch");const n=t.map(t=>this.#p(Mn.from(t))),r=new tn(n,"_"),i=new Se;return r.encode(i,e),i.data}decode(t,e,n){const r=t.map(t=>this.#p(Mn.from(t)));return new tn(r,"_").decode(new Re(e,n,Zn))}static _setDefaultMaxInflation(t){$("number"==typeof t&&Number.isInteger(t),"invalid defaultMaxInflation factor","value",t),Zn=t}static defaultAbiCoder(){return null==Yn&&(Yn=new Xn),Yn}static getBuiltinCallException(t,e,n){return function(t,e,n,r){let i="missing revert data",s=null,o=null;if(n){i="execution reverted";const t=Gt(n);if(n=Wt(n),0===t.length)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(t.length%32!=4)i+=" (could not decode reason; invalid data length)";else if("0x08c379a0"===Wt(t.slice(0,4)))try{s=r.decode(["string"],t.slice(4))[0],o={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch(t){i+=" (could not decode reason; invalid string data)"}else if("0x4e487b71"===Wt(t.slice(0,4)))try{const e=Number(r.decode(["uint256"],t.slice(4))[0]);o={signature:"Panic(uint256)",name:"Panic",args:[e]},s=`Panic due to ${Kn.get(e)||"UNKNOWN"}(${e})`,i+=`: ${s}`}catch(t){i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const a={to:e.to?Me(e.to):null,data:e.data||"0x"};return e.from&&(a.from=Me(e.from)),D(i,"CALL_EXCEPTION",{action:t,data:n,reason:s,transaction:a,invocation:null,revert:o})}(t,e,n,Xn.defaultAbiCoder())}}class Qn{fragment;name;signature;topic;args;constructor(t,e,n){const r=t.name,i=t.format();U(this,{fragment:t,name:r,signature:i,topic:e,args:n})}}class tr{fragment;name;args;signature;selector;value;constructor(t,e,n,r){const i=t.name,s=t.format();U(this,{fragment:t,name:i,args:n,signature:s,selector:e,value:r})}}class er{fragment;name;args;signature;selector;constructor(t,e,n){const r=t.name,i=t.format();U(this,{fragment:t,name:r,args:n,signature:i,selector:e})}}class nr{hash;_isIndexed;static isIndexed(t){return!(!t||!t._isIndexed)}constructor(t){U(this,{hash:t,_isIndexed:!0})}}const rr={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},ir={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&rr[t.toString()]&&(e=rr[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class sr{fragments;deploy;fallback;receive;#g;#m;#y;#w;constructor(t){let e=[];e="string"==typeof t?JSON.parse(t):t,this.#y=new Map,this.#g=new Map,this.#m=new Map;const n=[];for(const t of e)try{n.push(Fn.from(t))}catch(e){console.log(`[Warning] Invalid Fragment ${JSON.stringify(t)}:`,e.message)}U(this,{fragments:Object.freeze(n)});let r=null,i=!1;this.#w=this.getAbiCoder(),this.fragments.forEach((t,e)=>{let n;switch(t.type){case"constructor":return this.deploy?void console.log("duplicate definition - constructor"):void U(this,{deploy:t});case"fallback":return void(0===t.inputs.length?i=!0:($(!r||t.payable!==r.payable,"conflicting fallback fragments",`fragments[${e}]`,t),r=t,i=r.payable));case"function":n=this.#y;break;case"event":n=this.#m;break;case"error":n=this.#g;break;default:return}const s=t.format();n.has(s)||n.set(s,t)}),this.deploy||U(this,{deploy:qn.from("constructor()")}),U(this,{fallback:r,receive:i})}format(t){const e=t?"minimal":"full",n=this.fragments.map(t=>t.format(e));return n}formatJson(){const t=this.fragments.map(t=>t.format("json"));return JSON.stringify(t.map(t=>JSON.parse(t)))}getAbiCoder(){return Xn.defaultAbiCoder()}#b(t,e,n){if(Vt(t)){const e=t.toLowerCase();for(const t of this.#y.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const r=[];for(const[e,n]of this.#y)e.split("(")[0]===t&&r.push(n);if(e){const t=e.length>0?e[e.length-1]:null;let n=e.length,i=!0;Y.isTyped(t)&&"overrides"===t.type&&(i=!1,n--);for(let t=r.length-1;t>=0;t--){const e=r[t].inputs.length;e===n||i&&e===n-1||r.splice(t,1)}for(let t=r.length-1;t>=0;t--){const n=r[t].inputs;for(let i=0;i<e.length;i++)if(Y.isTyped(e[i])){if(i>=n.length){if("overrides"===e[i].type)continue;r.splice(t,1);break}if(e[i].type!==n[i].baseType){r.splice(t,1);break}}}}if(1===r.length&&e&&e.length!==r[0].inputs.length){const t=e[e.length-1];(null==t||Array.isArray(t)||"object"!=typeof t)&&r.splice(0,1)}return 0===r.length?null:(r.length>1&&n&&$(!1,`ambiguous function description (i.e. matches ${r.map(t=>JSON.stringify(t.format())).join(", ")})`,"key",t),r[0])}return this.#y.get(Wn.from(t).format())||null}getFunctionName(t){const e=this.#b(t,null,!1);return $(e,"no matching function","key",t),e.name}hasFunction(t){return!!this.#b(t,null,!1)}getFunction(t,e){return this.#b(t,e||null,!0)}forEachFunction(t){const e=Array.from(this.#y.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#y.get(r),n)}}#v(t,e,n){if(Vt(t)){const e=t.toLowerCase();for(const t of this.#m.values())if(e===t.topicHash)return t;return null}if(-1===t.indexOf("(")){const r=[];for(const[e,n]of this.#m)e.split("(")[0]===t&&r.push(n);if(e){for(let t=r.length-1;t>=0;t--)r[t].inputs.length<e.length&&r.splice(t,1);for(let t=r.length-1;t>=0;t--){const n=r[t].inputs;for(let i=0;i<e.length;i++)if(Y.isTyped(e[i])&&e[i].type!==n[i].baseType){r.splice(t,1);break}}}return 0===r.length?null:(r.length>1&&n&&$(!1,`ambiguous event description (i.e. matches ${r.map(t=>JSON.stringify(t.format())).join(", ")})`,"key",t),r[0])}return this.#m.get(Vn.from(t).format())||null}getEventName(t){const e=this.#v(t,null,!1);return $(e,"no matching event","key",t),e.name}hasEvent(t){return!!this.#v(t,null,!1)}getEvent(t,e){return this.#v(t,e||null,!0)}forEachEvent(t){const e=Array.from(this.#m.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#m.get(r),n)}}getError(t,e){if(Vt(t)){const e=t.toLowerCase();if(ir[e])return $n.from(ir[e].signature);for(const t of this.#g.values())if(e===t.selector)return t;return null}if(-1===t.indexOf("(")){const e=[];for(const[n,r]of this.#g)n.split("(")[0]===t&&e.push(r);return 0===e.length?"Error"===t?$n.from("error Error(string)"):"Panic"===t?$n.from("error Panic(uint256)"):null:(e.length>1&&$(!1,`ambiguous error description (i.e. ${e.map(t=>JSON.stringify(t.format())).join(", ")})`,"name",t),e[0])}if("Error(string)"===(t=$n.from(t).format()))return $n.from("error Error(string)");if("Panic(uint256)"===t)return $n.from("error Panic(uint256)");return this.#g.get(t)||null}forEachError(t){const e=Array.from(this.#g.keys());e.sort((t,e)=>t.localeCompare(e));for(let n=0;n<e.length;n++){const r=e[n];t(this.#g.get(r),n)}}_decodeParams(t,e){return this.#w.decode(t,e)}_encodeParams(t,e){return this.#w.encode(t,e)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);$(e,"unknown error","fragment",t),t=e}return $(zt(e,0,4)===t.selector,`data signature does not match error ${t.name}.`,"data",e),this._decodeParams(t.inputs,zt(e,4))}encodeErrorResult(t,e){if("string"==typeof t){const e=this.getError(t);$(e,"unknown error","fragment",t),t=e}return Ht([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);$(e,"unknown function","fragment",t),t=e}return $(zt(e,0,4)===t.selector,`data signature does not match function ${t.name}.`,"data",e),this._decodeParams(t.inputs,zt(e,4))}encodeFunctionData(t,e){if("string"==typeof t){const e=this.getFunction(t);$(e,"unknown function","fragment",t),t=e}return Ht([t.selector,this._encodeParams(t.inputs,e||[])])}decodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);$(e,"unknown function","fragment",t),t=e}let n="invalid length for result data";const r=$t(e);if(r.length%32==0)try{return this.#w.decode(t.outputs,r)}catch(t){n="could not decode result data"}G(!1,n,"BAD_DATA",{value:Wt(r),info:{method:t.name,signature:t.format()}})}makeError(t,e){const n=Gt(t,"data"),r=Xn.getBuiltinCallException("call",e,n);if(r.message.startsWith("execution reverted (unknown custom error)")){const t=Wt(n.slice(0,4)),e=this.getError(t);if(e)try{const t=this.#w.decode(e.inputs,n.slice(4));r.revert={name:e.name,signature:e.format(),args:t},r.reason=r.revert.signature,r.message=`execution reverted: ${r.reason}`}catch(t){r.message="execution reverted (coult not decode custom error)"}}const i=this.parseTransaction(e);return i&&(r.invocation={method:i.name,signature:i.signature,args:i.args}),r}encodeFunctionResult(t,e){if("string"==typeof t){const e=this.getFunction(t);$(e,"unknown function","fragment",t),t=e}return Wt(this.#w.encode(t.outputs,e||[]))}encodeFilterTopics(t,e){if("string"==typeof t){const e=this.getEvent(t);$(e,"unknown event","eventFragment",t),t=e}G(e.length<=t.inputs.length,`too many arguments for ${t.format()}`,"UNEXPECTED_ARGUMENT",{count:e.length,expectedCount:t.inputs.length});const n=[];t.anonymous||n.push(t.topicHash);const r=(t,e)=>"string"===t.type?se(e):"bytes"===t.type?te(Wt(e)):("bool"===t.type&&"boolean"==typeof e?e=e?"0x01":"0x00":t.type.match(/^u?int/)?e=me(e):t.type.match(/^bytes/)?e=Jt(e,32,!1):"address"===t.type&&this.#w.encode(["address"],[e]),Yt(Wt(e),32));for(e.forEach((e,i)=>{const s=t.inputs[i];s.indexed?null==e?n.push(null):"array"===s.baseType||"tuple"===s.baseType?$(!1,"filtering with tuples or arrays not supported","contract."+s.name,e):Array.isArray(e)?n.push(e.map(t=>r(s,t))):n.push(r(s,e)):$(null==e,"cannot filter non-indexed parameters; must be null","contract."+s.name,e)});n.length&&null===n[n.length-1];)n.pop();return n}encodeEventLog(t,e){if("string"==typeof t){const e=this.getEvent(t);$(e,"unknown event","eventFragment",t),t=e}const n=[],r=[],i=[];return t.anonymous||n.push(t.topicHash),$(e.length===t.inputs.length,"event arguments/values mismatch","values",e),t.inputs.forEach((t,s)=>{const o=e[s];if(t.indexed)if("string"===t.type)n.push(se(o));else if("bytes"===t.type)n.push(te(o));else{if("tuple"===t.baseType||"array"===t.baseType)throw new Error("not implemented");n.push(this.#w.encode([t.type],[o]))}else r.push(t),i.push(o)}),{data:this.#w.encode(r,i),topics:n}}decodeEventLog(t,e,n){if("string"==typeof t){const e=this.getEvent(t);$(e,"unknown event","eventFragment",t),t=e}if(null!=n&&!t.anonymous){const e=t.topicHash;$(Vt(n[0],32)&&n[0].toLowerCase()===e,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const r=[],i=[],s=[];t.inputs.forEach((t,e)=>{t.indexed?"string"===t.type||"bytes"===t.type||"tuple"===t.baseType||"array"===t.baseType?(r.push(Mn.from({type:"bytes32",name:t.name})),s.push(!0)):(r.push(t),s.push(!1)):(i.push(t),s.push(!1))});const o=null!=n?this.#w.decode(r,Ht(n)):null,a=this.#w.decode(i,e,!0),c=[],l=[];let h=0,u=0;return t.inputs.forEach((t,e)=>{let n=null;if(t.indexed)if(null==o)n=new nr(null);else if(s[e])n=new nr(o[u++]);else try{n=o[u++]}catch(t){n=t}else try{n=a[h++]}catch(t){n=t}c.push(n),l.push(t.name||null)}),Te.fromItems(c,l)}parseTransaction(t){const e=Gt(t.data,"tx.data"),n=ue(null!=t.value?t.value:0,"tx.value"),r=this.getFunction(Wt(e.slice(0,4)));if(!r)return null;const i=this.#w.decode(r.inputs,e.slice(4));return new tr(r,r.selector,i,n)}parseCallResult(t){throw new Error("@TODO")}parseLog(t){const e=this.getEvent(t.topics[0]);return!e||e.anonymous?null:new Qn(e,e.topicHash,this.decodeEventLog(e,t.data,t.topics))}parseError(t){const e=Wt(t),n=this.getError(zt(e,0,4));if(!n)return null;const r=this.#w.decode(n.inputs,zt(e,4));return new er(n,n.selector,r)}static from(t){return t instanceof sr?t:"string"==typeof t?new sr(JSON.parse(t)):"function"==typeof t.formatJson?new sr(t.formatJson()):"function"==typeof t.format?new sr(t.format("json")):new sr(t)}}function or(t){return t&&"function"==typeof t.getAddress}async function ar(t,e){const n=await e;return null!=n&&"0x0000000000000000000000000000000000000000"!==n||(G("string"!=typeof t,"unconfigured name","UNCONFIGURED_NAME",{value:t}),$(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Me(n)}function cr(t,e){return"string"==typeof t?t.match(/^0x[0-9a-f]{40}$/i)?Me(t):(G(null!=e,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),ar(t,e.resolveName(t))):or(t)?ar(t,t.getAddress()):t&&"function"==typeof t.then?ar(t,t):void $(!1,"unsupported addressable value","target",t)}function lr(t,e){return{address:Me(t),storageKeys:e.map((t,e)=>($(Vt(t,32),"invalid slot",`storageKeys[${e}]`,t),t.toLowerCase()))}}function hr(t){if(Array.isArray(t))return t.map((e,n)=>Array.isArray(e)?($(2===e.length,"invalid slot set",`value[${n}]`,e),lr(e[0],e[1])):($(null!=e&&"object"==typeof e,"invalid address-slot set","value",t),lr(e.address,e.storageKeys)));$(null!=t&&"object"==typeof t,"invalid access list","value",t);const e=Object.keys(t).map(e=>{const n=t[e].reduce((t,e)=>(t[e]=!0,t),{});return lr(e,Object.keys(n).sort())});return e.sort((t,e)=>t.address.localeCompare(e.address)),e}const ur=BigInt(0);function dr(t){return null==t?null:t.toString()}function fr(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=Wt(t.data));const n="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const r of n)r in t&&null!=t[r]&&(e[r]=ue(t[r],`request.${r}`));const r="type,nonce".split(/,/);for(const n of r)n in t&&null!=t[n]&&(e[n]=ge(t[n],`request.${n}`));return t.accessList&&(e.accessList=hr(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(t=>qt(t)?Wt(t):Object.assign({},t))),e}Symbol.iterator;class pr{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(t,e){this.provider=e;const n=Object.freeze(t.topics.slice());U(this,{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,removed:t.removed,address:t.address,data:t.data,topics:n,index:t.index,transactionIndex:t.transactionIndex})}toJSON(){const{address:t,blockHash:e,blockNumber:n,data:r,index:i,removed:s,topics:o,transactionHash:a,transactionIndex:c}=this;return{_type:"log",address:t,blockHash:e,blockNumber:n,data:r,index:i,removed:s,topics:o,transactionHash:a,transactionIndex:c}}async getBlock(){const t=await this.provider.getBlock(this.blockHash);return G(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransaction(){const t=await this.provider.getTransaction(this.transactionHash);return G(!!t,"failed to find transaction","UNKNOWN_ERROR",{}),t}async getTransactionReceipt(){const t=await this.provider.getTransactionReceipt(this.transactionHash);return G(!!t,"failed to find transaction receipt","UNKNOWN_ERROR",{}),t}removedEvent(){return{orphan:"drop-log",log:{transactionHash:(t=this).transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}};var t}}class gr{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#E;constructor(t,e){this.#E=Object.freeze(t.logs.map(t=>new pr(t,e)));let n=ur;null!=t.effectiveGasPrice?n=t.effectiveGasPrice:null!=t.gasPrice&&(n=t.gasPrice),U(this,{provider:e,to:t.to,from:t.from,contractAddress:t.contractAddress,hash:t.hash,index:t.index,blockHash:t.blockHash,blockNumber:t.blockNumber,logsBloom:t.logsBloom,gasUsed:t.gasUsed,cumulativeGasUsed:t.cumulativeGasUsed,blobGasUsed:t.blobGasUsed,gasPrice:n,blobGasPrice:t.blobGasPrice,type:t.type,status:t.status,root:t.root})}get logs(){return this.#E}toJSON(){const{to:t,from:e,contractAddress:n,hash:r,index:i,blockHash:s,blockNumber:o,logsBloom:a,logs:c,status:l,root:h}=this;return{_type:"TransactionReceipt",blockHash:s,blockNumber:o,contractAddress:n,cumulativeGasUsed:dr(this.cumulativeGasUsed),from:e,gasPrice:dr(this.gasPrice),blobGasUsed:dr(this.blobGasUsed),blobGasPrice:dr(this.blobGasPrice),gasUsed:dr(this.gasUsed),hash:r,index:i,logs:c,logsBloom:a,root:h,status:l,to:t}}get length(){return this.logs.length}[Symbol.iterator](){let t=0;return{next:()=>t<this.length?{value:this.logs[t++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const t=await this.provider.getBlock(this.blockHash);if(null==t)throw new Error("TODO");return t}async getTransaction(){const t=await this.provider.getTransaction(this.hash);if(null==t)throw new Error("TODO");return t}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return wr(this)}reorderedEvent(t){return G(!t||t.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),yr(this,t)}}class mr{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#I;constructor(t,e){this.provider=e,this.blockNumber=null!=t.blockNumber?t.blockNumber:null,this.blockHash=null!=t.blockHash?t.blockHash:null,this.hash=t.hash,this.index=t.index,this.type=t.type,this.from=t.from,this.to=t.to||null,this.gasLimit=t.gasLimit,this.nonce=t.nonce,this.data=t.data,this.value=t.value,this.gasPrice=t.gasPrice,this.maxPriorityFeePerGas=null!=t.maxPriorityFeePerGas?t.maxPriorityFeePerGas:null,this.maxFeePerGas=null!=t.maxFeePerGas?t.maxFeePerGas:null,this.maxFeePerBlobGas=null!=t.maxFeePerBlobGas?t.maxFeePerBlobGas:null,this.chainId=t.chainId,this.signature=t.signature,this.accessList=null!=t.accessList?t.accessList:null,this.blobVersionedHashes=null!=t.blobVersionedHashes?t.blobVersionedHashes:null,this.authorizationList=null!=t.authorizationList?t.authorizationList:null,this.#I=-1}toJSON(){const{blockNumber:t,blockHash:e,index:n,hash:r,type:i,to:s,from:o,nonce:a,data:c,signature:l,accessList:h,blobVersionedHashes:u}=this;return{_type:"TransactionResponse",accessList:h,blockNumber:t,blockHash:e,blobVersionedHashes:u,chainId:dr(this.chainId),data:c,from:o,gasLimit:dr(this.gasLimit),gasPrice:dr(this.gasPrice),hash:r,maxFeePerGas:dr(this.maxFeePerGas),maxPriorityFeePerGas:dr(this.maxPriorityFeePerGas),maxFeePerBlobGas:dr(this.maxFeePerBlobGas),nonce:a,signature:l,to:s,index:n,type:i,value:dr(this.value)}}async getBlock(){let t=this.blockNumber;if(null==t){const e=await this.getTransaction();e&&(t=e.blockNumber)}if(null==t)return null;const e=this.provider.getBlock(t);if(null==e)throw new Error("TODO");return e}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(null==this.blockNumber){const{tx:t,blockNumber:e}=await B({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return null==t||null==t.blockNumber?0:e-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(t,e){const n=null==t?1:t,r=null==e?0:e;let i=this.#I,s=-1,o=-1===i;const a=async()=>{if(o)return null;const{blockNumber:t,nonce:e}=await B({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(e<this.nonce)return void(i=t);if(o)return null;const r=await this.getTransaction();if(!r||null==r.blockNumber)for(-1===s&&(s=i-3,s<this.#I&&(s=this.#I));s<=t;){if(o)return null;const e=await this.provider.getBlock(s,!0);if(null==e)return;for(const t of e)if(t===this.hash)return;for(let r=0;r<e.length;r++){const s=await e.getTransaction(r);if(s.from===this.from&&s.nonce===this.nonce){if(o)return null;const e=await this.provider.getTransactionReceipt(s.hash);if(null==e)return;if(t-e.blockNumber+1<n)return;let r="replaced";s.data===this.data&&s.to===this.to&&s.value===this.value?r="repriced":"0x"===s.data&&s.from===s.to&&s.value===ur&&(r="cancelled"),G(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:"replaced"===r||"cancelled"===r,reason:r,replacement:s.replaceableTransaction(i),hash:s.hash,receipt:e})}}s++}},c=t=>{if(null==t||0!==t.status)return t;G(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:t.to,from:t.from,data:""},receipt:t})},l=await this.provider.getTransactionReceipt(this.hash);if(0===n)return c(l);if(l){if(1===n||await l.confirmations()>=n)return c(l)}else if(await a(),0===n)return null;const h=new Promise((t,e)=>{const s=[],l=()=>{s.forEach(t=>t())};if(s.push(()=>{o=!0}),r>0){const t=setTimeout(()=>{l(),e(D("wait for transaction timeout","TIMEOUT"))},r);s.push(()=>{clearTimeout(t)})}const h=async r=>{if(await r.confirmations()>=n){l();try{t(c(r))}catch(t){e(t)}}};if(s.push(()=>{this.provider.off(this.hash,h)}),this.provider.on(this.hash,h),i>=0){const t=async()=>{try{await a()}catch(t){if(M(t,"TRANSACTION_REPLACED"))return l(),void e(t)}o||this.provider.once("block",t)};s.push(()=>{this.provider.off("block",t)}),this.provider.once("block",t)}});return await h}isMined(){return null!=this.blockHash}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}removedEvent(){return G(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),wr(this)}reorderedEvent(t){return G(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),G(!t||t.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),yr(this,t)}replaceableTransaction(t){$(Number.isInteger(t)&&t>=0,"invalid startBlock","startBlock",t);const e=new mr(this,this.provider);return e.#I=t,e}}function yr(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function wr(t){return{orphan:"drop-transaction",tx:t}}class br{filter;emitter;#A;constructor(t,e,n){this.#A=e,U(this,{emitter:t,filter:n})}async removeListener(){null!=this.#A&&await this.emitter.off(this.filter,this.#A)}}class vr extends pr{interface;fragment;args;constructor(t,e,n){super(t,t.provider),U(this,{args:e.decodeEventLog(n,t.data,t.topics),fragment:n,interface:e})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Er extends pr{error;constructor(t,e){super(t,t.provider),U(this,{error:e})}}class Ir extends gr{#k;constructor(t,e,n){super(n,e),this.#k=t}get logs(){return super.logs.map(t=>{const e=t.topics.length?this.#k.getEvent(t.topics[0]):null;if(e)try{return new vr(t,this.#k,e)}catch(e){return new Er(t,e)}return t})}}class Ar extends mr{#k;constructor(t,e,n){super(n,e),this.#k=t}async wait(t,e){const n=await super.wait(t,e);return null==n?null:new Ir(this.#k,this.provider,n)}}class kr extends br{log;constructor(t,e,n,r){super(t,e,n),U(this,{log:r})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class Cr extends kr{constructor(t,e,n,r,i){super(t,e,n,new vr(i,t.interface,r)),U(this,{args:t.interface.decodeEventLog(r,this.log.data,this.log.topics),fragment:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Nr=BigInt(0);function Tr(t){return t&&"function"==typeof t.call}function Or(t){return t&&"function"==typeof t.estimateGas}function xr(t){return t&&"function"==typeof t.resolveName}function Sr(t){return t&&"function"==typeof t.sendTransaction}function Rr(t){if(null!=t){if(xr(t))return t;if(t.provider)return t.provider}}class _r{#C;fragment;constructor(t,e,n){if(U(this,{fragment:e}),e.inputs.length<n.length)throw new Error("too many arguments");const r=Pr(t.runner,"resolveName"),i=xr(r)?r:null;this.#C=async function(){const r=await Promise.all(e.inputs.map((t,e)=>null==n[e]?null:t.walkAsync(n[e],(t,e)=>"address"===t?Array.isArray(e)?Promise.all(e.map(t=>cr(t,i))):cr(e,i):e)));return t.interface.encodeFilterTopics(e,r)}()}getTopicFilter(){return this.#C}}function Pr(t,e){return null==t?null:"function"==typeof t[e]?t:t.provider&&"function"==typeof t.provider[e]?t.provider:null}function Br(t){return null==t?null:t.provider||null}async function Ur(t,e){const n=Y.dereference(t,"overrides");$("object"==typeof n,"invalid overrides parameter","overrides",t);const r=fr(n);return $(null==r.to||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),$(null==r.data||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}function Lr(t){const e=async function(e){const n=await Ur(e,["data"]);n.to=await t.getAddress(),n.from&&(n.from=await cr(n.from,Rr(t.runner)));const r=t.interface,i=ue(n.value||Nr,"overrides.value")===Nr,s="0x"===(n.data||"0x");return!r.fallback||r.fallback.payable||!r.receive||s||i||$(!1,"cannot send data to receive or send value to non-payable fallback","overrides",e),$(r.fallback||s,"cannot send data to receive-only contract","overrides.data",n.data),$(r.receive||r.fallback&&r.fallback.payable||i,"cannot send value to non-payable fallback","overrides.value",n.value),$(r.fallback||s,"cannot send data to receive-only contract","overrides.data",n.data),n},n=async function(n){const r=t.runner;G(Sr(r),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await r.sendTransaction(await e(n)),s=Br(t.runner);return new Ar(t.interface,s,i)},r=async t=>await n(t);return U(r,{_contract:t,estimateGas:async function(n){const r=Pr(t.runner,"estimateGas");return G(Or(r),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await r.estimateGas(await e(n))},populateTransaction:e,send:n,staticCall:async function(n){const r=Pr(t.runner,"call");G(Tr(r),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const i=await e(n);try{return await r.call(i)}catch(e){if(F(e)&&e.data)throw t.interface.makeError(e.data,i);throw e}}}),r}const Mr=Symbol.for("_ethersInternal_contract"),Fr=new WeakMap;function Dr(t){return Fr.get(t[Mr])}async function Gr(t,e){let n,r=null;if(Array.isArray(e)){const r=function(e){if(Vt(e,32))return e;const n=t.interface.getEvent(e);return $(n,"unknown fragment","name",e),n.topicHash};n=e.map(t=>null==t?null:Array.isArray(t)?t.map(r):r(t))}else"*"===e?n=[null]:"string"==typeof e?Vt(e,32)?n=[e]:(r=t.interface.getEvent(e),$(r,"unknown fragment","event",e),n=[r.topicHash]):(i=e)&&"object"==typeof i&&"getTopicFilter"in i&&"function"==typeof i.getTopicFilter&&i.fragment?n=await e.getTopicFilter():"fragment"in e?(r=e.fragment,n=[r.topicHash]):$(!1,"unknown event name","event",e);var i;return n=n.map(t=>{if(null==t)return null;if(Array.isArray(t)){const e=Array.from(new Set(t.map(t=>t.toLowerCase())).values());return 1===e.length?e[0]:(e.sort(),e)}return t.toLowerCase()}),{fragment:r,tag:n.map(t=>null==t?"null":Array.isArray(t)?t.join("|"):t).join("&"),topics:n}}async function $r(t,e){const{subs:n}=Dr(t);return n.get((await Gr(t,e)).tag)||null}async function Vr(t,e,n){const r=Br(t.runner);G(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:s,topics:o}=await Gr(t,n),{addr:a,subs:c}=Dr(t);let l=c.get(s);if(!l){const e={address:a||t,topics:o},h=e=>{let r=i;if(null==r)try{r=t.interface.getEvent(e.topics[0])}catch(t){}if(r){const s=r,o=i?t.interface.decodeEventLog(i,e.data,e.topics):[];jr(t,n,o,r=>new Cr(t,r,n,s,e))}else jr(t,n,[],r=>new kr(t,r,n,e))};let u=[];l={tag:s,listeners:[],start:()=>{u.length||u.push(r.on(e,h))},stop:async()=>{if(0==u.length)return;let t=u;u=[],await Promise.all(t),r.off(e,h)}},c.set(s,l)}return l}let qr=Promise.resolve();async function jr(t,e,n,r){try{await qr}catch(t){}const i=async function(t,e,n,r){await qr;const i=await $r(t,e);if(!i)return!1;const s=i.listeners.length;return i.listeners=i.listeners.filter(({listener:e,once:i})=>{const s=Array.from(n);r&&s.push(r(i?null:e));try{e.call(t,...s)}catch(t){}return!i}),0===i.listeners.length&&(i.stop(),Dr(t).subs.delete(i.tag)),s>0}(t,e,n,r);return qr=i,await i}const Wr=["then"];class Hr{target;interface;runner;filters;[Mr];fallback;constructor(t,e,n,r){$("string"==typeof t||or(t),"invalid value for Contract target","target",t),null==n&&(n=null);const i=sr.from(e);let s;U(this,{target:t,runner:n,interface:i}),Object.defineProperty(this,Mr,{value:{}});let o=null,a=null;if(r){const t=Br(n);a=new Ar(this.interface,t,r)}let c=new Map;if("string"==typeof t)if(Vt(t))o=t,s=Promise.resolve(t);else{const e=Pr(n,"resolveName");if(!xr(e))throw D("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});s=e.resolveName(t).then(e=>{if(null==e)throw D("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:t});return Dr(this).addr=e,e})}else s=t.getAddress().then(t=>{if(null==t)throw new Error("TODO");return Dr(this).addr=t,t});var l;l={addrPromise:s,addr:o,deployTx:a,subs:c},Fr.set(this[Mr],l);const h=new Proxy({},{get:(t,e,n)=>{if("symbol"==typeof e||Wr.indexOf(e)>=0)return Reflect.get(t,e,n);try{return this.getEvent(e)}catch(t){if(!M(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>Wr.indexOf(e)>=0?Reflect.has(t,e):Reflect.has(t,e)||this.interface.hasEvent(String(e))});return U(this,{filters:h}),U(this,{fallback:i.receive||i.fallback?Lr(this):null}),new Proxy(this,{get:(t,e,n)=>{if("symbol"==typeof e||e in t||Wr.indexOf(e)>=0)return Reflect.get(t,e,n);try{return t.getFunction(e)}catch(t){if(!M(t,"INVALID_ARGUMENT")||"key"!==t.argument)throw t}},has:(t,e)=>"symbol"==typeof e||e in t||Wr.indexOf(e)>=0?Reflect.has(t,e):t.interface.hasFunction(e)})}connect(t){return new Hr(this.target,this.interface,t)}attach(t){return new Hr(t,this.interface,this.runner)}async getAddress(){return await Dr(this).addrPromise}async getDeployedCode(){const t=Br(this.runner);G(t,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const e=await t.getCode(await this.getAddress());return"0x"===e?null:e}async waitForDeployment(){const t=this.deploymentTransaction();if(t)return await t.wait(),this;if(null!=await this.getDeployedCode())return this;const e=Br(this.runner);return G(null!=e,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((t,n)=>{const r=async()=>{try{if(null!=await this.getDeployedCode())return t(this);e.once("block",r)}catch(t){n(t)}};r()})}deploymentTransaction(){return Dr(this).deployTx}getFunction(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const n=function(...n){const r=t.interface.getFunction(e,n);return G(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),r},r=async function(...e){const r=n(...e);let i={};if(r.inputs.length+1===e.length&&(i=await Ur(e.pop()),i.from&&(i.from=await cr(i.from,Rr(t.runner)))),r.inputs.length!==e.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const s=await async function(t,e,n){const r=Pr(t,"resolveName"),i=xr(r)?r:null;return await Promise.all(e.map((t,e)=>t.walkAsync(n[e],(t,e)=>(e=Y.dereference(e,t),"address"===t?cr(e,i):e))))}(t.runner,r.inputs,e);return Object.assign({},i,await B({to:t.getAddress(),data:t.interface.encodeFunctionData(r,s)}))},i=async function(...t){const e=await o(...t);return 1===e.length?e[0]:e},s=async function(...e){const n=t.runner;G(Sr(n),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const i=await n.sendTransaction(await r(...e)),s=Br(t.runner);return new Ar(t.interface,s,i)},o=async function(...e){const i=Pr(t.runner,"call");G(Tr(i),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const s=await r(...e);let o="0x";try{o=await i.call(s)}catch(e){if(F(e)&&e.data)throw t.interface.makeError(e.data,s);throw e}const a=n(...e);return t.interface.decodeFunctionResult(a,o)},a=async(...t)=>n(...t).constant?await i(...t):await s(...t);return U(a,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:n,estimateGas:async function(...e){const n=Pr(t.runner,"estimateGas");return G(Or(n),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await n.estimateGas(await r(...e))},populateTransaction:r,send:s,staticCall:i,staticCallResult:o}),Object.defineProperty(a,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getFunction(e);return G(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),a}(this,t)}getEvent(t){return"string"!=typeof t&&(t=t.format()),function(t,e){const n=function(...n){const r=t.interface.getEvent(e,n);return G(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:n}}),r},r=function(...e){return new _r(t,n(...e),e)};return U(r,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:n}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const n=t.interface.getEvent(e);return G(n,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),n}}),r}(this,t)}async queryTransaction(t){throw new Error("@TODO")}async queryFilter(t,e,n){null==e&&(e=0),null==n&&(n="latest");const{addr:r,addrPromise:i}=Dr(this),s=r||await i,{fragment:o,topics:a}=await Gr(this,t),c={address:s,topics:a,fromBlock:e,toBlock:n},l=Br(this.runner);return G(l,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await l.getLogs(c)).map(t=>{let e=o;if(null==e)try{e=this.interface.getEvent(t.topics[0])}catch(t){}if(e)try{return new vr(t,this.interface,e)}catch(e){return new Er(t,e)}return new pr(t,l)})}async on(t,e){const n=await Vr(this,"on",t);return n.listeners.push({listener:e,once:!1}),n.start(),this}async once(t,e){const n=await Vr(this,"once",t);return n.listeners.push({listener:e,once:!0}),n.start(),this}async emit(t,...e){return await jr(this,t,e,null)}async listenerCount(t){if(t){const e=await $r(this,t);return e?e.listeners.length:0}const{subs:e}=Dr(this);let n=0;for(const{listeners:t}of e.values())n+=t.length;return n}async listeners(t){if(t){const e=await $r(this,t);return e?e.listeners.map(({listener:t})=>t):[]}const{subs:e}=Dr(this);let n=[];for(const{listeners:t}of e.values())n=n.concat(t.map(({listener:t})=>t));return n}async off(t,e){const n=await $r(this,t);if(!n)return this;if(e){const t=n.listeners.map(({listener:t})=>t).indexOf(e);t>=0&&n.listeners.splice(t,1)}return null!=e&&0!==n.listeners.length||(n.stop(),Dr(this).subs.delete(n.tag)),this}async removeAllListeners(t){if(t){const e=await $r(this,t);if(!e)return this;e.stop(),Dr(this).subs.delete(e.tag)}else{const{subs:t}=Dr(this);for(const{tag:e,stop:n}of t.values())n(),t.delete(e)}return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return await this.off(t,e)}static buildClass(t){return class extends Hr{constructor(e,n=null){super(e,t,n)}}}static from(t,e,n){return null==n&&(n=null),new this(t,e,n)}}class Kr extends(function(){return Hr}()){}var zr=n(1048).Buffer;const Jr="function"==typeof zr,Yr="function"==typeof TextDecoder?new TextDecoder:void 0,Zr="function"==typeof TextEncoder?new TextEncoder:void 0,Xr=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Qr=(t=>{let e={};return t.forEach((t,n)=>e[t]=n),e})(Xr),ti=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,ei=String.fromCharCode.bind(String),ni="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),ri=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),ii="function"==typeof btoa?t=>btoa(t):Jr?t=>zr.from(t,"binary").toString("base64"):t=>{let e,n,r,i,s="";const o=t.length%3;for(let o=0;o<t.length;){if((n=t.charCodeAt(o++))>255||(r=t.charCodeAt(o++))>255||(i=t.charCodeAt(o++))>255)throw new TypeError("invalid character found");e=n<<16|r<<8|i,s+=Xr[e>>18&63]+Xr[e>>12&63]+Xr[e>>6&63]+Xr[63&e]}return o?s.slice(0,o-3)+"===".substring(o):s},si=Jr?t=>zr.from(t).toString("base64"):t=>{let e=[];for(let n=0,r=t.length;n<r;n+=4096)e.push(ei.apply(null,t.subarray(n,n+4096)));return ii(e.join(""))},oi=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?ei(192|e>>>6)+ei(128|63&e):ei(224|e>>>12&15)+ei(128|e>>>6&63)+ei(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return ei(240|e>>>18&7)+ei(128|e>>>12&63)+ei(128|e>>>6&63)+ei(128|63&e)},ai=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ci=Jr?t=>zr.from(t,"utf8").toString("base64"):Zr?t=>si(Zr.encode(t)):t=>ii(t.replace(ai,oi)),li=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,hi=t=>{switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return ei((e>>>10)+55296)+ei(56320+(1023&e));case 3:return ei((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return ei((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},ui="function"==typeof atob?t=>atob(ri(t)):Jr?t=>zr.from(t,"base64").toString("binary"):t=>{if(t=t.replace(/\s+/g,""),!ti.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,n,r,i="";for(let s=0;s<t.length;)e=Qr[t.charAt(s++)]<<18|Qr[t.charAt(s++)]<<12|(n=Qr[t.charAt(s++)])<<6|(r=Qr[t.charAt(s++)]),i+=64===n?ei(e>>16&255):64===r?ei(e>>16&255,e>>8&255):ei(e>>16&255,e>>8&255,255&e);return i},di=Jr?t=>ni(zr.from(t,"base64")):t=>ni(ui(t).split("").map(t=>t.charCodeAt(0))),fi=Jr?t=>zr.from(t,"base64").toString("utf8"):Yr?t=>Yr.decode(di(t)):t=>(t=>t.replace(li,hi))(ui(t)),pi=(t,e=!1)=>e?(t=>t.replace(/=/g,"").replace(/[+\/]/g,t=>"+"==t?"-":"_"))(ci(t)):ci(t),gi=t=>fi(ri(t.replace(/[-_]/g,t=>"-"==t?"+":"/")));var mi=function(){return mi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},mi.apply(this,arguments)};function yi(t,e,n,r){return new(n||(n=Promise))(function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}c((r=r.apply(t,e||[])).next())})}function wi(t,e){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var bi=function(){function t(t){this.prefix=Ci,this.address=(null==t?void 0:t.address)?t.address.toLowerCase():"",this.claims=(null==t?void 0:t.claims)?t.claims:{app:"",iat:0,exp:0,v:ki},this.signature=(null==t?void 0:t.signature)?t.signature:"",this.extra=(null==t?void 0:t.extra)?t.extra:""}return t.prototype.setIssuedAtNow=function(){this.claims.iat=Math.round((new Date).getTime()/1e3)},t.prototype.setExpiryIn=function(t){this.claims.exp=Math.round((new Date).getTime()/1e3)+t},t.prototype.validateClaims=function(){return vi(this.claims)},t.prototype.messageDigest=function(){var t,e=this.validateClaims();if(e.err)throw e.err;return s.utils.arrayify((t=this.messageTypedData(),s.utils._TypedDataEncoder.hash(t.domain,t.types,t.message)))},t.prototype.messageTypedData=function(){var t={domain:mi({},Ni),types:{Claims:[]},message:{}};return this.claims.app&&this.claims.app.length>0&&(t.types.Claims.push({name:"app",type:"string"}),t.message.app=this.claims.app),this.claims.iat&&this.claims.iat>0&&(t.types.Claims.push({name:"iat",type:"int64"}),t.message.iat=this.claims.iat),this.claims.exp&&this.claims.exp>0&&(t.types.Claims.push({name:"exp",type:"int64"}),t.message.exp=this.claims.exp),this.claims.n&&this.claims.n>0&&(t.types.Claims.push({name:"n",type:"uint64"}),t.message.n=this.claims.n),this.claims.typ&&this.claims.typ.length>0&&(t.types.Claims.push({name:"typ",type:"string"}),t.message.typ=this.claims.typ),this.claims.ogn&&this.claims.ogn.length>0&&(t.types.Claims.push({name:"ogn",type:"string"}),t.message.ogn=this.claims.ogn),this.claims.v&&this.claims.v.length>0&&(t.types.Claims.push({name:"v",type:"string"}),t.message.v=this.claims.v),t},t}(),vi=function(t){if(""===t.app)return{ok:!1,err:new Error("claims: app is empty")};var e=Math.round((new Date).getTime()/1e3),n=31536300;return""===t.v?{ok:!1,err:new Error("claims: ethauth version is empty")}:t.iat&&0!==t.iat&&(t.iat>e+300||t.iat<e-n)?{ok:!1,err:new Error("claims: iat is invalid")}:t.exp<e-300||t.exp>e+n?{ok:!1,err:new Error("claims: token has expired")}:{ok:!0}},Ei=function(t,e,n){return yi(void 0,void 0,void 0,function(){var t,e;return wi(this,function(r){return t=n.messageDigest(),"0x"===(e=s.utils.verifyMessage(t,n.signature)).slice(0,2)&&42===e.length&&e.toLowerCase()===n.address.toLowerCase()?[2,{isValid:!0,address:n.address}]:[2,{isValid:!1}]})})},Ii=function(t,e,n){return yi(void 0,void 0,void 0,function(){var e,r,i;return wi(this,function(o){switch(o.label){case 0:return t&&void 0!==t?(e=n.messageDigest(),[4,t.getCode(n.address)]):[2,{isValid:!1}];case 1:if("0x"===(r=o.sent())||r.length<=2)throw new Error("ValidateContractAccountProof failed. unable to fetch wallet contract code");return i=["function isValidSignature(bytes32, bytes) public view returns (bytes4)"],[4,new Kr(n.address,i,t).isValidSignature(e,s.utils.arrayify(n.signature))];case 2:return o.sent()===Ai?[2,{isValid:!0,address:n.address}]:[2,{isValid:!1}]}})})},Ai="0x1626ba7e",ki="1",Ci="eth",Ni={name:"ETHAuth",version:ki},Ti=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this;this.configJsonRpcProvider=function(t){return yi(n,void 0,void 0,function(){var e;return wi(this,function(n){switch(n.label){case 0:return this.provider=new s.providers.JsonRpcProvider(t),[4,this.provider.send("net_version",[])];case 1:if(e=n.sent(),this.chainId=parseInt(e),!this.chainId||0===this.chainId||NaN===this.chainId)throw new Error("ethauth: unable to get chainId");return this.ethereumJsonRpcURL=t,[2]}})})},this.configValidators=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0==t.length)throw new Error("validators list is empty");n.validators=t},this.encodeProof=function(t,e){return void 0===e&&(e=!1),yi(n,void 0,void 0,function(){var n,r;return wi(this,function(i){switch(i.label){case 0:if(42!==t.address.length||"0x"!==t.address.slice(0,2))throw new Error("ethauth: invalid address");if(""===t.signature||"0x"!==t.signature.slice(0,2))throw new Error("ethauth: invalid signature");if(t.extra&&"0x"!==t.extra.slice(0,2))throw new Error("ethauth: invalid extra encoding, expecting hex data");return[4,this.validateProof(t,e)];case 1:if(!i.sent())throw new Error("ethauth: proof is invalid");return n=JSON.stringify(t.claims),r=Ci+"."+t.address.toLowerCase()+"."+pi(n,!0)+"."+t.signature,t.extra&&t.extra.length>0&&(r+="."+t.extra),[2,r]}})})},this.decodeProof=function(t,e){return void 0===e&&(e=!1),yi(n,void 0,void 0,function(){var n,r,i,s,o,a,c,l,h;return wi(this,function(u){switch(u.label){case 0:if((n=t.split(".")).length<4||n.length>5)throw new Error("ethauth: invalid proof string");if(r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],r!==Ci)throw new Error("ethauth: not an ethauth proof");return c=gi(s),l=JSON.parse(c),h=new bi({address:i,claims:l,signature:o,extra:a}),[4,this.validateProof(h,e)];case 1:if(!u.sent())throw new Error("ethauth: proof is invalid");return[2,h]}})})},this.validateProof=function(t,e){return void 0===e&&(e=!1),yi(n,void 0,void 0,function(){var n;return wi(this,function(r){switch(r.label){case 0:if((n=this.validateProofClaims(t)).err)throw new Error("ethauth: proof claims are invalid ".concat(n.err));return!0===e?[3,2]:[4,this.validateProofSignature(t)];case 1:if(!0!==r.sent())throw new Error("ethauth: proof signature is invalid");r.label=2;case 2:return[2,!0]}})})},this.validateProofSignature=function(t){return yi(n,void 0,void 0,function(){var e,n,r;return wi(this,function(i){switch(i.label){case 0:e=[],r=0,i.label=1;case 1:if(!(r<this.validators.length))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,(0,this.validators[r])(this.provider,this.chainId,t)];case 3:return!0===(n=i.sent().isValid)?[2,!0]:(e.push(n),[3,5]);case 4:return i.sent(),e.push(!1),[3,5];case 5:return r++,[3,1];case 6:for(r=0;r<e.length;r++)if(e[r])return[2,!0];return[2,!1]}})})},this.validateProofClaims=function(t){return t.validateClaims()},0==t.length?this.validators=[Ei,Ii]:this.validators=t};class Oi extends bt{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=pt(this.buffer)}update(t){tt(this);const{view:e,buffer:n,blockLen:r}=this,i=(t=wt(t)).length;for(let s=0;s<i;){const o=Math.min(r-this.pos,i-s);if(o===r){const e=pt(t);for(;r<=i-s;s+=r)this.process(e,s);continue}n.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){tt(this),et(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>r-s&&(this.process(n,0),s=0);for(let t=s;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(n>>i&s),a=Number(n&s),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const o=pt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,l[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:s,pos:o}=this;return t.length=r,t.pos=o,t.finished=i,t.destroyed=s,r%e&&t.buffer.set(n),t}}const xi=(t,e,n)=>t&e^~t&n,Si=(t,e,n)=>t&e^t&n^e&n,Ri=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pi=new Uint32Array(64);class Bi extends Oi{constructor(){super(64,32,8,!1),this.A=0|_i[0],this.B=0|_i[1],this.C=0|_i[2],this.D=0|_i[3],this.E=0|_i[4],this.F=0|_i[5],this.G=0|_i[6],this.H=0|_i[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:s,G:o,H:a}=this;return[t,e,n,r,i,s,o,a]}set(t,e,n,r,i,s,o,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)Pi[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Pi[t-15],n=Pi[t-2],r=gt(e,7)^gt(e,18)^e>>>3,i=gt(n,17)^gt(n,19)^n>>>10;Pi[t]=i+Pi[t-7]+r+Pi[t-16]|0}let{A:n,B:r,C:i,D:s,E:o,F:a,G:c,H:l}=this;for(let t=0;t<64;t++){const e=l+(gt(o,6)^gt(o,11)^gt(o,25))+xi(o,a,c)+Ri[t]+Pi[t]|0,h=(gt(n,2)^gt(n,13)^gt(n,22))+Si(n,r,i)|0;l=c,c=a,a=o,o=s+e|0,s=i,i=r,r=n,n=e+h|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(n,r,i,s,o,a,c,l)}roundClean(){Pi.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Ui=It(()=>new Bi),Li=(BigInt(0),BigInt(1)),Mi=BigInt(2),Fi=t=>t instanceof Uint8Array,Di=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gi(t){if(!Fi(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Di[t[n]];return e}function $i(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function Vi(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,i=t.slice(r,r+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");n[e]=s}return n}function qi(t){return $i(Gi(t))}function ji(t){if(!Fi(t))throw new Error("Uint8Array expected");return $i(Gi(Uint8Array.from(t).reverse()))}function Wi(t,e){return Vi(t.toString(16).padStart(2*e,"0"))}function Hi(t,e){return Wi(t,e).reverse()}function Ki(t,e,n){let r;if("string"==typeof e)try{r=Vi(e)}catch(n){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${n}`)}else{if(!Fi(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(`${t} expected ${n} bytes, got ${i}`);return r}function zi(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!Fi(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}const Ji=t=>(Mi<<BigInt(t-1))-Li,Yi=t=>new Uint8Array(t),Zi=t=>Uint8Array.from(t);function Xi(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=Yi(t),i=Yi(t),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...t)=>n(i,r,...t),c=(t=Yi())=>{i=a(Zi([0]),t),r=a(),0!==t.length&&(i=a(Zi([1]),t),r=a())},l=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return zi(...n)};return(t,e)=>{let n;for(o(),c(t);!(n=e(l()));)c();return o(),n}}const Qi={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function ts(t,e,n={}){const r=(e,n,r)=>{const i=Qi[n];if("function"!=typeof i)throw new Error(`Invalid validator "${n}", expected function`);const s=t[e];if(!(r&&void 0===s||i(s,t)))throw new Error(`Invalid param ${String(e)}=${s} (${typeof s}), expected ${n}`)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}const es=BigInt(0),ns=BigInt(1),rs=BigInt(2),is=BigInt(3),ss=BigInt(4),os=BigInt(5),as=BigInt(8);function cs(t,e){const n=t%e;return n>=es?n:e+n}function ls(t,e,n){if(n<=es||e<es)throw new Error("Expected power/modulo > 0");if(n===ns)return es;let r=ns;for(;e>es;)e&ns&&(r=r*t%n),t=t*t%n,e>>=ns;return r}function hs(t,e,n){let r=t;for(;e-- >es;)r*=r,r%=n;return r}function us(t,e){if(t===es||e<=es)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=cs(t,e),r=e,i=es,s=ns,o=ns,a=es;for(;n!==es;){const t=r/n,e=r%n,c=i-o*t,l=s-a*t;r=n,n=e,i=o,s=a,o=c,a=l}if(r!==ns)throw new Error("invert: does not exist");return cs(i,e)}BigInt(9),BigInt(16);const ds=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function fs(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function ps(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function gs(t){const e=ps(t);return e+Math.ceil(e/2)}class ms extends bt{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Q(t);const n=wt(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return tt(this),this.iHash.update(t),this}digestInto(t){tt(this),X(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:i,blockLen:s,outputLen:o}=this;return t.finished=r,t.destroyed=i,t.blockLen=s,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ys=(t,e,n)=>new ms(t,e).update(n).digest();ys.create=(t,e)=>new ms(t,e);const ws=BigInt(0),bs=BigInt(1);function vs(t){return ts(t.Fp,ds.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),ts(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...fs(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const{Ph:Es,aT:Is}=a,As={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=As;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Es(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=As,n="string"==typeof t?Is(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=As._parseInt(n.subarray(2)),{d:o,l:a}=As._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),i=e(n(t.r)),s=r.length/2,o=i.length/2,a=n(s),c=n(o);return`30${n(o+s+4)}02${c}${i}02${a}${r}`}},ks=BigInt(0),Cs=BigInt(1),Ns=(BigInt(2),BigInt(3));function Ts(t){const e=function(t){const e=vs(t);return ts(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:n,n:r}=e,i=n.BYTES+1,s=2*n.BYTES+1;function o(t){return cs(t,r)}function a(t){return us(t,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:l,weierstrassEquation:h,isWithinCurveOrder:u}=function(t){const e=function(t){const e=vs(t);ts(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:i}=e;if(n){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,r=e.toBytes||((t,e,r)=>{const i=e.toAffine();return zi(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),i=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function s(t){const{a:r,b:i}=e,s=n.sqr(t),o=n.mul(s,t);return n.add(n.add(o,n.mul(t,r)),i)}if(!n.eql(n.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(t){return"bigint"==typeof t&&ks<t&&t<e.n}function a(t){if(!o(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:s}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=Gi(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*r,"0")}let o;try{o="bigint"==typeof t?t:qi(Ki("private key",t,r))}catch(e){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return i&&(o=cs(o,s)),a(o),o}const l=new Map;function h(t){if(!(t instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof u)throw new Error("projective point not allowed");const i=t=>n.eql(t,n.ZERO);return i(e)&&i(r)?u.ZERO:new u(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(u.fromAffine)}static fromHex(t){const e=u.fromAffine(i(Ki("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return u.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const i=n.sqr(r),o=s(t);if(!n.eql(i,o))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){h(t);const{px:e,py:r,pz:i}=this,{px:s,py:o,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(s,i)),l=n.eql(n.mul(r,a),n.mul(o,i));return c&&l}negate(){return new u(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,i=n.mul(r,Ns),{px:s,py:o,pz:a}=this;let c=n.ZERO,l=n.ZERO,h=n.ZERO,d=n.mul(s,s),f=n.mul(o,o),p=n.mul(a,a),g=n.mul(s,o);return g=n.add(g,g),h=n.mul(s,a),h=n.add(h,h),c=n.mul(t,h),l=n.mul(i,p),l=n.add(c,l),c=n.sub(f,l),l=n.add(f,l),l=n.mul(c,l),c=n.mul(g,c),h=n.mul(i,h),p=n.mul(t,p),g=n.sub(d,p),g=n.mul(t,g),g=n.add(g,h),h=n.add(d,d),d=n.add(h,d),d=n.add(d,p),d=n.mul(d,g),l=n.add(l,d),p=n.mul(o,a),p=n.add(p,p),d=n.mul(p,g),c=n.sub(c,d),h=n.mul(p,f),h=n.add(h,h),h=n.add(h,h),new u(c,l,h)}add(t){h(t);const{px:r,py:i,pz:s}=this,{px:o,py:a,pz:c}=t;let l=n.ZERO,d=n.ZERO,f=n.ZERO;const p=e.a,g=n.mul(e.b,Ns);let m=n.mul(r,o),y=n.mul(i,a),w=n.mul(s,c),b=n.add(r,i),v=n.add(o,a);b=n.mul(b,v),v=n.add(m,y),b=n.sub(b,v),v=n.add(r,s);let E=n.add(o,c);return v=n.mul(v,E),E=n.add(m,w),v=n.sub(v,E),E=n.add(i,s),l=n.add(a,c),E=n.mul(E,l),l=n.add(y,w),E=n.sub(E,l),f=n.mul(p,v),l=n.mul(g,w),f=n.add(l,f),l=n.sub(y,f),f=n.add(y,f),d=n.mul(l,f),y=n.add(m,m),y=n.add(y,m),w=n.mul(p,w),v=n.mul(g,v),y=n.add(y,w),w=n.sub(m,w),w=n.mul(p,w),v=n.add(v,w),m=n.mul(y,v),d=n.add(d,m),m=n.mul(E,v),l=n.mul(b,l),l=n.sub(l,m),m=n.mul(b,y),f=n.mul(E,f),f=n.add(f,m),new u(l,d,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(u.ZERO)}wNAF(t){return f.wNAFCached(this,l,t,t=>{const e=n.invertBatch(t.map(t=>t.pz));return t.map((t,n)=>t.toAffine(e[n])).map(u.fromAffine)})}multiplyUnsafe(t){const r=u.ZERO;if(t===ks)return r;if(a(t),t===Cs)return this;const{endo:i}=e;if(!i)return f.unsafeLadder(this,t);let{k1neg:s,k1:o,k2neg:c,k2:l}=i.splitScalar(t),h=r,d=r,p=this;for(;o>ks||l>ks;)o&Cs&&(h=h.add(p)),l&Cs&&(d=d.add(p)),p=p.double(),o>>=Cs,l>>=Cs;return s&&(h=h.negate()),c&&(d=d.negate()),d=new u(n.mul(d.px,i.beta),d.py,d.pz),h.add(d)}multiply(t){a(t);let r,i,s=t;const{endo:o}=e;if(o){const{k1neg:t,k1:e,k2neg:a,k2:c}=o.splitScalar(s);let{p:l,f:h}=this.wNAF(e),{p:d,f:p}=this.wNAF(c);l=f.constTimeNegate(t,l),d=f.constTimeNegate(a,d),d=new u(n.mul(d.px,o.beta),d.py,d.pz),r=l.add(d),i=h.add(p)}else{const{p:t,f:e}=this.wNAF(s);r=t,i=e}return u.normalizeZ([r,i])[0]}multiplyAndAddUnsafe(t,e,n){const r=u.BASE,i=(t,e)=>e!==ks&&e!==Cs&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),s=i(this,e).add(i(t,n));return s.is0()?void 0:s}toAffine(t){const{px:e,py:r,pz:i}=this,s=this.is0();null==t&&(t=s?n.ONE:n.inv(i));const o=n.mul(e,t),a=n.mul(r,t),c=n.mul(i,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:o,y:a}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===Cs)return!0;if(n)return n(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===Cs?this:n?n(u,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),r(u,this,t)}toHex(t=!0){return Gi(this.toRawBytes(t))}}u.BASE=new u(e.Gx,e.Gy,n.ONE),u.ZERO=new u(n.ZERO,n.ONE,n.ZERO);const d=e.nBitLength,f=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,i=e;for(;n>ws;)n&bs&&(r=r.add(i)),i=i.double(),n>>=bs;return r},precomputeWindow(t,e){const{windows:n,windowSize:i}=r(e),s=[];let o=t,a=o;for(let t=0;t<n;t++){a=o,s.push(a);for(let t=1;t<i;t++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(e,i,s){const{windows:o,windowSize:a}=r(e);let c=t.ZERO,l=t.BASE;const h=BigInt(2**e-1),u=2**e,d=BigInt(e);for(let t=0;t<o;t++){const e=t*a;let r=Number(s&h);s>>=d,r>a&&(r-=u,s+=bs);const o=e,f=e+Math.abs(r)-1,p=t%2!=0,g=r<0;0===r?l=l.add(n(p,i[o])):c=c.add(n(g,i[f]))}return{p:c,f:l}},wNAFCached(t,e,n,r){const i=t._WINDOW_SIZE||1;let s=e.get(t);return s||(s=this.precomputeWindow(t,i),1!==i&&e.set(t,r(s))),this.wNAF(i,s,n)}}}(u,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:s,isWithinCurveOrder:o}}({...e,toBytes(t,e,r){const i=e.toAffine(),s=n.toBytes(i.x),o=zi;return r?o(Uint8Array.from([e.hasEvenY()?2:3]),s):o(Uint8Array.from([4]),s,n.toBytes(i.y))},fromBytes(t){const e=t.length,r=t[0],o=t.subarray(1);if(e!==i||2!==r&&3!==r){if(e===s&&4===r)return{x:n.fromBytes(o.subarray(0,n.BYTES)),y:n.fromBytes(o.subarray(n.BYTES,2*n.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}{const t=qi(o);if(!(ks<(a=t)&&a<n.ORDER))throw new Error("Point is not on curve");const e=h(t);let i=n.sqrt(e);return!(1&~r)!=((i&Cs)===Cs)&&(i=n.neg(i)),{x:t,y:i}}var a}}),d=t=>Gi(Wi(t,e.nByteLength));function f(t){return t>r>>Cs}const p=(t,e,n)=>qi(t.slice(e,n));class g{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const n=e.nByteLength;return t=Ki("compactSignature",t,2*n),new g(p(t,0,n),p(t,n,2*n))}static fromDER(t){const{r:e,s:n}=As.toSig(Ki("DER",t));return new g(e,n)}assertValidity(){if(!u(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!u(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new g(this.r,this.s,t)}recoverPublicKey(t){const{r,s:i,recovery:s}=this,l=b(Ki("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");const h=2===s||3===s?r+e.n:r;if(h>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const u=1&s?"03":"02",f=c.fromHex(u+d(h)),p=a(h),g=o(-l*p),m=o(i*p),y=c.BASE.multiplyAndAddUnsafe(f,g,m);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Vi(this.toDERHex())}toDERHex(){return As.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Vi(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const m={isValidPrivateKey(t){try{return l(t),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const t=gs(e.n);return function(t,e,n=!1){const r=t.length,i=ps(e),s=gs(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=cs(n?qi(t):ji(t),e-ns)+ns;return n?Hi(o,i):Wi(o,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function y(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===i||r===s:n?r===2*i||r===2*s:t instanceof c}const w=e.bits2int||function(t){const n=qi(t),r=8*t.length-e.nBitLength;return r>0?n>>BigInt(r):n},b=e.bits2int_modN||function(t){return o(w(t))},v=Ji(e.nBitLength);function E(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(ks<=t&&t<v))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Wi(t,e.nByteLength)}const I={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(y(t))throw new Error("first arg must be private key");if(!y(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(l(t)).toRawBytes(n)},sign:function(t,r,i=I){const{seed:s,k2sig:h}=function(t,r,i=I){if(["recovered","canonical"].some(t=>t in i))throw new Error("sign() legacy options not supported");const{hash:s,randomBytes:h}=e;let{lowS:d,prehash:p,extraEntropy:m}=i;null==d&&(d=!0),t=Ki("msgHash",t),p&&(t=Ki("prehashed msgHash",s(t)));const y=b(t),v=l(r),A=[E(v),E(y)];if(null!=m){const t=!0===m?h(n.BYTES):m;A.push(Ki("extraEntropy",t))}const k=zi(...A),C=y;return{seed:k,k2sig:function(t){const e=w(t);if(!u(e))return;const n=a(e),r=c.BASE.multiply(e).toAffine(),i=o(r.x);if(i===ks)return;const s=o(n*o(C+i*v));if(s===ks)return;let l=(r.x===i?0:2)|Number(r.y&Cs),h=s;return d&&f(s)&&(h=function(t){return f(t)?o(-t):t}(s),l^=1),new g(i,h,l)}}}(t,r,i),d=e;return Xi(d.hash.outputLen,d.nByteLength,d.hmac)(s,h)},verify:function(t,n,r,i=A){const s=t;if(n=Ki("msgHash",n),r=Ki("publicKey",r),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:l,prehash:h}=i;let u,d;try{if("string"==typeof s||s instanceof Uint8Array)try{u=g.fromDER(s)}catch(t){if(!(t instanceof As.Err))throw t;u=g.fromCompact(s)}else{if("object"!=typeof s||"bigint"!=typeof s.r||"bigint"!=typeof s.s)throw new Error("PARSE");{const{r:t,s:e}=s;u=new g(t,e)}}d=c.fromHex(r)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(l&&u.hasHighS())return!1;h&&(n=e.hash(n));const{r:f,s:p}=u,m=b(n),y=a(p),w=o(m*y),v=o(f*y),E=c.BASE.multiplyAndAddUnsafe(d,w,v)?.toAffine();return!!E&&o(E.x)===f},ProjectivePoint:c,Signature:g,utils:m}}function Os(t){return{hash:t,hmac:(e,...n)=>ys(t,e,function(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.length,0));let n=0;return t.forEach(t=>{if(!dt(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length}),e}(...n)),randomBytes:At}}BigInt(4);const xs=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ss=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Rs=BigInt(1),_s=BigInt(2),Ps=(t,e)=>(t+e/_s)/e;const Bs=function(t,e,n=!1,r={}){if(t<=es)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:s}=fs(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=function(t){if(t%ss===is){const e=(t+ns)/ss;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%as===os){const e=(t-os)/as;return function(t,n){const r=t.mul(n,rs),i=t.pow(r,e),s=t.mul(n,i),o=t.mul(t.mul(s,rs),i),a=t.mul(s,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-ns)/rs;let n,r,i;for(n=t-ns,r=0;n%rs===es;n/=rs,r++);for(i=rs;i<t&&ls(i,e,t)!==t-ns;i++);if(1===r){const e=(t+ns)/ss;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const s=(n+ns)/rs;return function(t,o){if(t.pow(o,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=r,c=t.pow(t.mul(t.ONE,i),n),l=t.pow(o,s),h=t.pow(o,n);for(;!t.eql(h,t.ONE);){if(t.eql(h,t.ZERO))return t.ZERO;let e=1;for(let n=t.sqr(h);e<a&&!t.eql(n,t.ONE);e++)n=t.sqr(n);const n=t.pow(c,ns<<BigInt(a-e-1));c=t.sqr(n),l=t.mul(l,n),h=t.mul(h,c),a=e}return l}}(t)}(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:s,MASK:Ji(i),ZERO:es,ONE:ns,create:e=>cs(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return es<=e&&e<t},is0:t=>t===es,isOdd:t=>(t&ns)===ns,neg:e=>cs(-e,t),eql:(t,e)=>t===e,sqr:e=>cs(e*e,t),add:(e,n)=>cs(e+n,t),sub:(e,n)=>cs(e-n,t),mul:(e,n)=>cs(e*n,t),pow:(t,e)=>function(t,e,n){if(n<es)throw new Error("Expected power > 0");if(n===es)return t.ONE;if(n===ns)return e;let r=t.ONE,i=e;for(;n>es;)n&ns&&(r=t.mul(r,i)),i=t.sqr(i),n>>=ns;return r}(a,t,e),div:(e,n)=>cs(e*us(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>us(e,t),sqrt:r.sqrt||(t=>o(a,t)),invertBatch:t=>function(t,e){const n=new Array(e.length),r=e.reduce((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r)),t.ONE),i=t.inv(r);return e.reduceRight((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r)),i),n}(a,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?Hi(t,s):Wi(t,s),fromBytes:t=>{if(t.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${t.length}`);return n?ji(t):qi(t)}});return Object.freeze(a)}(xs,void 0,void 0,{sqrt:function(t){const e=xs,n=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,h=l*l*t%e,u=hs(h,n,e)*h%e,d=hs(u,n,e)*h%e,f=hs(d,_s,e)*l%e,p=hs(f,i,e)*f%e,g=hs(p,s,e)*p%e,m=hs(g,a,e)*g%e,y=hs(m,c,e)*m%e,w=hs(y,a,e)*g%e,b=hs(w,n,e)*h%e,v=hs(b,o,e)*p%e,E=hs(v,r,e)*l%e,I=hs(E,_s,e);if(!Bs.eql(Bs.sqr(I),t))throw new Error("Cannot find square root");return I}}),Us=function(t,e){const n=e=>Ts({...t,...Os(e)});return Object.freeze({...n(e),create:n})}({a:BigInt(0),b:BigInt(7),Fp:Bs,n:Ss,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Ss,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Rs*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=n,o=BigInt("0x100000000000000000000000000000000"),a=Ps(s*t,e),c=Ps(-r*t,e);let l=cs(t-a*n-c*i,e),h=cs(-a*r-c*s,e);const u=l>o,d=h>o;if(u&&(l=e-l),d&&(h=e-h),l>o||h>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:u,k1:l,k2neg:d,k2:h}}}},Ui);BigInt(0),Us.ProjectivePoint;const Ls="0x0000000000000000000000000000000000000000000000000000000000000000",Ms=BigInt(0),Fs=BigInt(1),Ds=BigInt(2),Gs=BigInt(27),$s=BigInt(28),Vs=BigInt(35),qs={};function js(t){return Yt(ye(t),32)}class Ws{#N;#T;#O;#x;get r(){return this.#N}set r(t){$(32===Kt(t),"invalid r","value",t),this.#N=Wt(t)}get s(){return $(parseInt(this.#T.substring(0,3))<8,"non-canonical s; use ._s","s",this.#T),this.#T}set s(t){$(32===Kt(t),"invalid s","value",t),this.#T=Wt(t)}get _s(){return this.#T}isValid(){return parseInt(this.#T.substring(0,3))<8}get v(){return this.#O}set v(t){const e=ge(t,"value");$(27===e||28===e,"invalid v","v",t),this.#O=e}get networkV(){return this.#x}get legacyChainId(){const t=this.networkV;return null==t?null:Ws.getChainId(t)}get yParity(){return 27===this.v?0:1}get yParityAndS(){const t=Gt(this.s);return this.yParity&&(t[0]|=128),Wt(t)}get compactSerialized(){return Ht([this.r,this.yParityAndS])}get serialized(){return Ht([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(t,e,n,r){W(t,qs,"Signature"),this.#N=e,this.#T=n,this.#O=r,this.#x=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const t=new Ws(qs,this.r,this._s,this.v);return this.networkV&&(t.#x=this.networkV),t}toJSON(){const t=this.networkV;return{_type:"signature",networkV:null!=t?t.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(t){const e=ue(t,"v");return e==Gs||e==$s?Ms:($(e>=Vs,"invalid EIP-155 v","v",t),(e-Vs)/Ds)}static getChainIdV(t,e){return ue(t)*Ds+BigInt(35+e-27)}static getNormalizedV(t){const e=ue(t);return e===Ms||e===Gs?27:e===Fs||e===$s?28:($(e>=Vs,"invalid v","v",t),e&Fs?27:28)}static from(t){function e(e,n){$(e,n,"signature",t)}if(null==t)return new Ws(qs,Ls,Ls,27);if("string"==typeof t){const n=Gt(t,"signature");if(64===n.length){const t=Wt(n.slice(0,32)),e=n.slice(32,64),r=128&e[0]?28:27;return e[0]&=127,new Ws(qs,t,Wt(e),r)}if(65===n.length){const t=Wt(n.slice(0,32)),e=Wt(n.slice(32,64)),r=Ws.getNormalizedV(n[64]);return new Ws(qs,t,e,r)}e(!1,"invalid raw signature length")}if(t instanceof Ws)return t.clone();const n=t.r;e(null!=n,"missing r");const r=js(n),i=function(t,n){if(null!=t)return js(t);if(null!=n){e(Vt(n,32),"invalid yParityAndS");const t=Gt(n);return t[0]&=127,Wt(t)}e(!1,"missing s")}(t.s,t.yParityAndS),{networkV:s,v:o}=function(t,n,r){if(null!=t){const e=ue(t);return{networkV:e>=Vs?e:void 0,v:Ws.getNormalizedV(e)}}if(null!=n)return e(Vt(n,32),"invalid yParityAndS"),{v:128&Gt(n)[0]?28:27};if(null!=r){switch(ge(r,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}e(!1,"invalid yParity")}e(!1,"missing v")}(t.v,t.yParityAndS,t.yParity),a=new Ws(qs,r,i,o);return s&&(a.#x=s),e(null==t.yParity||ge(t.yParity,"sig.yParity")===a.yParity,"yParity mismatch"),e(null==t.yParityAndS||t.yParityAndS===a.yParityAndS,"yParityAndS mismatch"),a}}class Hs{#S;constructor(t){$(32===Kt(t),"invalid private key","privateKey","[REDACTED]"),this.#S=Wt(t)}get privateKey(){return this.#S}get publicKey(){return Hs.computePublicKey(this.#S)}get compressedPublicKey(){return Hs.computePublicKey(this.#S,!0)}sign(t){$(32===Kt(t),"invalid digest length","digest",t);const e=Us.sign($t(t),$t(this.#S),{lowS:!0});return Ws.from({r:me(e.r,32),s:me(e.s,32),v:e.recovery?28:27})}computeSharedSecret(t){const e=Hs.computePublicKey(t);return Wt(Us.getSharedSecret($t(this.#S),Gt(e),!1))}static computePublicKey(t,e){let n=Gt(t,"key");if(32===n.length)return Wt(Us.getPublicKey(n,!!e));if(64===n.length){const t=new Uint8Array(65);t[0]=4,t.set(n,1),n=t}return Wt(Us.ProjectivePoint.fromHex(n).toRawBytes(e))}static recoverPublicKey(t,e){$(32===Kt(t),"invalid digest length","digest",t);const n=Ws.from(e);let r=Us.Signature.fromCompact($t(Ht([n.r,n.s])));r=r.addRecoveryBit(n.yParity);const i=r.recoverPublicKey($t(t));return $(null!=i,"invalid signature for digest","signature",e),"0x"+i.toHex(!1)}static addPoints(t,e,n){const r=Us.ProjectivePoint.fromHex(Hs.computePublicKey(t).substring(2)),i=Us.ProjectivePoint.fromHex(Hs.computePublicKey(e).substring(2));return"0x"+r.add(i).toHex(!!n)}}function Ks(t){const e=[];for(;t;)e.unshift(255&t),t>>=8;return e}function zs(t){if(Array.isArray(t)){let e=[];if(t.forEach(function(t){e=e.concat(zs(t))}),e.length<=55)return e.unshift(192+e.length),e;const n=Ks(e.length);return n.unshift(247+n.length),n.concat(e)}const e=Array.prototype.slice.call(Gt(t,"object"));if(1===e.length&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const n=Ks(e.length);return n.unshift(183+n.length),n.concat(e)}const Js="0123456789abcdef";function Ys(t){let e="0x";for(const n of zs(t))e+=Js[n>>4],e+=Js[15&n];return e}const Zs=new Uint8Array(32);Zs.fill(0);const Xs=BigInt(-1),Qs=BigInt(0),to=BigInt(1),eo=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),no=me(to,32),ro=me(Qs,32),io={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},so=["name","version","chainId","verifyingContract","salt"];function oo(t){return function(e){return $("string"==typeof e,`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const ao={name:oo("name"),version:oo("version"),chainId:function(t){const e=ue(t,"domain.chainId");return $(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):function(t){let e=Wt(qt(t)?t:ye(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return""===e&&(e="0"),"0x"+e}(e)},verifyingContract:function(t){try{return Me(t).toLowerCase()}catch(t){}$(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=Gt(t,"domain.salt");return $(32===e.length,'invalid domain value "salt"',"domain.salt",t),Wt(e)}};function co(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const n=""===e[1],r=parseInt(e[2]);$(r%8==0&&0!==r&&r<=256&&e[2]===String(r),"invalid numeric width","type",t);const i=he(eo,n?r-1:r),s=n?(i+to)*Xs:Qs;return function(e){const r=ue(e,"value");return $(r>=s&&r<=i,`value out-of-bounds for ${t}`,"value",r),me(n?le(r,256):r,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const n=parseInt(e[1]);return $(0!==n&&n<=32&&e[1]===String(n),"invalid bytes width","type",t),function(e){return $(Gt(e).length===n,`invalid length for ${t}`,"value",e),function(t){const e=Gt(t),n=e.length%32;return n?Ht([e,Zs.slice(n)]):Wt(e)}(e)}}}switch(t){case"address":return function(t){return Yt(Me(t),32)};case"bool":return function(t){return t?no:ro};case"bytes":return function(t){return te(t)};case"string":return function(t){return se(t)}}return null}function lo(t,e){return`${t}(${e.map(({name:t,type:e})=>e+" "+t).join(",")})`}function ho(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class uo{primaryType;#R;get types(){return JSON.parse(this.#R)}#_;#P;constructor(t){this.#_=new Map,this.#P=new Map;const e=new Map,n=new Map,r=new Map,i={};Object.keys(t).forEach(s=>{i[s]=t[s].map(({name:e,type:n})=>{let{base:r,index:i}=ho(n);return"int"!==r||t.int||(r="int256"),"uint"!==r||t.uint||(r="uint256"),{name:e,type:r+(i||"")}}),e.set(s,new Set),n.set(s,[]),r.set(s,new Set)}),this.#R=JSON.stringify(i);for(const r in i){const s=new Set;for(const o of i[r]){$(!s.has(o.name),`duplicate variable name ${JSON.stringify(o.name)} in ${JSON.stringify(r)}`,"types",t),s.add(o.name);const i=ho(o.type).base;$(i!==r,`circular type reference to ${JSON.stringify(i)}`,"types",t),co(i)||($(n.has(i),`unknown type ${JSON.stringify(i)}`,"types",t),n.get(i).push(r),e.get(r).add(i))}}const s=Array.from(n.keys()).filter(t=>0===n.get(t).length);$(0!==s.length,"missing primary type","types",t),$(1===s.length,`ambiguous primary types or unused types: ${s.map(t=>JSON.stringify(t)).join(", ")}`,"types",t),U(this,{primaryType:s[0]}),function i(s,o){$(!o.has(s),`circular type reference to ${JSON.stringify(s)}`,"types",t),o.add(s);for(const t of e.get(s))if(n.has(t)){i(t,o);for(const e of o)r.get(e).add(t)}o.delete(s)}(this.primaryType,new Set);for(const[t,e]of r){const n=Array.from(e);n.sort(),this.#_.set(t,lo(t,i[t])+n.map(t=>lo(t,i[t])).join(""))}}getEncoder(t){let e=this.#P.get(t);return e||(e=this.#B(t),this.#P.set(t,e)),e}#B(t){{const e=co(t);if(e)return e}const e=ho(t).array;if(e){const t=e.prefix,n=this.getEncoder(t);return r=>{$(-1===e.count||e.count===r.length,`array length mismatch; expected length ${e.count}`,"value",r);let i=r.map(n);return this.#_.has(t)&&(i=i.map(te)),te(Ht(i))}}const n=this.types[t];if(n){const e=se(this.#_.get(t));return t=>{const r=n.map(({name:e,type:n})=>{const r=this.getEncoder(n)(t[e]);return this.#_.has(n)?te(r):r});return r.unshift(e),Ht(r)}}$(!1,`unknown type: ${t}`,"type",t)}encodeType(t){const e=this.#_.get(t);return $(e,`unknown type: ${JSON.stringify(t)}`,"name",t),e}encodeData(t,e){return this.getEncoder(t)(e)}hashStruct(t,e){return te(this.encodeData(t,e))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,e,n){if(co(t))return n(t,e);const r=ho(t).array;if(r)return $(-1===r.count||r.count===e.length,`array length mismatch; expected length ${r.count}`,"value",e),e.map(t=>this._visit(r.prefix,t,n));const i=this.types[t];if(i)return i.reduce((t,{name:r,type:i})=>(t[r]=this._visit(i,e[r],n),t),{});$(!1,`unknown type: ${t}`,"type",t)}visit(t,e){return this._visit(this.primaryType,t,e)}static from(t){return new uo(t)}static getPrimaryType(t){return uo.from(t).primaryType}static hashStruct(t,e,n){return uo.from(e).hashStruct(t,n)}static hashDomain(t){const e=[];for(const n in t){if(null==t[n])continue;const r=io[n];$(r,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",t),e.push({name:n,type:r})}return e.sort((t,e)=>so.indexOf(t.name)-so.indexOf(e.name)),uo.hashStruct("EIP712Domain",{EIP712Domain:e},t)}static encode(t,e,n){return Ht(["0x1901",uo.hashDomain(t),uo.from(e).hash(n)])}static hash(t,e,n){return te(uo.encode(t,e,n))}static async resolveNames(t,e,n,r){t=Object.assign({},t);for(const e in t)null==t[e]&&delete t[e];const i={};t.verifyingContract&&!Vt(t.verifyingContract,20)&&(i[t.verifyingContract]="0x");const s=uo.from(e);s.visit(n,(t,e)=>("address"!==t||Vt(e,20)||(i[e]="0x"),e));for(const t in i)i[t]=await r(t);return t.verifyingContract&&i[t.verifyingContract]&&(t.verifyingContract=i[t.verifyingContract]),{domain:t,value:n=s.visit(n,(t,e)=>"address"===t&&i[e]?i[e]:e)}}static getPayload(t,e,n){uo.hashDomain(t);const r={},i=[];so.forEach(e=>{const n=t[e];null!=n&&(r[e]=ao[e](n),i.push({name:e,type:io[e]}))});const s=uo.from(e);e=s.types;const o=Object.assign({},e);return $(null==o.EIP712Domain,"types must not contain EIP712Domain type","types.EIP712Domain",e),o.EIP712Domain=i,s.encode(n),{types:o,domain:r,primaryType:s.primaryType,message:s.visit(n,(t,e)=>{if(t.match(/^bytes(\d*)/))return Wt(Gt(e));if(t.match(/^u?int/))return ue(e).toString();switch(t){case"address":return e.toLowerCase();case"bool":return!!e;case"string":return $("string"==typeof e,"invalid string","value",e),e}$(!1,"unsupported type","type",t)})}}}const fo="0x0000000000000000000000000000000000000000";function po(t,e,n,r){const{c:i,dkLen:s,DK:o,PRF:a,PRFSalt:c}=function(t,e,n,r){Q(t);const i=Et({dkLen:32,asyncTick:10},r),{c:s,dkLen:o,asyncTick:a}=i;if(Z(s),Z(o),Z(a),s<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=wt(e),l=wt(n),h=new Uint8Array(o),u=ys.create(t,c),d=u._cloneInto().update(l);return{c:s,dkLen:o,asyncTick:a,DK:h,PRF:u,PRFSalt:d}}(t,e,n,r);let l;const h=new Uint8Array(4),u=pt(h),d=new Uint8Array(a.outputLen);for(let t=1,e=0;e<s;t++,e+=a.outputLen){const n=o.subarray(e,e+a.outputLen);u.setInt32(0,t,!1),(l=c._cloneInto(l)).update(h).digestInto(d),n.set(d.subarray(0,n.length));for(let t=1;t<i;t++){a._cloneInto(l).update(d).digestInto(d);for(let t=0;t<n.length;t++)n[t]^=d[t]}}return function(t,e,n,r,i){return t.destroy(),e.destroy(),r&&r.destroy(),i.fill(0),n}(a,c,o,l,d)}const[go,mo]=(()=>ht.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),yo=new Uint32Array(80),wo=new Uint32Array(80);class bo extends Oi{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:h,Fl:u,Gh:d,Gl:f,Hh:p,Hl:g}=this;return[t,e,n,r,i,s,o,a,c,l,h,u,d,f,p,g]}set(t,e,n,r,i,s,o,a,c,l,h,u,d,f,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|h,this.Fl=0|u,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let n=0;n<16;n++,e+=4)yo[n]=t.getUint32(e),wo[n]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|yo[t-15],n=0|wo[t-15],r=ht.rotrSH(e,n,1)^ht.rotrSH(e,n,8)^ht.shrSH(e,n,7),i=ht.rotrSL(e,n,1)^ht.rotrSL(e,n,8)^ht.shrSL(e,n,7),s=0|yo[t-2],o=0|wo[t-2],a=ht.rotrSH(s,o,19)^ht.rotrBH(s,o,61)^ht.shrSH(s,o,6),c=ht.rotrSL(s,o,19)^ht.rotrBL(s,o,61)^ht.shrSL(s,o,6),l=ht.add4L(i,c,wo[t-7],wo[t-16]),h=ht.add4H(l,r,a,yo[t-7],yo[t-16]);yo[t]=0|h,wo[t]=0|l}let{Ah:n,Al:r,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:h,El:u,Fh:d,Fl:f,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let t=0;t<80;t++){const e=ht.rotrSH(h,u,14)^ht.rotrSH(h,u,18)^ht.rotrBH(h,u,41),w=ht.rotrSL(h,u,14)^ht.rotrSL(h,u,18)^ht.rotrBL(h,u,41),b=h&d^~h&p,v=u&f^~u&g,E=ht.add5L(y,w,v,mo[t],wo[t]),I=ht.add5H(E,m,e,b,go[t],yo[t]),A=0|E,k=ht.rotrSH(n,r,28)^ht.rotrBH(n,r,34)^ht.rotrBH(n,r,39),C=ht.rotrSL(n,r,28)^ht.rotrBL(n,r,34)^ht.rotrBL(n,r,39),N=n&i^n&o^i&o,T=r&s^r&a^s&a;m=0|p,y=0|g,p=0|d,g=0|f,d=0|h,f=0|u,({h,l:u}=ht.add(0|c,0|l,0|I,0|A)),c=0|o,l=0|a,o=0|i,a=0|s,i=0|n,s=0|r;const O=ht.add3L(A,C,T);n=ht.add3H(O,I,k,N),r=0|O}({h:n,l:r}=ht.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:s}=ht.add(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=ht.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=ht.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h,l:u}=ht.add(0|this.Eh,0|this.El,0|h,0|u)),({h:d,l:f}=ht.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:g}=ht.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=ht.add(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(n,r,i,s,o,a,c,l,h,u,d,f,p,g,m,y)}roundClean(){yo.fill(0),wo.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const vo=It(()=>new bo),Eo=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),Io=Eo.crypto||Eo.msCrypto;function Ao(t){switch(t){case"sha256":return Ui.create();case"sha512":return vo.create()}$(!1,"invalid hashing algorithm name","algorithm",t)}const ko=function(t){return Ao("sha256").update(t).digest()},Co=function(t){return Ao("sha512").update(t).digest()};let No=ko,To=Co,Oo=!1,xo=!1;function So(t){const e=Gt(t,"data");return Wt(No(e))}function Ro(t){const e=Gt(t,"data");return Wt(To(e))}function _o(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function Po(t,e,n){let r=0;for(let i=0;i<n;i++)r=256*r+t[e+i];return r}function Bo(t,e,n,r){const i=[];for(;n<e+1+r;){const s=Uo(t,n);i.push(s.result),G((n+=s.consumed)<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:t,length:r,offset:e})}return{consumed:1+r,result:i}}function Uo(t,e){G(0!==t.length,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const n=e=>{G(e<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:e})};if(t[e]>=248){const r=t[e]-247;n(e+1+r);const i=Po(t,e+1,r);return n(e+1+r+i),Bo(t,e,e+1+r,r+i)}if(t[e]>=192){const r=t[e]-192;return n(e+1+r),Bo(t,e,e+1,r)}if(t[e]>=184){const r=t[e]-183;n(e+1+r);const i=Po(t,e+1,r);return n(e+1+r+i),{consumed:1+r+i,result:Wt(t.slice(e+1+r,e+1+r+i))}}if(t[e]>=128){const r=t[e]-128;return n(e+1+r),{consumed:1+r,result:Wt(t.slice(e+1,e+1+r))}}return{consumed:1,result:_o(t[e])}}function Lo(t){const e=Gt(t,"data"),n=Uo(e,0);return $(n.consumed===e.length,"unexpected junk after rlp payload","data",t),n.result}function Mo(t){let e;return e="string"==typeof t?Hs.computePublicKey(t,!1):t.publicKey,Me(te("0x"+e.substring(4)).substring(26))}So._=ko,So.lock=function(){Oo=!0},So.register=function(t){if(Oo)throw new Error("sha256 is locked");No=t},Object.freeze(So),Ro._=Co,Ro.lock=function(){xo=!0},Ro.register=function(t){if(xo)throw new Error("sha512 is locked");To=t},Object.freeze(So);const Fo=BigInt(0),Do=BigInt(2),Go=BigInt(27),$o=BigInt(28),Vo=BigInt(35),qo=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),jo=131072;function Wo(t,e){let n=t.toString(16);for(;n.length<2;)n="0"+n;return n+=So(e).substring(4),"0x"+n}function Ho(t){return"0x"===t?null:Me(t)}function Ko(t,e){try{return hr(t)}catch(n){$(!1,n.message,e,t)}}function zo(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const e=[];for(let n=0;n<t.length;n++){const r=t[n];if(!Array.isArray(r))throw new Error(`authorization[${n}]: invalid array`);if(6!==r.length)throw new Error(`authorization[${n}]: wrong length`);if(!r[1])throw new Error(`authorization[${n}]: null address`);e.push({address:Ho(r[1]),nonce:Yo(r[2],"nonce"),chainId:Yo(r[0],"chainId"),signature:Ws.from({yParity:Jo(r[3],"yParity"),r:Yt(r[4],32),s:Yt(r[5],32)})})}return e}catch(n){$(!1,n.message,e,t)}}function Jo(t,e){return"0x"===t?0:ge(t,e)}function Yo(t,e){if("0x"===t)return Fo;const n=ue(t,e);return $(n<=qo,"value exceeds uint size",e,n),n}function Zo(t,e){const n=ue(t,"value"),r=ye(n);return $(r.length<=32,"value too large",`tx.${e}`,n),r}function Xo(t){return hr(t).map(t=>[t.address,t.storageKeys])}function Qo(t,e){$(Array.isArray(t),`invalid ${e}`,"value",t);for(let e=0;e<t.length;e++)$(Vt(t[e],32),"invalid ${ param } hash",`value[${e}]`,t[e]);return t}function ta(t,e){let n;try{if(n=Jo(e[0],"yParity"),0!==n&&1!==n)throw new Error("bad yParity")}catch(t){$(!1,"invalid yParity","yParity",e[0])}const r=Yt(e[1],32),i=Yt(e[2],32),s=Ws.from({r,s:i,yParity:n});t.signature=s}class ea{#U;#L;#n;#M;#F;#D;#G;#$;#V;#q;#j;#W;#H;#K;#z;#J;#Y;get type(){return this.#U}set type(t){switch(t){case null:this.#U=null;break;case 0:case"legacy":this.#U=0;break;case 1:case"berlin":case"eip-2930":this.#U=1;break;case 2:case"london":case"eip-1559":this.#U=2;break;case 3:case"cancun":case"eip-4844":this.#U=3;break;case 4:case"pectra":case"eip-7702":this.#U=4;break;default:$(!1,"unsupported transaction type","type",t)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const t=this.#L;return null==t&&3===this.type?fo:t}set to(t){this.#L=null==t?null:Me(t)}get nonce(){return this.#M}set nonce(t){this.#M=ge(t,"value")}get gasLimit(){return this.#F}set gasLimit(t){this.#F=ue(t)}get gasPrice(){const t=this.#D;return null!=t||0!==this.type&&1!==this.type?t:Fo}set gasPrice(t){this.#D=null==t?null:ue(t,"gasPrice")}get maxPriorityFeePerGas(){const t=this.#G;return null==t?2===this.type||3===this.type?Fo:null:t}set maxPriorityFeePerGas(t){this.#G=null==t?null:ue(t,"maxPriorityFeePerGas")}get maxFeePerGas(){const t=this.#$;return null==t?2===this.type||3===this.type?Fo:null:t}set maxFeePerGas(t){this.#$=null==t?null:ue(t,"maxFeePerGas")}get data(){return this.#n}set data(t){this.#n=Wt(t)}get value(){return this.#V}set value(t){this.#V=ue(t,"value")}get chainId(){return this.#q}set chainId(t){this.#q=ue(t)}get signature(){return this.#j||null}set signature(t){this.#j=null==t?null:Ws.from(t)}get accessList(){const t=this.#W||null;return null==t?1===this.type||2===this.type||3===this.type?[]:null:t}set accessList(t){this.#W=null==t?null:hr(t)}get authorizationList(){const t=this.#Y||null;return null==t&&4===this.type?[]:t}set authorizationList(t){this.#Y=null==t?null:t.map(t=>function(t){return{address:Me(t.address),nonce:ue(null!=t.nonce?t.nonce:0),chainId:ue(null!=t.chainId?t.chainId:0),signature:Ws.from(t.signature)}}(t))}get maxFeePerBlobGas(){const t=this.#H;return null==t&&3===this.type?Fo:t}set maxFeePerBlobGas(t){this.#H=null==t?null:ue(t,"maxFeePerBlobGas")}get blobVersionedHashes(){let t=this.#K;return null==t&&3===this.type?[]:t}set blobVersionedHashes(t){if(null!=t){$(Array.isArray(t),"blobVersionedHashes must be an Array","value",t),t=t.slice();for(let e=0;e<t.length;e++)$(Vt(t[e],32),"invalid blobVersionedHash",`value[${e}]`,t[e])}this.#K=t}get blobs(){return null==this.#J?null:this.#J.map(t=>Object.assign({},t))}set blobs(t){if(null==t)return void(this.#J=null);const e=[],n=[];for(let r=0;r<t.length;r++){const i=t[r];if(qt(i)){G(this.#z,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let t=Gt(i);if($(t.length<=jo,"blob is too large",`blobs[${r}]`,i),t.length!==jo){const e=new Uint8Array(jo);e.set(t),t=e}const s=this.#z.blobToKzgCommitment(t),o=Wt(this.#z.computeBlobKzgProof(t,s));e.push({data:Wt(t),commitment:Wt(s),proof:o}),n.push(Wo(1,s))}else{const t=Wt(i.commitment);e.push({data:Wt(i.data),commitment:t,proof:Wt(i.proof)}),n.push(Wo(1,t))}}this.#J=e,this.#K=n}get kzg(){return this.#z}set kzg(t){this.#z=null==t?null:function(t){return{blobToKzgCommitment:e=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return Gt(t.blobToKzgCommitment(Wt(e)))}else if("blobToKzgCommitment"in t&&"function"==typeof t.blobToKzgCommitment)return Gt(t.blobToKzgCommitment(e));if("blobToKZGCommitment"in t&&"function"==typeof t.blobToKZGCommitment)return Gt(t.blobToKZGCommitment(Wt(e)));$(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(e,n)=>"computeBlobProof"in t&&"function"==typeof t.computeBlobProof?Gt(t.computeBlobProof(Wt(e),Wt(n))):"computeBlobKzgProof"in t&&"function"==typeof t.computeBlobKzgProof?t.computeBlobKzgProof(e,n):"computeBlobKZGProof"in t&&"function"==typeof t.computeBlobKZGProof?Gt(t.computeBlobKZGProof(Wt(e),Wt(n))):void $(!1,"unsupported KZG library","kzg",t)}}(t)}constructor(){this.#U=null,this.#L=null,this.#M=0,this.#F=Fo,this.#D=null,this.#G=null,this.#$=null,this.#n="0x",this.#V=Fo,this.#q=Fo,this.#j=null,this.#W=null,this.#H=null,this.#K=null,this.#z=null,this.#J=null,this.#Y=null}get hash(){return null==this.signature?null:te(this.#Z(!0,!1))}get unsignedHash(){return te(this.unsignedSerialized)}get from(){return null==this.signature?null:(t=this.unsignedHash,e=this.signature,Mo(Hs.recoverPublicKey(t,e)));var t,e}get fromPublicKey(){return null==this.signature?null:Hs.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return null!=this.signature}#Z(t,e){G(!t||null!=this.signature,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=t?this.signature:null;switch(this.inferType()){case 0:return function(t,e){const n=[Zo(t.nonce,"nonce"),Zo(t.gasPrice||0,"gasPrice"),Zo(t.gasLimit,"gasLimit"),t.to||"0x",Zo(t.value,"value"),t.data];let r=Fo;if(t.chainId!=Fo)r=ue(t.chainId,"tx.chainId"),$(!e||null==e.networkV||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const e=t.signature.legacyChainId;null!=e&&(r=e)}if(!e)return r!==Fo&&(n.push(ye(r)),n.push("0x"),n.push("0x")),Ys(n);let i=BigInt(27+e.yParity);return r!==Fo?i=Ws.getChainIdV(r,e.v):BigInt(e.v)!==i&&$(!1,"tx.chainId/sig.v mismatch","sig",e),n.push(ye(i)),n.push(ye(e.r)),n.push(ye(e.s)),Ys(n)}(this,n);case 1:return function(t,e){const n=[Zo(t.chainId,"chainId"),Zo(t.nonce,"nonce"),Zo(t.gasPrice||0,"gasPrice"),Zo(t.gasLimit,"gasLimit"),t.to||"0x",Zo(t.value,"value"),t.data,Xo(t.accessList||[])];return e&&(n.push(Zo(e.yParity,"recoveryParam")),n.push(ye(e.r)),n.push(ye(e.s))),Ht(["0x01",Ys(n)])}(this,n);case 2:return function(t,e){const n=[Zo(t.chainId,"chainId"),Zo(t.nonce,"nonce"),Zo(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Zo(t.maxFeePerGas||0,"maxFeePerGas"),Zo(t.gasLimit,"gasLimit"),t.to||"0x",Zo(t.value,"value"),t.data,Xo(t.accessList||[])];return e&&(n.push(Zo(e.yParity,"yParity")),n.push(ye(e.r)),n.push(ye(e.s))),Ht(["0x02",Ys(n)])}(this,n);case 3:return function(t,e,n){const r=[Zo(t.chainId,"chainId"),Zo(t.nonce,"nonce"),Zo(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Zo(t.maxFeePerGas||0,"maxFeePerGas"),Zo(t.gasLimit,"gasLimit"),t.to||fo,Zo(t.value,"value"),t.data,Xo(t.accessList||[]),Zo(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Qo(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(r.push(Zo(e.yParity,"yParity")),r.push(ye(e.r)),r.push(ye(e.s)),n)?Ht(["0x03",Ys([r,n.map(t=>t.data),n.map(t=>t.commitment),n.map(t=>t.proof)])]):Ht(["0x03",Ys(r)])}(this,n,e?this.blobs:null);case 4:return function(t,e){const n=[Zo(t.chainId,"chainId"),Zo(t.nonce,"nonce"),Zo(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),Zo(t.maxFeePerGas||0,"maxFeePerGas"),Zo(t.gasLimit,"gasLimit"),t.to||"0x",Zo(t.value,"value"),t.data,Xo(t.accessList||[]),(r=t.authorizationList||[],r.map(t=>[Zo(t.chainId,"chainId"),t.address,Zo(t.nonce,"nonce"),Zo(t.signature.yParity,"yParity"),ye(t.signature.r),ye(t.signature.s)]))];var r;return e&&(n.push(Zo(e.yParity,"yParity")),n.push(ye(e.r)),n.push(ye(e.s))),Ht(["0x04",Ys(n)])}(this,n)}G(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#Z(!0,!0)}get unsignedSerialized(){return this.#Z(!1,!1)}inferType(){const t=this.inferTypes();return t.indexOf(2)>=0?2:t.pop()}inferTypes(){const t=null!=this.gasPrice,e=null!=this.maxFeePerGas||null!=this.maxPriorityFeePerGas,n=null!=this.accessList,r=null!=this.#H||this.#K;null!=this.maxFeePerGas&&null!=this.maxPriorityFeePerGas&&G(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),G(!e||0!==this.type&&1!==this.type,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),G(0!==this.type||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return null!=this.type?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):e?i.push(2):t?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(r&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return 0===this.type}isBerlin(){return 1===this.type}isLondon(){return 2===this.type}isCancun(){return 3===this.type}clone(){return ea.from(this)}toJSON(){const t=t=>null==t?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:t(this.gasLimit),gasPrice:t(this.gasPrice),maxPriorityFeePerGas:t(this.maxPriorityFeePerGas),maxFeePerGas:t(this.maxFeePerGas),value:t(this.value),chainId:t(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(t){if(null==t)return new ea;if("string"==typeof t){const e=Gt(t);if(e[0]>=127)return ea.from(function(t){const e=Lo(t);$(Array.isArray(e)&&(9===e.length||6===e.length),"invalid field count for legacy transaction","data",t);const n={type:0,nonce:Jo(e[0],"nonce"),gasPrice:Yo(e[1],"gasPrice"),gasLimit:Yo(e[2],"gasLimit"),to:Ho(e[3]),value:Yo(e[4],"value"),data:Wt(e[5]),chainId:Fo};if(6===e.length)return n;const r=Yo(e[6],"v"),i=Yo(e[7],"r"),s=Yo(e[8],"s");if(i===Fo&&s===Fo)n.chainId=r;else{let t=(r-Vo)/Do;t<Fo&&(t=Fo),n.chainId=t,$(t!==Fo||r===Go||r===$o,"non-canonical legacy v","v",e[6]),n.signature=Ws.from({r:Yt(e[7],32),s:Yt(e[8],32),v:r})}return n}(e));switch(e[0]){case 1:return ea.from(function(t){const e=Lo(Gt(t).slice(1));$(Array.isArray(e)&&(8===e.length||11===e.length),"invalid field count for transaction type: 1","data",Wt(t));const n={type:1,chainId:Yo(e[0],"chainId"),nonce:Jo(e[1],"nonce"),gasPrice:Yo(e[2],"gasPrice"),gasLimit:Yo(e[3],"gasLimit"),to:Ho(e[4]),value:Yo(e[5],"value"),data:Wt(e[6]),accessList:Ko(e[7],"accessList")};return 8===e.length||ta(n,e.slice(8)),n}(e));case 2:return ea.from(function(t){const e=Lo(Gt(t).slice(1));$(Array.isArray(e)&&(9===e.length||12===e.length),"invalid field count for transaction type: 2","data",Wt(t));const n={type:2,chainId:Yo(e[0],"chainId"),nonce:Jo(e[1],"nonce"),maxPriorityFeePerGas:Yo(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Yo(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Yo(e[4],"gasLimit"),to:Ho(e[5]),value:Yo(e[6],"value"),data:Wt(e[7]),accessList:Ko(e[8],"accessList")};return 9===e.length||ta(n,e.slice(9)),n}(e));case 3:return ea.from(function(t){let e=Lo(Gt(t).slice(1)),n="3",r=null;if(4===e.length&&Array.isArray(e[0])){n="3 (network format)";const t=e[1],i=e[2],s=e[3];$(Array.isArray(t),"invalid network format: blobs not an array","fields[1]",t),$(Array.isArray(i),"invalid network format: commitments not an array","fields[2]",i),$(Array.isArray(s),"invalid network format: proofs not an array","fields[3]",s),$(t.length===i.length,"invalid network format: blobs/commitments length mismatch","fields",e),$(t.length===s.length,"invalid network format: blobs/proofs length mismatch","fields",e),r=[];for(let n=0;n<e[1].length;n++)r.push({data:t[n],commitment:i[n],proof:s[n]});e=e[0]}$(Array.isArray(e)&&(11===e.length||14===e.length),`invalid field count for transaction type: ${n}`,"data",Wt(t));const i={type:3,chainId:Yo(e[0],"chainId"),nonce:Jo(e[1],"nonce"),maxPriorityFeePerGas:Yo(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Yo(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Yo(e[4],"gasLimit"),to:Ho(e[5]),value:Yo(e[6],"value"),data:Wt(e[7]),accessList:Ko(e[8],"accessList"),maxFeePerBlobGas:Yo(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};r&&(i.blobs=r),$(null!=i.to,`invalid address for transaction type: ${n}`,"data",t),$(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let e=0;e<i.blobVersionedHashes.length;e++)$(Vt(i.blobVersionedHashes[e],32),`invalid blobVersionedHash at index ${e}: must be length 32`,"data",t);return 11===e.length||ta(i,e.slice(11)),i}(e));case 4:return ea.from(function(t){const e=Lo(Gt(t).slice(1));$(Array.isArray(e)&&(10===e.length||13===e.length),"invalid field count for transaction type: 4","data",Wt(t));const n={type:4,chainId:Yo(e[0],"chainId"),nonce:Jo(e[1],"nonce"),maxPriorityFeePerGas:Yo(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Yo(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Yo(e[4],"gasLimit"),to:Ho(e[5]),value:Yo(e[6],"value"),data:Wt(e[7]),accessList:Ko(e[8],"accessList"),authorizationList:zo(e[9],"authorizationList")};return 10===e.length||ta(n,e.slice(10)),n}(e))}G(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const e=new ea;return null!=t.type&&(e.type=t.type),null!=t.to&&(e.to=t.to),null!=t.nonce&&(e.nonce=t.nonce),null!=t.gasLimit&&(e.gasLimit=t.gasLimit),null!=t.gasPrice&&(e.gasPrice=t.gasPrice),null!=t.maxPriorityFeePerGas&&(e.maxPriorityFeePerGas=t.maxPriorityFeePerGas),null!=t.maxFeePerGas&&(e.maxFeePerGas=t.maxFeePerGas),null!=t.maxFeePerBlobGas&&(e.maxFeePerBlobGas=t.maxFeePerBlobGas),null!=t.data&&(e.data=t.data),null!=t.value&&(e.value=t.value),null!=t.chainId&&(e.chainId=t.chainId),null!=t.signature&&(e.signature=Ws.from(t.signature)),null!=t.accessList&&(e.accessList=t.accessList),null!=t.authorizationList&&(e.authorizationList=t.authorizationList),null!=t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes),null!=t.kzg&&(e.kzg=t.kzg),null!=t.blobs&&(e.blobs=t.blobs),null!=t.hash&&($(e.isSigned(),"unsigned transaction cannot define '.hash'","tx",t),$(e.hash===t.hash,"hash mismatch","tx",t)),null!=t.from&&($(e.isSigned(),"unsigned transaction cannot define '.from'","tx",t),$(e.from.toLowerCase()===(t.from||"").toLowerCase(),"from mismatch","tx",t)),e}}function na(t,e){if(t.provider)return t.provider;G(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function ra(t,e){let n=fr(e);if(null!=n.to&&(n.to=cr(n.to,t)),null!=n.from){const e=n.from;n.from=Promise.all([t.getAddress(),cr(e,t)]).then(([t,e])=>($(t.toLowerCase()===e.toLowerCase(),"transaction from mismatch","tx.from",e),t))}else n.from=t.getAddress();return await B(n)}class ia{provider;constructor(t){U(this,{provider:t||null})}async getNonce(t){return na(this,"getTransactionCount").getTransactionCount(await this.getAddress(),t)}async populateCall(t){return await ra(this,t)}async populateTransaction(t){const e=na(this,"populateTransaction"),n=await ra(this,t);null==n.nonce&&(n.nonce=await this.getNonce("pending")),null==n.gasLimit&&(n.gasLimit=await this.estimateGas(n));const r=await this.provider.getNetwork();null!=n.chainId?$(ue(n.chainId)===r.chainId,"transaction chainId mismatch","tx.chainId",t.chainId):n.chainId=r.chainId;const i=null!=n.maxFeePerGas||null!=n.maxPriorityFeePerGas;if(null==n.gasPrice||2!==n.type&&!i?0!==n.type&&1!==n.type||!i||$(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",t):$(!1,"eip-1559 transaction do not support gasPrice","tx",t),2!==n.type&&null!=n.type||null==n.maxFeePerGas||null==n.maxPriorityFeePerGas)if(0===n.type||1===n.type){const t=await e.getFeeData();G(null!=t.gasPrice,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),null==n.gasPrice&&(n.gasPrice=t.gasPrice)}else{const t=await e.getFeeData();if(null==n.type)if(null!=t.maxFeePerGas&&null!=t.maxPriorityFeePerGas)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,null!=n.gasPrice){const t=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=t,n.maxPriorityFeePerGas=t}else null==n.maxFeePerGas&&(n.maxFeePerGas=t.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=t.maxPriorityFeePerGas);else null!=t.gasPrice?(G(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),null==n.gasPrice&&(n.gasPrice=t.gasPrice),n.type=0):G(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else 2!==n.type&&3!==n.type&&4!==n.type||(null==n.maxFeePerGas&&(n.maxFeePerGas=t.maxFeePerGas),null==n.maxPriorityFeePerGas&&(n.maxPriorityFeePerGas=t.maxPriorityFeePerGas))}else n.type=2;return await B(n)}async populateAuthorization(t){const e=Object.assign({},t);return null==e.chainId&&(e.chainId=(await na(this,"getNetwork").getNetwork()).chainId),null==e.nonce&&(e.nonce=await this.getNonce()),e}async estimateGas(t){return na(this,"estimateGas").estimateGas(await this.populateCall(t))}async call(t){return na(this,"call").call(await this.populateCall(t))}async resolveName(t){const e=na(this,"resolveName");return await e.resolveName(t)}async sendTransaction(t){const e=na(this,"sendTransaction"),n=await this.populateTransaction(t);delete n.from;const r=ea.from(n);return await e.broadcastTransaction(await this.signTransaction(r))}authorize(t){G(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}class sa extends ia{address;constructor(t,e){super(e),U(this,{address:t})}async getAddress(){return this.address}connect(t){return new sa(this.address,t)}#X(t,e){G(!1,`VoidSigner cannot sign ${t}`,"UNSUPPORTED_OPERATION",{operation:e})}async signTransaction(t){this.#X("transactions","signTransaction")}async signMessage(t){this.#X("messages","signMessage")}async signTypedData(t,e,n){this.#X("typed-data","signTypedData")}}class oa extends ia{address;#Q;constructor(t,e){super(e),$(t&&"function"==typeof t.sign,"invalid private key","privateKey","[ REDACTED ]"),this.#Q=t,U(this,{address:Mo(this.signingKey.publicKey)})}get signingKey(){return this.#Q}get privateKey(){return this.signingKey.privateKey}async getAddress(){return this.address}connect(t){return new oa(this.#Q,t)}async signTransaction(t){t=fr(t);const{to:e,from:n}=await B({to:t.to?cr(t.to,this):void 0,from:t.from?cr(t.from,this):void 0});null!=e&&(t.to=e),null!=n&&(t.from=n),null!=t.from&&($(Me(t.from)===this.address,"transaction from address mismatch","tx.from",t.from),delete t.from);const r=ea.from(t);return r.signature=this.signingKey.sign(r.unsignedHash),r.serialized}async signMessage(t){return this.signMessageSync(t)}signMessageSync(t){return this.signingKey.sign(function(t){return"string"==typeof t&&(t=re(t)),te(Ht([re("Ethereum Signed Message:\n"),re(String(t.length)),t]))}(t)).serialized}authorizeSync(t){$("string"==typeof t.address,"invalid address for authorizeSync","auth.address",t);const e=this.signingKey.sign(function(t){return $("string"==typeof t.address,"invalid address for hashAuthorization","auth.address",t),te(Ht(["0x05",Ys([null!=t.chainId?ye(t.chainId):"0x",Me(t.address),null!=t.nonce?ye(t.nonce):"0x"])]))}(t));return Object.assign({},{address:Me(t.address),nonce:ue(t.nonce||0),chainId:ue(t.chainId||0)},{signature:e})}async authorize(t){return t=Object.assign({},t,{address:await cr(t.address,this)}),this.authorizeSync(await this.populateAuthorization(t))}async signTypedData(t,e,n){const r=await uo.resolveNames(t,e,n,async t=>{G(null!=this.provider,"cannot resolve ENS names without a provider","UNSUPPORTED_OPERATION",{operation:"resolveName",info:{name:t}});const e=await this.provider.resolveName(t);return G(null!=e,"unconfigured ENS name","UNCONFIGURED_NAME",{value:t}),e});return this.signingKey.sign(uo.hash(r.domain,e,r.value)).serialized}}let aa=!1;const ca=function(t,e,n){return function(t,e){const n={sha256:Ui,sha512:vo}[t];return $(null!=n,"invalid hmac algorithm","algorithm",t),ys.create(n,e)}(t,e).update(n).digest()};let la=ca;function ha(t,e,n){const r=Gt(e,"key"),i=Gt(n,"data");return Wt(la(t,r,i))}ha._=ca,ha.lock=function(){aa=!0},ha.register=function(t){if(aa)throw new Error("computeHmac is locked");la=t},Object.freeze(ha);const ua=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),da=Uint8Array.from({length:16},(t,e)=>e);let fa=[da],pa=[da.map(t=>(9*t+5)%16)];for(let t=0;t<4;t++)for(let e of[fa,pa])e.push(e[t].map(t=>ua[t]));const ga=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),ma=fa.map((t,e)=>t.map(t=>ga[e][t])),ya=pa.map((t,e)=>t.map(t=>ga[e][t])),wa=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),ba=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),va=(t,e)=>t<<e|t>>>32-e;function Ea(t,e,n,r){return 0===t?e^n^r:1===t?e&n|~e&r:2===t?(e|~n)^r:3===t?e&r|n&~r:e^(n|~r)}const Ia=new Uint32Array(16);class Aa extends Oi{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:n,h3:r,h4:i}=this;return[t,e,n,r,i]}set(t,e,n,r,i){this.h0=0|t,this.h1=0|e,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(t,e){for(let n=0;n<16;n++,e+=4)Ia[n]=t.getUint32(e,!0);let n=0|this.h0,r=n,i=0|this.h1,s=i,o=0|this.h2,a=o,c=0|this.h3,l=c,h=0|this.h4,u=h;for(let t=0;t<5;t++){const e=4-t,d=wa[t],f=ba[t],p=fa[t],g=pa[t],m=ma[t],y=ya[t];for(let e=0;e<16;e++){const r=va(n+Ea(t,i,o,c)+Ia[p[e]]+d,m[e])+h|0;n=h,h=c,c=0|va(o,10),o=i,i=r}for(let t=0;t<16;t++){const n=va(r+Ea(e,s,a,l)+Ia[g[t]]+f,y[t])+u|0;r=u,u=l,l=0|va(a,10),a=s,s=n}}this.set(this.h1+o+l|0,this.h2+c+u|0,this.h3+h+r|0,this.h4+n+s|0,this.h0+i+a|0)}roundClean(){Ia.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const ka=It(()=>new Aa);let Ca=!1;const Na=function(t){return ka(t)};let Ta=Na;function Oa(t){const e=Gt(t,"data");return Wt(Ta(e))}Oa._=Na,Oa.lock=function(){Ca=!0},Oa.register=function(t){if(Ca)throw new TypeError("ripemd160 is locked");Ta=t},Object.freeze(Oa);let xa=!1;const Sa=function(t){return new Uint8Array(function(t){G(null!=Io,"platform does not support secure random numbers","UNSUPPORTED_OPERATION",{operation:"randomBytes"}),$(Number.isInteger(t)&&t>0&&t<=1024,"invalid length","length",t);const e=new Uint8Array(t);return Io.getRandomValues(e),e}(t))};let Ra=Sa;function _a(t){return Ra(t)}_a._=Sa,_a.lock=function(){xa=!0},_a.register=function(t){if(xa)throw new Error("randomBytes is locked");Ra=t},Object.freeze(_a);const Pa="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";let Ba=null;function Ua(t){if(null==Ba){Ba={};for(let t=0;t<58;t++)Ba[Pa[t]]=BigInt(t)}const e=Ba[t];return $(null!=e,"invalid base58 value","letter",t),e}const La=BigInt(0),Ma=BigInt(58),Fa=/^[a-z]*$/i;function Da(t,e){let n=97;return t.reduce((t,r)=>(r===e?n++:r.match(Fa)?t.push(String.fromCharCode(n)+r):(n=97,t.push(r)),t),[])}class Ga{locale;constructor(t){U(this,{locale:t})}split(t){return t.toLowerCase().split(/\s+/g)}join(t){return t.join(" ")}}class $a extends Ga{#n;#tt;constructor(t,e,n){super(t),this.#n=e,this.#tt=n,this.#et=null}get _data(){return this.#n}_decodeWords(){return $("0"===(t=this.#n)[0],"unsupported auwl data","data",t),function(t,e){for(let n=28;n>=0;n--)t=t.split(" !#$%&'()*+,-./<=>?@[]^_`{|}~"[n]).join(e.substring(2*n,2*n+2));const n=[],r=t.replace(/(:|([0-9])|([A-Z][a-z]*))/g,(t,e,r,i)=>{if(r)for(let t=parseInt(r);t>=0;t--)n.push(";");else n.push(e.toLowerCase());return""});if(r)throw new Error(`leftovers: ${JSON.stringify(r)}`);return Da(Da(n,";"),":")}(t.substring(59),t.substring(1,59));var t}#et;#nt(){if(null==this.#et){const t=this._decodeWords();if(se(t.join("\n")+"\n")!==this.#tt)throw new Error(`BIP39 Wordlist for ${this.locale} FAILED`);this.#et=t}return this.#et}getWord(t){const e=this.#nt();return $(t>=0&&t<e.length,`invalid word index: ${t}`,"index",t),e[t]}getWordIndex(t){return this.#nt().indexOf(t)}}let Va=null;class qa extends $a{constructor(){super("en","0erleonalorenseinceregesticitStanvetearctssi#ch2Athck&tneLl0And#Il.yLeOutO=S|S%b/ra@SurdU'0Ce[Cid|CountCu'Hie=IdOu,-Qui*Ro[TT]T%T*[Tu$0AptDD-tD*[Ju,M.UltV<)Vi)0Rob-0FairF%dRaid0A(EEntRee0Ead0MRRp%tS!_rmBumCoholErtI&LLeyLowMo,O}PhaReadySoT Ways0A>urAz(gOngOuntU'd0Aly,Ch%Ci|G G!GryIm$K!Noun)Nu$O` Sw T&naTiqueXietyY1ArtOlogyPe?P!Pro=Ril1ChCt-EaEnaGueMMedM%MyOundR<+Re,Ri=RowTTefa@Ti,Tw%k0KPe@SaultSetSi,SumeThma0H!>OmTa{T&dT.udeTra@0Ct]D.Gu,NtTh%ToTumn0Era+OcadoOid0AkeA*AyEsomeFulKw?d0Is:ByChel%C#D+GL<)Lc#y~MbooN<aNn RRelyRga(R*lSeS-SketTt!3A^AnAutyCau'ComeEfF%eG(Ha=H(dLie=LowLtN^Nef./TrayTt Twe&Y#d3Cyc!DKeNdOlogyRdR`Tt _{AdeAmeAnketA,EakE[IndOodO[omOu'UeUrUsh_rdAtDyIlMbNeNusOkO,Rd R(gRrowSsTtomUn)XY_{etA(AndA[A=EadEezeI{Id+IefIghtIngIskOccoliOk&OnzeOomO` OwnUsh2Bb!DdyD+tFf$oIldLbLkL!tNd!Nk Rd&Rg R,SS(e[SyTt Y Zz:Bba+B(B!CtusGeKe~LmM aMpNN$N)lNdyNn#NoeNvasNy#Pab!P.$Pta(RRb#RdRgoRpetRryRtSeShS(o/!Su$TT$ogT^Teg%yTt!UghtU'Ut]Ve3Il(gL yM|NsusNturyRe$Rta(_irAlkAmp]An+AosApt Ar+A'AtEapE{Ee'EfErryE,I{&IefIldIm}yOi)Oo'R#-U{!UnkUrn0G?Nnam#Rc!Tiz&TyVil_imApArifyAwAyE<ErkEv I{I|IffImbIn-IpO{OgO'O`OudOwnUbUmpU, Ut^_^A,C#utDeFfeeIlInL!@L%LumnMb(eMeMf%tM-Mm#Mp<yNc tNdu@NfirmNg*[N}@Nsid NtrolNv()OkOlPp PyR$ReRnR*@/Tt#U^UntryUp!Ur'Us(V Yo>_{Ad!AftAmA}AshAt AwlAzyEamEd.EekEwI{etImeIspIt-OpO[Ou^OwdUci$UelUi'Umb!Un^UshYY,$2BeLtu*PPbo?dRiousRr|Rta(R=Sh]/omTe3C!:DMa+MpN)Ng R(gShUght WnY3AlBa>BrisCadeCemb CideCl(eC%a>C*a'ErF&'F(eFyG*eLayLiv M<dMi'Ni$Nti,NyP?tP&dPos.P`PutyRi=ScribeS tSignSkSpair/royTailTe@VelopVi)Vo>3AgramAlAm#dAryCeE'lEtFf G.$Gn.yLemmaNn NosaurRe@RtSag*eScov Sea'ShSmi[S%d Splay/<)V tVideV%)Zzy5Ct%Cum|G~Lph(Ma(Na>NkeyN%OrSeUb!Ve_ftAg#AmaA,-AwEamE[IftIllInkIpI=OpUmY2CkMbNeR(g/T^Ty1Arf1Nam-:G G!RlyRnR`Sily/Sy1HoOlogyOnomy0GeItUca>1F%t0G1GhtTh 2BowD E@r-Eg<tEm|Eph<tEvat%I>Se0B?kBodyBra)Er+Ot]PloyPow Pty0Ab!A@DD![D%'EmyErgyF%)Ga+G(eH<)JoyLi,OughR-hRollSu*T Ti*TryVelope1Isode0U$Uip0AA'OdeOs]R%Upt0CapeSayS&)Ta>0Ern$H-s1Id&)IlOkeOl=1A@Amp!Ce[Ch<+C.eCludeCu'Ecu>Erci'Hau,Hib.I!I,ItOt-P<dPe@Pi*Pla(Po'P*[T&dTra0EEbrow:Br-CeCultyDeIntI`~L'MeMilyMousNNcyNtasyRmSh]TT$Th TigueUltV%.e3Atu*Bru?yD $EEdElMa!N)/iv$T^V W3B Ct]EldGu*LeLmLt N$NdNeNg NishReRmR,Sc$ShTT}[X_gAmeAshAtAv%EeIghtIpOatO{O%Ow UidUshY_mCusGIlLd~owOdOtR)Re,R+tRkRtu}RumRw?dSsil/ UndX_gi!AmeEqu|EshI&dIn+OgOntO,OwnOz&U.2ElNNnyRna)RyTu*:D+tInLaxy~ yMePRa+Rba+Rd&Rl-Rm|SSpTeTh U+Ze3N $NiusN*Nt!Nu(e/u*2O,0AntFtGg!Ng RaffeRlVe_dAn)A*A[IdeImp'ObeOomOryO=OwUe_tDde[LdOdO'RillaSpelSsipV nWn_bA)A(AntApeA[Av.yEatE&IdIefItOc yOupOwUnt_rdE[IdeIltIt?N3M:B.IrLfMm M, NdPpyRb%RdRshR=,TVeWkZ?d3AdAl`ArtAvyD+hogIght~oLmetLpNRo3Dd&Gh~NtPRe/%y5BbyCkeyLdLeLiday~owMeNeyOdPeRnRr%R'Sp.$/TelUrV 5BGeM<Mb!M%Nd*dNgryNtRd!RryRtSb<d3Brid:1EOn0EaEntifyLe2N%e4LLeg$L}[0A+Ita>M&'Mu}Pa@Po'Pro=Pul'0ChCludeComeC*a'DexD-a>Do%Du,ryF<tFl-tF%mHa!H .Iti$Je@JuryMa>N Noc|PutQuiryS<eSe@SideSpi*/$lTa@T e,ToVe,V.eVol=3On0L<dOla>Sue0Em1Ory:CketGu?RZz3AlousAns~yWel9BInKeUr}yY5D+I)MpNg!Ni%Nk/:Ng?oo3EnEpT^upY3CkDD}yNdNgdomSsTT^&TeTt&Wi4EeIfeO{Ow:BBelB%Dd DyKeMpNgua+PtopR+T T(UghUndryVaWWnWsu.Y Zy3Ad AfArnA=Ctu*FtGG$G&dIsu*M#NdNg`NsOp?dSs#Tt Vel3ArB tyBr?yC&'FeFtGhtKeMbM.NkOnQuid/Tt!VeZ?d5AdAnB, C$CkG-NelyNgOpTt yUdUn+VeY$5CkyGga+Mb N?N^Xury3R-s:Ch(eDG-G}tIdIlInJ%KeMm$NNa+Nda>NgoNs]Nu$P!Rb!R^Rg(R(eRketRria+SkSs/ T^T i$ThTrixTt XimumZe3AdowAnAsu*AtCh<-D$DiaLodyLtMb M%yNt]NuRcyR+R.RryShSsa+T$Thod3Dd!DnightLk~]M-NdNimumN%Nu>Rac!Rr%S ySs/akeXXedXtu*5Bi!DelDifyMM|N.%NkeyN, N`OnR$ReRn(gSqu.oTh T]T%Unta(U'VeVie5ChFf(LeLtiplySc!SeumShroomS-/Tu$3Self/ yTh:I=MePk(Rrow/yT]Tu*3ArCkEdGati=G!@I` PhewR=/TTw%kUtr$V WsXt3CeGht5B!I'M(eeOd!Rm$R`SeTab!TeTh(gTi)VelW5C!?Mb R'T:K0EyJe@Li+Scu*S =Ta(Vious0CurE<Tob 0Or1FF Fi)T&2L1Ay0DI=Ymp-0It0CeEI#L(eLy1EnEraIn]Po'T]1An+B.Ch?dD D(?yG<I|Ig($Ph<0Tr-h0H 0Tdo%T TputTside0AlEnEr0NN 0Yg&0/ 0O}:CtDd!GeIrLa)LmNdaNelN-N` P RadeR|RkRrotRtySsT^ThTi|TrolTt nU'VeYm|3A)AnutArAs<tL-<NN$tyNcilOp!Pp Rfe@Rm.Rs#T2O}OtoRa'Ys-$0AnoCn-Ctu*E)GGe#~LotNkO} Pe/olT^Zza_)A}tA,-A>AyEa'Ed+U{UgUn+2EmEtIntL?LeLi)NdNyOlPul?Rt]S.]Ssib!/TatoTt yV tyWd W _@i)Ai'Ed-tEf Epa*Es|EttyEv|I)IdeIm?yIntI%.yIs#Iva>IzeOb!mO)[Odu)Of.OgramOje@Omo>OofOp tyOsp O>@OudOvide2Bl-Dd(g~LpL'Mpk(N^PilPpyR^a'R.yRpo'R'ShTZz!3Ramid:99Al.yAntumArt E,]I{ItIzO>:Bb.Cco#CeCkD?DioIlInI'~yMpN^NdomN+PidReTeTh V&WZ%3AdyAlAs#BelBuildC$lCei=CipeC%dCyc!Du)F!@F%mFu'G]G*tGul?Je@LaxLea'LiefLyMa(Memb M(dMo=Nd NewNtOp&PairPeatPla)P%tQui*ScueSemb!Si,Sour)Sp#'SultTi*T*atTurnUn]Ve$ViewW?d2Y`m0BBb#CeChDeD+F!GhtGidNgOtPp!SkTu$V$V 5AdA,BotBu,CketM<)OfOkieOmSeTa>UghUndU>Y$5Bb DeGLeNNwayR$:DDd!D}[FeIlLadLm#L#LtLu>MeMp!NdTisfyToshiU)Usa+VeY1A!AnA*Att E}HemeHoolI&)I[%sOrp]OutRapRe&RiptRub1AAr^As#AtC#dC*tCt]Cur.yEdEkGm|Le@~M(?Ni%N'Nt&)RiesRvi)Ss]Tt!TupV&_dowAftAllowA*EdEllEriffIeldIftI}IpIv O{OeOotOpOrtOuld O=RimpRugUff!Y0Bl(gCkDeE+GhtGnL|Lk~yLv Mil?Mp!N)NgR&/ Tua>XZe1A>Et^IIllInIrtUll0AbAmEepEnd I)IdeIghtImOg<OtOwUsh0AllArtI!OkeOo`0A{AkeApIffOw0ApCc Ci$CkDaFtL?Ldi LidLut]L=Me#eNgOnRryRtUlUndUpUr)U`0A)A*Ati$AwnEakEci$EedEllEndH eI)Id IkeInIr.L.OilOns%O#OrtOtRayReadR(gY0Ua*UeezeUir*l_b!AdiumAffA+AirsAmpAndArtA>AyEakEelEmEpE*oI{IllIngO{Oma^O}OolOryO=Ra>gyReetRikeR#gRugg!Ud|UffUmb!Y!0Bje@Bm.BwayC)[ChDd&Ff G?G+,ItMm NNnyN'tP PplyP*meReRfa)R+Rpri'RroundR=ySpe@/a(1AllowAmpApArmE?EetIftImIngIt^Ord1MbolMptomRup/em:B!Ck!GIlL|LkNkPeR+tSk/eTtooXi3A^Am~NN<tNnisNtRm/Xt_nkAtEmeEnE%yE*EyIngIsOughtReeRi=RowUmbUnd 0CketDeG LtMb MeNyPRedSsueT!5A,BaccoDayDdl EGe` I!tK&MatoM%rowNeNgueNightOlO`PP-Pp!R^RnadoRtoi'SsT$Uri,W?dW WnY_{AdeAff-Ag-A(Ansf ApAshA=lAyEatEeEndI$IbeI{Igg ImIpOphyOub!U{UeUlyUmpetU,U`Y2BeIt]Mb!NaN}lRkeyRnRt!1El=EntyI)InI,O1PeP-$:5Ly5B*lla0Ab!Awa*C!Cov D DoFairFoldHappyIf%mIqueItIv 'KnownLo{TilUsu$Veil1Da>GradeHoldOnP Set1B<Ge0A+EEdEfulE![U$0Il.y:C<tCuumGueLidL!yL=NNishP%Rious/Ult3H-!L=tNd%Ntu*NueRbRifyRs]RyS'lT <3Ab!Br<tCiousCt%yDeoEw~a+Nta+Ol(Rtu$RusSaS.Su$T$Vid5C$I)IdLc<oLumeTeYa+:GeG#ItLk~LnutNtRfa*RmRri%ShSp/eT VeY3Al`Ap#ArA'lA` BDd(gEk&dIrdLcome/T_!AtEatEelEnE*IpIsp 0DeD`FeLd~NNdowNeNgNkNn Nt ReSdomSeShT}[5LfM<Nd OdOlRdRkRldRryR`_pE{E,!I,I>Ong::Rd3Ar~ow9UUngU`:3BraRo9NeO","0x3c8acc1e7b08d8e76f9fda015ef48dc8c710a73cb7e0f77b2c18a9b5a7adde60")}static wordlist(){return null==Va&&(Va=new qa),Va}}let ja=!1;const Wa=function(t,e,n,r,i){return function(t,e,n,r,i){const s={sha256:Ui,sha512:vo}[i];return $(null!=s,"invalid pbkdf2 algorithm","algorithm",i),po(s,t,e,{c:n,dkLen:r})}(t,e,n,r,i)};let Ha=Wa;function Ka(t,e,n,r,i){const s=Gt(t,"password"),o=Gt(e,"salt");return Wt(Ha(s,o,n,r,i))}function za(t){return(1<<t)-1<<8-t&255}function Ja(t){return(1<<t)-1&255}function Ya(t,e){j("NFKD"),null==e&&(e=qa.wordlist());const n=e.split(t);$(n.length%3==0&&n.length>=12&&n.length<=24,"invalid mnemonic length","mnemonic","[ REDACTED ]");const r=new Uint8Array(Math.ceil(11*n.length/8));let i=0;for(let t=0;t<n.length;t++){let s=e.getWordIndex(n[t].normalize("NFKD"));$(s>=0,`invalid mnemonic word at index ${t}`,"mnemonic","[ REDACTED ]");for(let t=0;t<11;t++)s&1<<10-t&&(r[i>>3]|=1<<7-i%8),i++}const s=32*n.length/3,o=za(n.length/3);return $((Gt(So(r.slice(0,s/8)))[0]&o)===(r[r.length-1]&o),"invalid mnemonic checksum","mnemonic","[ REDACTED ]"),Wt(r.slice(0,s/8))}function Za(t,e){$(t.length%4==0&&t.length>=16&&t.length<=32,"invalid entropy size","entropy","[ REDACTED ]"),null==e&&(e=qa.wordlist());const n=[0];let r=11;for(let e=0;e<t.length;e++)r>8?(n[n.length-1]<<=8,n[n.length-1]|=t[e],r-=8):(n[n.length-1]<<=r,n[n.length-1]|=t[e]>>8-r,n.push(t[e]&Ja(8-r)),r+=3);const i=t.length/4,s=parseInt(So(t).substring(2,4),16)&za(i);return n[n.length-1]<<=i,n[n.length-1]|=s>>8-i,e.join(n.map(t=>e.getWord(t)))}Ka._=Wa,Ka.lock=function(){ja=!0},Ka.register=function(t){if(ja)throw new Error("pbkdf2 is locked");Ha=t},Object.freeze(Ka);const Xa={};class Qa{phrase;password;wordlist;entropy;constructor(t,e,n,r,i){null==r&&(r=""),null==i&&(i=qa.wordlist()),W(t,Xa,"Mnemonic"),U(this,{phrase:n,password:r,wordlist:i,entropy:e})}computeSeed(){const t=re("mnemonic"+this.password,"NFKD");return Ka(re(this.phrase,"NFKD"),t,2048,64,"sha512")}static fromPhrase(t,e,n){const r=Ya(t,n);return t=Za(Gt(r),n),new Qa(Xa,r,t,e,n)}static fromEntropy(t,e,n){const r=Gt(t,"entropy"),i=Za(r,n);return new Qa(Xa,Wt(r),i,e,n)}static entropyToPhrase(t,e){return Za(Gt(t,"entropy"),e)}static phraseToEntropy(t,e){return Ya(t,e)}static isValidMnemonic(t,e){try{return Ya(t,e),!0}catch(t){}return!1}}var tc,ec,nc,rc=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},ic=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n};const sc={16:10,24:12,32:14},oc=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],ac=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],cc=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],lc=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],hc=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],uc=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],dc=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],fc=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],pc=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],gc=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],mc=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],yc=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],wc=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],bc=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],vc=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function Ec(t){const e=[];for(let n=0;n<t.length;n+=4)e.push(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]);return e}class Ic{get key(){return rc(this,tc,"f").slice()}constructor(t){if(tc.set(this,void 0),ec.set(this,void 0),nc.set(this,void 0),!(this instanceof Ic))throw Error("AES must be instanitated with `new`");ic(this,tc,new Uint8Array(t),"f");const e=sc[this.key.length];if(null==e)throw new TypeError("invalid key size (must be 16, 24 or 32 bytes)");ic(this,nc,[],"f"),ic(this,ec,[],"f");for(let t=0;t<=e;t++)rc(this,nc,"f").push([0,0,0,0]),rc(this,ec,"f").push([0,0,0,0]);const n=4*(e+1),r=this.key.length/4,i=Ec(this.key);let s;for(let t=0;t<r;t++)s=t>>2,rc(this,nc,"f")[s][t%4]=i[t],rc(this,ec,"f")[e-s][t%4]=i[t];let o,a=0,c=r;for(;c<n;){if(o=i[r-1],i[0]^=ac[o>>16&255]<<24^ac[o>>8&255]<<16^ac[255&o]<<8^ac[o>>24&255]^oc[a]<<24,a+=1,8!=r)for(let t=1;t<r;t++)i[t]^=i[t-1];else{for(let t=1;t<r/2;t++)i[t]^=i[t-1];o=i[r/2-1],i[r/2]^=ac[255&o]^ac[o>>8&255]<<8^ac[o>>16&255]<<16^ac[o>>24&255]<<24;for(let t=r/2+1;t<r;t++)i[t]^=i[t-1]}let t,s,l=0;for(;l<r&&c<n;)t=c>>2,s=c%4,rc(this,nc,"f")[t][s]=i[l],rc(this,ec,"f")[e-t][s]=i[l++],c++}for(let t=1;t<e;t++)for(let e=0;e<4;e++)o=rc(this,ec,"f")[t][e],rc(this,ec,"f")[t][e]=yc[o>>24&255]^wc[o>>16&255]^bc[o>>8&255]^vc[255&o]}encrypt(t){if(16!=t.length)throw new TypeError("invalid plaintext size (must be 16 bytes)");const e=rc(this,nc,"f").length-1,n=[0,0,0,0];let r=Ec(t);for(let t=0;t<4;t++)r[t]^=rc(this,nc,"f")[0][t];for(let t=1;t<e;t++){for(let e=0;e<4;e++)n[e]=lc[r[e]>>24&255]^hc[r[(e+1)%4]>>16&255]^uc[r[(e+2)%4]>>8&255]^dc[255&r[(e+3)%4]]^rc(this,nc,"f")[t][e];r=n.slice()}const i=new Uint8Array(16);let s=0;for(let t=0;t<4;t++)s=rc(this,nc,"f")[e][t],i[4*t]=255&(ac[r[t]>>24&255]^s>>24),i[4*t+1]=255&(ac[r[(t+1)%4]>>16&255]^s>>16),i[4*t+2]=255&(ac[r[(t+2)%4]>>8&255]^s>>8),i[4*t+3]=255&(ac[255&r[(t+3)%4]]^s);return i}decrypt(t){if(16!=t.length)throw new TypeError("invalid ciphertext size (must be 16 bytes)");const e=rc(this,ec,"f").length-1,n=[0,0,0,0];let r=Ec(t);for(let t=0;t<4;t++)r[t]^=rc(this,ec,"f")[0][t];for(let t=1;t<e;t++){for(let e=0;e<4;e++)n[e]=fc[r[e]>>24&255]^pc[r[(e+3)%4]>>16&255]^gc[r[(e+2)%4]>>8&255]^mc[255&r[(e+1)%4]]^rc(this,ec,"f")[t][e];r=n.slice()}const i=new Uint8Array(16);let s=0;for(let t=0;t<4;t++)s=rc(this,ec,"f")[e][t],i[4*t]=255&(cc[r[t]>>24&255]^s>>24),i[4*t+1]=255&(cc[r[(t+3)%4]>>16&255]^s>>16),i[4*t+2]=255&(cc[r[(t+2)%4]>>8&255]^s>>8),i[4*t+3]=255&(cc[255&r[(t+1)%4]]^s);return i}}tc=new WeakMap,ec=new WeakMap,nc=new WeakMap;class Ac{constructor(t,e,n){if(n&&!(this instanceof n))throw new Error(`${t} must be instantiated with "new"`);Object.defineProperties(this,{aes:{enumerable:!0,value:new Ic(e)},name:{enumerable:!0,value:t}})}}var kc,Cc,Nc=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Tc=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Oc extends Ac{constructor(t,e){if(super("ECC",t,Oc),kc.set(this,void 0),Cc.set(this,void 0),e){if(e.length%16)throw new TypeError("invalid iv size (must be 16 bytes)");Nc(this,kc,new Uint8Array(e),"f")}else Nc(this,kc,new Uint8Array(16),"f");Nc(this,Cc,this.iv,"f")}get iv(){return new Uint8Array(Tc(this,kc,"f"))}encrypt(t){if(t.length%16)throw new TypeError("invalid plaintext size (must be multiple of 16 bytes)");const e=new Uint8Array(t.length);for(let n=0;n<t.length;n+=16){for(let e=0;e<16;e++)Tc(this,Cc,"f")[e]^=t[n+e];Nc(this,Cc,this.aes.encrypt(Tc(this,Cc,"f")),"f"),e.set(Tc(this,Cc,"f"),n)}return e}decrypt(t){if(t.length%16)throw new TypeError("invalid ciphertext size (must be multiple of 16 bytes)");const e=new Uint8Array(t.length);for(let n=0;n<t.length;n+=16){const r=this.aes.decrypt(t.subarray(n,n+16));for(let i=0;i<16;i++)e[n+i]=r[i]^Tc(this,Cc,"f")[i],Tc(this,Cc,"f")[i]=t[n+i]}return e}}kc=new WeakMap,Cc=new WeakMap;new WeakMap,new WeakMap,new WeakSet;var xc,Sc,Rc,_c=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Pc=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Bc extends Ac{constructor(t,e){super("CTR",t,Bc),xc.set(this,void 0),Sc.set(this,void 0),Rc.set(this,void 0),_c(this,Rc,new Uint8Array(16),"f"),Pc(this,Rc,"f").fill(0),_c(this,xc,Pc(this,Rc,"f"),"f"),_c(this,Sc,16,"f"),null==e&&(e=1),"number"==typeof e?this.setCounterValue(e):this.setCounterBytes(e)}get counter(){return new Uint8Array(Pc(this,Rc,"f"))}setCounterValue(t){if(!Number.isInteger(t)||t<0||t>Number.MAX_SAFE_INTEGER)throw new TypeError("invalid counter initial integer value");for(let e=15;e>=0;--e)Pc(this,Rc,"f")[e]=t%256,t=Math.floor(t/256)}setCounterBytes(t){if(16!==t.length)throw new TypeError("invalid counter initial Uint8Array value length");Pc(this,Rc,"f").set(t)}increment(){for(let t=15;t>=0;t--){if(255!==Pc(this,Rc,"f")[t]){Pc(this,Rc,"f")[t]++;break}Pc(this,Rc,"f")[t]=0}}encrypt(t){var e,n;const r=new Uint8Array(t);for(let t=0;t<r.length;t++)16===Pc(this,Sc,"f")&&(_c(this,xc,this.aes.encrypt(Pc(this,Rc,"f")),"f"),_c(this,Sc,0,"f"),this.increment()),r[t]^=Pc(this,xc,"f")[(_c(this,Sc,(n=Pc(this,Sc,"f"),e=n++,n),"f"),e)];return r}decrypt(t){return this.encrypt(t)}}xc=new WeakMap,Sc=new WeakMap,Rc=new WeakMap,new WeakMap,new WeakMap,new WeakMap;const Uc=(t,e)=>t<<e|t>>>32-e;function Lc(t,e,n,r,i,s){let o=t[e++]^n[r++],a=t[e++]^n[r++],c=t[e++]^n[r++],l=t[e++]^n[r++],h=t[e++]^n[r++],u=t[e++]^n[r++],d=t[e++]^n[r++],f=t[e++]^n[r++],p=t[e++]^n[r++],g=t[e++]^n[r++],m=t[e++]^n[r++],y=t[e++]^n[r++],w=t[e++]^n[r++],b=t[e++]^n[r++],v=t[e++]^n[r++],E=t[e++]^n[r++],I=o,A=a,k=c,C=l,N=h,T=u,O=d,x=f,S=p,R=g,_=m,P=y,B=w,U=b,L=v,M=E;for(let t=0;t<8;t+=2)N^=Uc(I+B|0,7),S^=Uc(N+I|0,9),B^=Uc(S+N|0,13),I^=Uc(B+S|0,18),R^=Uc(T+A|0,7),U^=Uc(R+T|0,9),A^=Uc(U+R|0,13),T^=Uc(A+U|0,18),L^=Uc(_+O|0,7),k^=Uc(L+_|0,9),O^=Uc(k+L|0,13),_^=Uc(O+k|0,18),C^=Uc(M+P|0,7),x^=Uc(C+M|0,9),P^=Uc(x+C|0,13),M^=Uc(P+x|0,18),A^=Uc(I+C|0,7),k^=Uc(A+I|0,9),C^=Uc(k+A|0,13),I^=Uc(C+k|0,18),O^=Uc(T+N|0,7),x^=Uc(O+T|0,9),N^=Uc(x+O|0,13),T^=Uc(N+x|0,18),P^=Uc(_+R|0,7),S^=Uc(P+_|0,9),R^=Uc(S+P|0,13),_^=Uc(R+S|0,18),B^=Uc(M+L|0,7),U^=Uc(B+M|0,9),L^=Uc(U+B|0,13),M^=Uc(L+U|0,18);i[s++]=o+I|0,i[s++]=a+A|0,i[s++]=c+k|0,i[s++]=l+C|0,i[s++]=h+N|0,i[s++]=u+T|0,i[s++]=d+O|0,i[s++]=f+x|0,i[s++]=p+S|0,i[s++]=g+R|0,i[s++]=m+_|0,i[s++]=y+P|0,i[s++]=w+B|0,i[s++]=b+U|0,i[s++]=v+L|0,i[s++]=E+M|0}function Mc(t,e,n,r,i){let s=r+0,o=r+16*i;for(let r=0;r<16;r++)n[o+r]=t[e+16*(2*i-1)+r];for(let r=0;r<i;r++,s+=16,e+=16)Lc(n,o,t,e,n,s),r>0&&(o+=16),Lc(n,s,t,e+=16,n,o)}function Fc(t,e,n){const r=Et({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:i,r:s,p:o,dkLen:a,asyncTick:c,maxmem:l,onProgress:h}=r;if(Z(i),Z(s),Z(o),Z(a),Z(c),Z(l),void 0!==h&&"function"!=typeof h)throw new Error("progressCb should be function");const u=128*s,d=u/4;if(i<=1||i&i-1||i>=2**(u/8)||i>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, less than 2^(128 * r / 8) and less than 2^32");if(o<0||o>137438953440/u)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(a<0||a>137438953440)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");const f=u*(i+o);if(f>l)throw new Error(`Scrypt: parameters too large, ${f} (128 * r * (N + p)) > ${l} (maxmem)`);const p=po(Ui,t,e,{c:1,dkLen:u*o}),g=ft(p),m=ft(new Uint8Array(u*i)),y=ft(new Uint8Array(u));let w=()=>{};if(h){const t=2*i*o,e=Math.max(Math.floor(t/1e4),1);let n=0;w=()=>{n++,!h||n%e&&n!==t||h(n/t)}}return{N:i,r:s,p:o,dkLen:a,blockSize32:d,V:m,B32:g,B:p,tmp:y,blockMixCb:w,asyncTick:c}}function Dc(t,e,n,r,i){const s=po(Ui,t,n,{c:1,dkLen:e});return n.fill(0),r.fill(0),i.fill(0),s}let Gc=!1,$c=!1;const Vc=async function(t,e,n,r,i,s,o){return await async function(t,e,n){const{N:r,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:l,B:h,tmp:u,blockMixCb:d,asyncTick:f}=Fc(t,e,n);for(let t=0;t<s;t++){const e=a*t;for(let t=0;t<a;t++)c[t]=l[e+t];let n=0;await yt(r-1,f,()=>{Mc(c,n,c,n+=a,i),d()}),Mc(c,(r-1)*a,l,e,i),d(),await yt(r,f,()=>{const t=l[e+a-16]%r;for(let n=0;n<a;n++)u[n]=l[e+n]^c[t*a+n];Mc(u,0,l,e,i),d()})}return Dc(t,o,h,c,u)}(t,e,{N:n,r,p:i,dkLen:s,onProgress:o})},qc=function(t,e,n,r,i,s){return function(t,e,n){const{N:r,r:i,p:s,dkLen:o,blockSize32:a,V:c,B32:l,B:h,tmp:u,blockMixCb:d}=Fc(t,e,n);for(let t=0;t<s;t++){const e=a*t;for(let t=0;t<a;t++)c[t]=l[e+t];for(let t=0,e=0;t<r-1;t++)Mc(c,e,c,e+=a,i),d();Mc(c,(r-1)*a,l,e,i),d();for(let t=0;t<r;t++){const t=l[e+a-16]%r;for(let n=0;n<a;n++)u[n]=l[e+n]^c[t*a+n];Mc(u,0,l,e,i),d()}}return Dc(t,o,h,c,u)}(t,e,{N:n,r,p:i,dkLen:s})};let jc=Vc,Wc=qc;async function Hc(t,e,n,r,i,s,o){const a=Gt(t,"passwd"),c=Gt(e,"salt");return Wt(await jc(a,c,n,r,i,s,o))}function Kc(t,e,n,r,i,s){const o=Gt(t,"passwd"),a=Gt(e,"salt");return Wt(Wc(o,a,n,r,i,s))}function zc(t){const e=Gt(t,"randomBytes");e[6]=15&e[6]|64,e[8]=63&e[8]|128;const n=Wt(e);return[n.substring(2,10),n.substring(10,14),n.substring(14,18),n.substring(18,22),n.substring(22,34)].join("-")}function Jc(t){return"string"!=typeof t||t.startsWith("0x")||(t="0x"+t),$t(t)}function Yc(t,e){for(t=String(t);t.length<e;)t="0"+t;return t}function Zc(t){return"string"==typeof t?re(t,"NFKC"):$t(t)}function Xc(t,e){const n=e.match(/^([a-z0-9$_.-]*)(:([a-z]+))?(!)?$/i);$(null!=n,"invalid path","path",e);const r=n[1],i=n[3],s="!"===n[4];let o=t;for(const t of r.toLowerCase().split(".")){if(Array.isArray(o)){if(!t.match(/^[0-9]+$/))break;o=o[parseInt(t)]}else if("object"==typeof o){let e=null;for(const n in o)if(n.toLowerCase()===t){e=o[n];break}o=e}else o=null;if(null==o)break}if($(!s||null!=o,"missing required value","path",r),i&&null!=o){if("int"===i){if("string"==typeof o&&o.match(/^-?[0-9]+$/))return parseInt(o);if(Number.isSafeInteger(o))return o}if("number"===i&&"string"==typeof o&&o.match(/^-?[0-9.]*$/))return parseFloat(o);if("data"===i&&"string"==typeof o)return Jc(o);if("array"===i&&Array.isArray(o))return o;if(i===typeof o)return o;$(!1,`wrong type found for ${i} `,"path",r)}return o}Hc._=Vc,Hc.lock=function(){$c=!0},Hc.register=function(t){if($c)throw new Error("scrypt is locked");jc=t},Object.freeze(Hc),Kc._=qc,Kc.lock=function(){Gc=!0},Kc.register=function(t){if(Gc)throw new Error("scryptSync is locked");Wc=t},Object.freeze(Kc);const Qc="m/44'/60'/0'/0/0";function tl(t){try{const e=JSON.parse(t);if(3===(null!=e.version?parseInt(e.version):0))return!0}catch(t){}return!1}function el(t,e){const n=Gt(e),r=Xc(t,"crypto.ciphertext:data!");$(Wt(te(Ht([n.slice(16,32),r]))).substring(2)===Xc(t,"crypto.mac:string!").toLowerCase(),"incorrect password","password","[ REDACTED ]");const i=function(t,e,n){if("aes-128-ctr"===Xc(t,"crypto.cipher:string")){const r=Xc(t,"crypto.cipherparams.iv:data!");return Wt(new Bc(e,r).decrypt(n))}G(!1,"unsupported cipher","UNSUPPORTED_OPERATION",{operation:"decrypt"})}(t,n.slice(0,16),r),s=Mo(i);if(t.address){let e=t.address.toLowerCase();e.startsWith("0x")||(e="0x"+e),$(Me(e)===s,"keystore address/privateKey mismatch","address",t.address)}const o={address:s,privateKey:i};if("0.1"===Xc(t,"x-ethers.version:string")){const e=n.slice(32,64),r=Xc(t,"x-ethers.mnemonicCiphertext:data!"),i=Xc(t,"x-ethers.mnemonicCounter:data!"),s=new Bc(e,i);o.mnemonic={path:Xc(t,"x-ethers.path:string")||Qc,locale:Xc(t,"x-ethers.locale:string")||"en",entropy:Wt(Gt(s.decrypt(r)))}}return o}function nl(t){const e=Xc(t,"crypto.kdf:string");if(e&&"string"==typeof e){if("scrypt"===e.toLowerCase()){const n=Xc(t,"crypto.kdfparams.salt:data!"),r=Xc(t,"crypto.kdfparams.n:int!"),i=Xc(t,"crypto.kdfparams.r:int!"),s=Xc(t,"crypto.kdfparams.p:int!");$(r>0&&!(r&r-1),"invalid kdf.N","kdf.N",r),$(i>0&&s>0,"invalid kdf","kdf",e);const o=Xc(t,"crypto.kdfparams.dklen:int!");return $(32===o,"invalid kdf.dklen","kdf.dflen",o),{name:"scrypt",salt:n,N:r,r:i,p:s,dkLen:64}}if("pbkdf2"===e.toLowerCase()){const e=Xc(t,"crypto.kdfparams.salt:data!"),n=Xc(t,"crypto.kdfparams.prf:string!"),r=n.split("-").pop();$("sha256"===r||"sha512"===r,"invalid kdf.pdf","kdf.pdf",n);const i=Xc(t,"crypto.kdfparams.c:int!"),s=Xc(t,"crypto.kdfparams.dklen:int!");return $(32===s,"invalid kdf.dklen","kdf.dklen",s),{name:"pbkdf2",salt:e,count:i,dkLen:s,algorithm:r}}}$(!1,"unsupported key-derivation function","kdf",e)}function rl(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}function il(t){const e=null!=t.salt?Gt(t.salt,"options.salt"):_a(32);let n=1<<17,r=8,i=1;return t.scrypt&&(t.scrypt.N&&(n=t.scrypt.N),t.scrypt.r&&(r=t.scrypt.r),t.scrypt.p&&(i=t.scrypt.p)),$("number"==typeof n&&n>0&&Number.isSafeInteger(n)&&(BigInt(n)&BigInt(n-1))===BigInt(0),"invalid scrypt N parameter","options.N",n),$("number"==typeof r&&r>0&&Number.isSafeInteger(r),"invalid scrypt r parameter","options.r",r),$("number"==typeof i&&i>0&&Number.isSafeInteger(i),"invalid scrypt p parameter","options.p",i),{name:"scrypt",dkLen:32,salt:e,N:n,r,p:i}}function sl(t,e,n,r){const i=Gt(n.privateKey,"privateKey"),s=null!=r.iv?Gt(r.iv,"options.iv"):_a(16);$(16===s.length,"invalid options.iv length","options.iv",r.iv);const o=null!=r.uuid?Gt(r.uuid,"options.uuid"):_a(16);$(16===o.length,"invalid options.uuid length","options.uuid",r.iv);const a=t.slice(0,16),c=t.slice(16,32),l=Gt(new Bc(a,s).encrypt(i)),h=te(Ht([c,l])),u={address:n.address.substring(2).toLowerCase(),id:zc(o),version:3,Crypto:{cipher:"aes-128-ctr",cipherparams:{iv:Wt(s).substring(2)},ciphertext:Wt(l).substring(2),kdf:"scrypt",kdfparams:{salt:Wt(e.salt).substring(2),n:e.N,dklen:32,p:e.p,r:e.r},mac:h.substring(2)}};if(n.mnemonic){const e=null!=r.client?r.client:`ethers/${_}`,i=n.mnemonic.path||Qc,s=n.mnemonic.locale||"en",o=t.slice(32,64),a=Gt(n.mnemonic.entropy,"account.mnemonic.entropy"),c=_a(16),l=Gt(new Bc(o,c).encrypt(a)),h=new Date,d="UTC--"+h.getUTCFullYear()+"-"+Yc(h.getUTCMonth()+1,2)+"-"+Yc(h.getUTCDate(),2)+"T"+Yc(h.getUTCHours(),2)+"-"+Yc(h.getUTCMinutes(),2)+"-"+Yc(h.getUTCSeconds(),2)+".0Z--"+u.address;u["x-ethers"]={client:e,gethFilename:d,path:i,locale:s,mnemonicCounter:Wt(c).substring(2),mnemonicCiphertext:Wt(l).substring(2),version:"0.1"}}return JSON.stringify(u)}function ol(t,e,n){null==n&&(n={});const r=Zc(e),i=il(n);return sl(Gt(Kc(r,i.salt,i.N,i.r,i.p,64)),i,t,n)}async function al(t,e,n){null==n&&(n={});const r=Zc(e),i=il(n);return sl(Gt(await Hc(r,i.salt,i.N,i.r,i.p,64,n.progressCallback)),i,t,n)}const cl="m/44'/60'/0'/0/0",ll=new Uint8Array([66,105,116,99,111,105,110,32,115,101,101,100]),hl=2147483648,ul=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");function dl(t,e){let n="";for(;t;)n="0123456789abcdef"[t%16]+n,t=Math.trunc(t/16);for(;n.length<2*e;)n="0"+n;return"0x"+n}function fl(t){const e=Gt(t);return function(t){const e=Gt(t);let n=pe(e),r="";for(;n;)r=Pa[Number(n%Ma)]+r,n/=Ma;for(let t=0;t<e.length&&!e[t];t++)r=Pa[0]+r;return r}(Ht([e,zt(So(So(e)),0,4)]))}const pl={};function gl(t,e,n,r){const i=new Uint8Array(37);t&hl?(G(null!=r,"cannot derive child of neutered node","UNSUPPORTED_OPERATION",{operation:"deriveChild"}),i.set(Gt(r),1)):i.set(Gt(n));for(let e=24;e>=0;e-=8)i[33+(e>>3)]=t>>24-e&255;const s=Gt(ha("sha512",e,i));return{IL:s.slice(0,32),IR:s.slice(32)}}function ml(t,e){const n=e.split("/");$(n.length>0,"invalid path","path",e),"m"===n[0]&&($(0===t.depth,`cannot derive root path (i.e. path starting with "m/") for a node at non-zero depth ${t.depth}`,"path",e),n.shift());let r=t;for(let t=0;t<n.length;t++){const e=n[t];if(e.match(/^[0-9]+'$/)){const n=parseInt(e.substring(0,e.length-1));$(n<hl,"invalid path index",`path[${t}]`,e),r=r.deriveChild(hl+n)}else if(e.match(/^[0-9]+$/)){const n=parseInt(e);$(n<hl,"invalid path index",`path[${t}]`,e),r=r.deriveChild(n)}else $(!1,"invalid path component",`path[${t}]`,e)}return r}class yl extends oa{publicKey;fingerprint;parentFingerprint;mnemonic;chainCode;path;index;depth;constructor(t,e,n,r,i,s,o,a,c){super(e,c),W(t,pl,"HDNodeWallet"),U(this,{publicKey:e.compressedPublicKey}),U(this,{parentFingerprint:n,fingerprint:zt(Oa(So(this.publicKey)),0,4),chainCode:r,path:i,index:s,depth:o}),U(this,{mnemonic:a})}connect(t){return new yl(pl,this.signingKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.mnemonic,t)}#rt(){const t={address:this.address,privateKey:this.privateKey},e=this.mnemonic;return this.path&&e&&"en"===e.wordlist.locale&&""===e.password&&(t.mnemonic={path:this.path,locale:"en",entropy:e.entropy}),t}async encrypt(t,e){return await al(this.#rt(),t,{progressCallback:e})}encryptSync(t){return ol(this.#rt(),t)}get extendedKey(){return G(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),fl(Ht(["0x0488ADE4",dl(this.depth,1),this.parentFingerprint,dl(this.index,4),this.chainCode,Ht(["0x00",this.privateKey])]))}hasPath(){return null!=this.path}neuter(){return new wl(pl,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,this.provider)}deriveChild(t){const e=ge(t,"index");$(e<=4294967295,"invalid index","index",e);let n=this.path;n&&(n+="/"+(2147483647&e),e&hl&&(n+="'"));const{IR:r,IL:i}=gl(e,this.chainCode,this.publicKey,this.privateKey),s=new Hs(me((pe(i)+BigInt(this.privateKey))%ul,32));return new yl(pl,s,this.fingerprint,Wt(r),n,e,this.depth+1,this.mnemonic,this.provider)}derivePath(t){return ml(this,t)}static#it(t,e){$(qt(t),"invalid seed","seed","[REDACTED]");const n=Gt(t,"seed");$(n.length>=16&&n.length<=64,"invalid seed","seed","[REDACTED]");const r=Gt(ha("sha512",ll,n)),i=new Hs(Wt(r.slice(0,32)));return new yl(pl,i,"0x00000000",Wt(r.slice(32)),"m",0,0,e,null)}static fromExtendedKey(t){const e=ye(function(t){let e=La;for(let n=0;n<t.length;n++)e*=Ma,e+=Ua(t[n]);return e}(t));$(82===e.length||fl(e.slice(0,78))===t,"invalid extended key","extendedKey","[ REDACTED ]");const n=e[4],r=Wt(e.slice(5,9)),i=parseInt(Wt(e.slice(9,13)).substring(2),16),s=Wt(e.slice(13,45)),o=e.slice(45,78);switch(Wt(e.slice(0,4))){case"0x0488b21e":case"0x043587cf":{const t=Wt(o);return new wl(pl,Mo(t),t,r,s,null,i,n,null)}case"0x0488ade4":case"0x04358394 ":if(0!==o[0])break;return new yl(pl,new Hs(o.slice(1)),r,s,null,i,n,null,null)}$(!1,"invalid extended key prefix","extendedKey","[ REDACTED ]")}static createRandom(t,e,n){null==t&&(t=""),null==e&&(e=cl),null==n&&(n=qa.wordlist());const r=Qa.fromEntropy(_a(16),t,n);return yl.#it(r.computeSeed(),r).derivePath(e)}static fromMnemonic(t,e){return e||(e=cl),yl.#it(t.computeSeed(),t).derivePath(e)}static fromPhrase(t,e,n,r){null==e&&(e=""),null==n&&(n=cl),null==r&&(r=qa.wordlist());const i=Qa.fromPhrase(t,e,r);return yl.#it(i.computeSeed(),i).derivePath(n)}static fromSeed(t){return yl.#it(t,null)}}class wl extends sa{publicKey;fingerprint;parentFingerprint;chainCode;path;index;depth;constructor(t,e,n,r,i,s,o,a,c){super(e,c),W(t,pl,"HDNodeVoidWallet"),U(this,{publicKey:n}),U(this,{publicKey:n,fingerprint:zt(Oa(So(n)),0,4),parentFingerprint:r,chainCode:i,path:s,index:o,depth:a})}connect(t){return new wl(pl,this.address,this.publicKey,this.parentFingerprint,this.chainCode,this.path,this.index,this.depth,t)}get extendedKey(){return G(this.depth<256,"Depth too deep","UNSUPPORTED_OPERATION",{operation:"extendedKey"}),fl(Ht(["0x0488B21E",dl(this.depth,1),this.parentFingerprint,dl(this.index,4),this.chainCode,this.publicKey]))}hasPath(){return null!=this.path}deriveChild(t){const e=ge(t,"index");$(e<=4294967295,"invalid index","index",e);let n=this.path;n&&(n+="/"+(2147483647&e),e&hl&&(n+="'"));const{IR:r,IL:i}=gl(e,this.chainCode,this.publicKey,null),s=Hs.addPoints(i,this.publicKey,!0),o=Mo(s);return new wl(pl,o,s,this.fingerprint,Wt(r),n,e,this.depth+1,this.provider)}derivePath(t){return ml(this,t)}}function bl(t){try{if(JSON.parse(t).encseed)return!0}catch(t){}return!1}function vl(t,e){const n=JSON.parse(t),r=Zc(e),i=Me(Xc(n,"ethaddr:string!")),s=Jc(Xc(n,"encseed:string!"));$(s&&s.length%16==0,"invalid encseed","json",t);const o=Gt(Ka(r,r,2e3,32,"sha256")).slice(0,16),a=s.slice(0,16),c=s.slice(16),l=function(t){if(t.length<16)throw new TypeError("PKCS#7 invalid length");const e=t[t.length-1];if(e>16)throw new TypeError("PKCS#7 padding byte out of range");const n=t.length-e;for(let r=0;r<e;r++)if(t[n+r]!==e)throw new TypeError("PKCS#7 invalid padding byte");return new Uint8Array(t.subarray(0,n))}(Gt(new Oc(o,a).decrypt(c)));let h="";for(let t=0;t<l.length;t++)h+=String.fromCharCode(l[t]);return{address:i,privateKey:se(h)}}function El(t){return new Promise(e=>{setTimeout(()=>{e()},t)})}class Il extends oa{constructor(t,e){"string"!=typeof t||t.startsWith("0x")||(t="0x"+t),super("string"==typeof t?new Hs(t):t,e)}connect(t){return new Il(this.signingKey,t)}async encrypt(t,e){const n={address:this.address,privateKey:this.privateKey};return await al(n,t,{progressCallback:e})}encryptSync(t){return ol({address:this.address,privateKey:this.privateKey},t)}static#st(t){if($(t,"invalid JSON wallet","json","[ REDACTED ]"),"mnemonic"in t&&t.mnemonic&&"en"===t.mnemonic.locale){const e=Qa.fromEntropy(t.mnemonic.entropy),n=yl.fromMnemonic(e,t.mnemonic.path);if(n.address===t.address&&n.privateKey===t.privateKey)return n;console.log("WARNING: JSON mismatch address/privateKey != mnemonic; fallback onto private key")}const e=new Il(t.privateKey);return $(e.address===t.address,"address/privateKey mismatch","json","[ REDACTED ]"),e}static async fromEncryptedJson(t,e,n){let r=null;return tl(t)?r=await async function(t,e,n){const r=JSON.parse(t),i=Zc(e),s=nl(r);if("pbkdf2"===s.name){n&&(n(0),await rl(0));const{salt:t,count:e,dkLen:o,algorithm:a}=s,c=Ka(i,t,e,o,a);return n&&(n(1),await rl(0)),el(r,c)}G("scrypt"===s.name,"cannot be reached","UNKNOWN_ERROR",{params:s});const{salt:o,N:a,r:c,p:l,dkLen:h}=s;return el(r,await Hc(i,o,a,c,l,h,n))}(t,e,n):bl(t)&&(n&&(n(0),await El(0)),r=vl(t,e),n&&(n(1),await El(0))),Il.#st(r)}static fromEncryptedJsonSync(t,e){let n=null;return tl(t)?n=function(t,e){const n=JSON.parse(t),r=Zc(e),i=nl(n);if("pbkdf2"===i.name){const{salt:t,count:e,dkLen:s,algorithm:o}=i;return el(n,Ka(r,t,e,s,o))}G("scrypt"===i.name,"cannot be reached","UNKNOWN_ERROR",{params:i});const{salt:s,N:o,r:a,p:c,dkLen:l}=i;return el(n,Kc(r,s,o,a,c,l))}(t,e):bl(t)?n=vl(t,e):$(!1,"invalid JSON wallet","json","[ REDACTED ]"),Il.#st(n)}static createRandom(t){const e=yl.createRandom();return t?e.connect(t):e}static fromPhrase(t,e){const n=yl.fromPhrase(t);return e?n.connect(e):n}}var Al=n(39907);const kl=t=>pi(t,!0),Cl=t=>pi(JSON.stringify(t),!0),Nl=t=>{if(null!=t)return gi(t)},Tl=t=>{if(null!=t)return JSON.parse(gi(t))},Ol=t=>"string"==typeof t?s.utils.arrayify(s.utils.keccak256(s.utils.toUtf8Bytes(t))):s.utils.arrayify(s.utils.keccak256(t)),xl=(t,e,n)=>s.utils.solidityPack(["string","uint256","address","bytes32"],["",e,t,n]),Sl=(t,e,n)=>s.utils.keccak256(xl(t,e,n)),Rl=()=>"undefined"==typeof window&&"object"==typeof Al,_l=()=>!Rl(),Pl=t=>{const e=t.split(".");if(3!==e.length)throw new Error("invalid jwt");return JSON.parse(gi(e[1]))};function Bl(){return Bl=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bl.apply(this,arguments)}var Ul;!function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.DISABLED=5]="DISABLED"}(Ul||(Ul={}));class Ll{constructor(t){this.config=t,this.logLevel=void 0,this.configure(t)}configure(t){switch(this.config=Bl({},this.config,t),this.config.logLevel){case"DEBUG":this.logLevel=Ul.DEBUG;break;case"INFO":default:this.logLevel=Ul.INFO;break;case"WARN":this.logLevel=Ul.WARN;break;case"ERROR":this.logLevel=Ul.ERROR;break;case"DISABLED":this.logLevel=Ul.DISABLED}void 0===this.config.silence&&(this.config.silence=!1)}debug(t,...e){!0!==this.config.silence&&this.logLevel===Ul.DEBUG&&console.log(t,...e)}info(t,...e){!0!==this.config.silence&&this.logLevel<=Ul.INFO&&console.log(t,...e)}warn(t,...e){!0!==this.config.silence&&this.logLevel<=Ul.WARN&&(console.warn(t,...e),this.config.onwarn&&this.config.onwarn(t,e))}error(t,...e){!0!==this.config.silence&&this.logLevel<=Ul.ERROR&&(console.error(t,...e),this.config.onerror&&this.config.onerror(t,e))}}const Ml=new Ll({logLevel:"INFO",silence:!0}),Fl=t=>Ml.configure(t);function Dl(t,e){return function(...n){const r=Array.prototype.slice.call(n);return new Promise(async(n,i)=>{try{r.push((t,e)=>t?i(t):n(e)),await t.apply(e,r)}catch(t){i(t)}})}}const Gl=(t=0,e=Number.MAX_SAFE_INTEGER)=>(t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t);function $l(t,e){return`${encodeURIComponent(t)}=${encodeURIComponent(JSON.stringify(e))}`}function Vl(t){const e=t.split("&"),n={};for(const t of e){const e=t.split("=");n[decodeURIComponent(e[0])]=JSON.parse(decodeURIComponent(e[1]))}return n}const ql=t=>{if(!t||"string"!=typeof t)return"";const e=t.match(/[\d.]+/);return e&&e.length>0?e[0].trim():""},jl=t=>{if(!t||"string"!=typeof t)return"";const e=t.match(/[\w\s\d]+/);return e&&e.length>0?e[0].trim():""},Wl=t=>{if(!t||"string"!=typeof t)return"";const e=t.match(/[\w\d.\-:\/]+/);return e&&e.length>0?e[0].trim():""},Hl=t=>new Promise(e=>{const n=setTimeout(()=>{clearTimeout(n),e()},t)}),Kl=t=>{const e=Bl({},t.types);return delete e.EIP712Domain,s.utils._TypedDataEncoder.hash(t.domain,e,t.message)},zl=t=>s.utils.arrayify(Kl(t)),{defineReadOnly:Jl,getStatic:Yl,resolveProperties:Zl,checkProperties:Xl,shallowCopy:Ql,deepCopy:th}=o.utils,eh=t=>t.replace(/([^:]\/)\/+/g,"$1");function nh(t){return null!=t&&(o.BigNumber.isBigNumber(t)||"number"==typeof t&&t%1==0||"string"==typeof t&&!!t.match(/^-?[0-9]+$/)||o.utils.isHexString(t)||"bigint"==typeof t||o.utils.isBytes(t))}function rh(){return rh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rh.apply(this,arguments)}const ih=t=>((t,e=!1)=>(((t,e=!1,n=!1)=>{if(!t)throw new Error("invalid network config: empty config");const r=[];if(Array.isArray(t)?r.push(...t):r.push(t),0===r.length){if(e)throw new Error("invalid network config: empty config");return!1}const i=r.map(t=>t.chainId).sort(),s=i.filter((t,e)=>i.indexOf(t)!==e);if(s.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}r.forEach(t=>t.name=t.name.toLowerCase());const o=r.map(t=>t.name).sort(),a=o.filter((t,e)=>o.indexOf(t)!==e);if(a.length>0){if(e)throw new Error(`invalid network config: duplicate network names ${a}`);return!1}let c=!1,l=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&e)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(e)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l&&e)throw new Error("invalid network config: AuthChain must be set")})(t,!0,e),t))(sh(t)),sh=t=>{if(!t)return[];const e=t.sort((t,e)=>t.chainId===e.chainId?0:t.chainId<e.chainId?-1:1),n=e.findIndex(t=>t.isDefaultChain);n>0&&e.splice(0,0,e.splice(n,1)[0]);const r=e.findIndex(t=>t.isAuthChain&&!0!==t.isDefaultChain);return r>0&&e.splice(1,0,e.splice(r,1)[0]),e},oh=(t,e)=>"string"==typeof t?(e=e||{},t.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,function(t,n){let r=e[n];return r="function"==typeof r?r():null==r?"":"object"==typeof r||"symbol"==typeof r?r.toString():r.valueOf(),r})):"";let ah;!function(t){t[t.MAINNET=1]="MAINNET",t[t.ROPSTEN=3]="ROPSTEN",t[t.RINKEBY=4]="RINKEBY",t[t.GOERLI=5]="GOERLI",t[t.KOVAN=42]="KOVAN",t[t.POLYGON=137]="POLYGON",t[t.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",t[t.POLYGON_ZKEVM=1101]="POLYGON_ZKEVM",t[t.BSC=56]="BSC",t[t.BSC_TESTNET=97]="BSC_TESTNET",t[t.OPTIMISM=10]="OPTIMISM",t[t.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",t[t.ARBITRUM=42161]="ARBITRUM",t[t.ARBITRUM_GOERLI=421613]="ARBITRUM_GOERLI",t[t.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",t[t.AVALANCHE=43114]="AVALANCHE",t[t.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",t[t.FANTOM=250]="FANTOM",t[t.FANTOM_TESTNET=4002]="FANTOM_TESTNET",t[t.GNOSIS=100]="GNOSIS",t[t.AURORA=1313161554]="AURORA",t[t.AURORA_TESTNET=1313161556]="AURORA_TESTNET",t[t.BASE_GOERLI=84531]="BASE_GOERLI"}(ah||(ah={}));const ch=t=>oh("https://${network}-indexer.sequence.app",{network:t}),lh=t=>oh("https://${network}-relayer.sequence.app",{network:t}),hh=t=>oh("https://nodes.sequence.app/${network}",{network:t}),uh={[ah.MAINNET]:{chainId:ah.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ah.ROPSTEN]:{chainId:ah.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ah.RINKEBY]:{chainId:ah.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",disabled:!0},[ah.GOERLI]:{chainId:ah.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ah.KOVAN]:{chainId:ah.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[ah.POLYGON]:{chainId:ah.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[ah.POLYGON_MUMBAI]:{chainId:ah.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[ah.POLYGON_ZKEVM]:{chainId:ah.POLYGON_ZKEVM,name:"polygon-zkevm",title:"Polygon zkEVM",blockExplorer:{name:"Polygonscan (zkEVM)",rootUrl:"https://zkevm.polygonscan.com/"}},[ah.BSC]:{chainId:ah.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[ah.BSC_TESTNET]:{chainId:ah.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[ah.OPTIMISM]:{chainId:ah.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[ah.OPTIMISM_TESTNET]:{chainId:ah.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[ah.ARBITRUM]:{chainId:ah.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[ah.ARBITRUM_GOERLI]:{chainId:ah.ARBITRUM_GOERLI,name:"arbitrum-goerli",title:"Arbitrum Goerli",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[ah.ARBITRUM_NOVA]:{chainId:ah.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[ah.AVALANCHE]:{chainId:ah.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[ah.AVALANCHE_TESTNET]:{chainId:ah.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[ah.FANTOM]:{chainId:ah.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[ah.FANTOM_TESTNET]:{chainId:ah.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[ah.GNOSIS]:{chainId:ah.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[ah.AURORA]:{chainId:ah.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[ah.AURORA_TESTNET]:{chainId:ah.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}},[ah.BASE_GOERLI]:{chainId:ah.BASE_GOERLI,name:"base-goerli",title:"Base Goerli",blockExplorer:{name:"Base Goerli Explorer",rootUrl:"https://goerli.basescan.org/"}}},dh=(ih([rh({},uh[ah.MAINNET],{rpcUrl:hh("mainnet"),relayer:{url:lh("mainnet")},indexerUrl:ch("mainnet")}),rh({},uh[ah.POLYGON],{rpcUrl:hh("polygon"),relayer:{url:lh("polygon")},indexerUrl:ch("polygon"),isDefaultChain:!0,isAuthChain:!0}),rh({},uh[ah.BSC],{rpcUrl:hh("bsc"),indexerUrl:ch("bsc"),relayer:{url:lh("bsc")}}),rh({},uh[ah.AVALANCHE],{rpcUrl:hh("avalanche"),indexerUrl:ch("avalanche"),relayer:{url:lh("avalanche")}}),rh({},uh[ah.ARBITRUM],{rpcUrl:hh("arbitrum"),indexerUrl:ch("arbitrum"),relayer:{url:lh("arbitrum")}}),rh({},uh[ah.ARBITRUM_NOVA],{rpcUrl:hh("arbitrum-nova"),indexerUrl:ch("arbitrum-nova"),relayer:{url:lh("arbitrum-nova")}}),rh({},uh[ah.OPTIMISM],{rpcUrl:hh("optimism"),indexerUrl:ch("optimism"),relayer:{url:lh("optimism")}}),rh({},uh[ah.POLYGON_ZKEVM],{rpcUrl:hh("polygon-zkevm"),indexerUrl:ch("polygon-zkevm"),relayer:{url:lh("polygon-zkevm")}}),rh({},uh[ah.GNOSIS],{rpcUrl:hh("gnosis"),indexerUrl:ch("gnosis"),relayer:{url:lh("gnosis")}})]),ih([rh({},uh[ah.RINKEBY],{rpcUrl:hh("rinkeby"),relayer:{url:lh("rinkeby")},indexerUrl:ch("rinkeby")}),rh({},uh[ah.GOERLI],{rpcUrl:hh("goerli"),relayer:{url:lh("goerli")},indexerUrl:ch("goerli")}),rh({},uh[ah.POLYGON_MUMBAI],{rpcUrl:hh("mumbai"),relayer:{url:lh("mumbai")},indexerUrl:ch("mumbai"),isDefaultChain:!0,isAuthChain:!0}),rh({},uh[ah.BSC_TESTNET],{rpcUrl:hh("bsc-testnet"),relayer:{url:lh("bsc-testnet")},indexerUrl:ch("bsc-testnet")}),rh({},uh[ah.ARBITRUM_GOERLI],{rpcUrl:hh("arbitrum-goerli"),relayer:{url:lh("arbitrum-goerli")},indexerUrl:ch("arbitrum-goerli")}),rh({},uh[ah.BASE_GOERLI],{rpcUrl:hh("base-goerli"),relayer:{url:lh("base-goerli")},indexerUrl:ch("base-goerli")})]),"2.0");function fh(){return fh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fh.apply(this,arguments)}let ph;function gh(t,e){return t.reduce(function(t,n,r){return e(n,r)?t[0].push(n):t[1].push(n),t},[[],[]])}s.providers.JsonRpcProvider,function(t){t.ethCall="eth_call",t.ethGetBalance="eth_getBalance",t.ethGetCode="eth_getCode"}(ph||(ph={}));class mh{constructor(t){var e=this;if(this.batchableJsonRpcMethods=[ph.ethCall,ph.ethGetCode,ph.ethGetBalance],this.multicallInterface=new s.utils.Interface(b.sequenceUtils.abi),this.options=void 0,this.timeout=void 0,this.queue=[],this.scheduleExecution=()=>{this.queue.length>0&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.run,this.options.timeWindow))},this.handle=(t,e,n)=>this.batchableJsonRpcMethods.find(t=>t===e.method)?(this.queue.push({request:e,callback:n,next:t}),this.options.verbose&&console.log("Scheduling call",e.method),void this.scheduleExecution()):(this.options.verbose&&console.log("Forwarded call",e.method),t(e,n)),this.run=async function(){e.options.verbose&&console.log("Processing multicall");const t=Math.min(e.options.batchSize,e.queue.length);if(0===t)return;if(1===t)return e.forward(e.queue[0]),e.queue=[],void(e.options.verbose&&console.log("Skip multicall, single item"));e.options.verbose&&console.log("Resolving",t);var n=e.queue.slice(0,t);e.queue=t===e.queue.length?[]:e.queue.slice(t),e.options.verbose&&console.log("Updated queue",e.queue.length),0!==e.queue.length&&e.scheduleExecution();const r=n[0].next;let i;var[n,a]=gh(n,t=>{try{if(t.next!==r)return!1;switch(t.request.method){case ph.ethCall:if(t.request.params[0].from||t.request.params[0].gasPrice||t.request.params[0].value)return!1;case ph.ethGetBalance:case ph.ethGetCode:const e=function(t){if(void 0===t)return"latest";switch(t){case"earliest":case"latest":case"pending":return t}return o.BigNumber.from(t)}(t.request.params[1]);if(void 0===i&&(i=e),!function(t,e){return t===e||(o.BigNumber.isBigNumber(t)?!!o.BigNumber.isBigNumber(e)&&t.eq(e):!o.BigNumber.isBigNumber(e)&&t===e)}(e,i))return!1}return!0}catch(t){return!1}});if(0!==a.length&&(e.options.verbose&&console.log("Forwarding incompatible calls",a.length),e.forward(a),0===n.length))return;let c=n.map(t=>{try{switch(t.request.method){case ph.ethCall:return{delegateCall:!1,revertOnError:!1,target:t.request.params[0].to,data:t.request.params[0].data,gasLimit:t.request.params[0].gas?t.request.params[0].gas:0,value:0};case ph.ethGetCode:return{delegateCall:!1,revertOnError:!1,target:e.options.contract,gasLimit:0,value:0,data:e.multicallInterface.encodeFunctionData(e.multicallInterface.getFunction("callCode"),[t.request.params[0]])};case ph.ethGetBalance:return{delegateCall:!1,revertOnError:!1,target:e.options.contract,gasLimit:0,value:0,data:e.multicallInterface.encodeFunctionData(e.multicallInterface.getFunction("callBalanceOf"),[t.request.params[0]])};default:return null}}catch(t){return null}});var[n,a]=gh(n,(t,e)=>void 0!==c[e]);if(c=c.filter(t=>t),0!==a.length&&(e.options.verbose&&console.log("Forwarding calls on error",a.length),e.forward(a),0===n.length))return;let l;try{l=e.multicallInterface.encodeFunctionData(e.multicallInterface.getFunction("multiCall"),[c])}catch(t){return void e.forward(n)}const h=Gl(),u=await async function(t,e){try{return await t}catch(t){return e instanceof Function?e(t):e}}(Dl(r)({id:h,jsonrpc:dh,method:ph.ethCall,params:[{to:e.options.contract,value:0,data:l},o.BigNumber.isBigNumber(i)?i.toNumber():i]}),t=>({jsonrpc:dh,id:h,result:void 0,error:t}));if(u.error)return e.forward(n);let d;try{d=e.multicallInterface.decodeFunctionResult(e.multicallInterface.getFunction("multiCall"),u.result)}catch(t){return void e.forward(n)}e.options.verbose&&console.log("Got response for",n.length),n.forEach((t,n)=>{if(d[0][n])switch(t.request.method){case ph.ethCall:t.callback(void 0,{jsonrpc:t.request.jsonrpc,id:t.request.id,result:d[1][n]});break;case ph.ethGetCode:t.callback(void 0,{jsonrpc:t.request.jsonrpc,id:t.request.id,result:s.utils.defaultAbiCoder.decode(["bytes"],d[1][n])[0]});break;case ph.ethGetBalance:t.callback(void 0,{jsonrpc:t.request.jsonrpc,id:t.request.id,result:s.utils.defaultAbiCoder.decode(["uint256"],d[1][n])[0]})}else e.forward(t)})},this.options=t?fh({},mh.DefaultOptions,t):mh.DefaultOptions,this.options.batchSize<=0)throw new Error(`Invalid batch size of ${this.options.batchSize}`)}forward(t){Array.isArray(t)?t.forEach(t=>t.next(t.request,t.callback)):t.next(t.request,t.callback)}static isMulticall(t){return t&&void 0!==t.handle&&void 0!==t.conf&&mh.isMulticallOptions(t.options)}static isMulticallOptions(t){return void 0!==t&&void 0!==t.batchSize&&void 0!==t.timeWindow&&void 0!==t.contract}}mh.DefaultOptions=fh({},{batchSize:50,timeWindow:50,contract:"0xd130B43062D875a4B7aF3f8fc036Bc6e9D3E1B3E",verbose:!1});const yh=["getNetwork","getBlockNumber","getGasPrice","getTransactionCount","getStorageAt","sendTransaction","estimateGas","getBlock","getTransaction","getTransactionReceipt","getLogs","emit","litenerCount","addListener","removeListener","waitForTransaction","detectNetwork","getBlockWithTransactions"];class wh extends s.providers.BaseProvider{constructor(t,e){var n;super(t.getNetwork()),n=this,this.provider=t,this.multicall=void 0,this.listenerCount=this.provider.listenerCount,this.getResolver=async function(t){const e=n.provider;if(e.getResolver){const r=await e.getResolver(await t);return r?new s.providers.Resolver(n,r.address,r.name):null}return e.getResolver(await t)},this.next=async function(t,e){try{switch(t.method){case ph.ethCall:n.callback(t,e,await n.provider.call(t.params[0],t.params[1]));break;case ph.ethGetCode:n.callback(t,e,await n.provider.getCode(t.params[0],t.params[1]));break;case ph.ethGetBalance:n.callback(t,e,await n.provider.getBalance(t.params[0],t.params[1]))}}catch(r){n.callback(t,e,void 0,r)}},this.multicall=mh.isMulticall(e)?e:new mh(e),yh.forEach(e=>{void 0!==t[e]&&(this[e]=(...n)=>t[e](...n))})}callback(t,e,n,r){e(r,{jsonrpc:dh,id:t.id,result:n,error:r})}async call(t,e){return this.rpcCall(ph.ethCall,t,e)}async getCode(t,e){return this.rpcCall(ph.ethGetCode,t,e)}async getBalance(t,e){return this.rpcCall(ph.ethGetBalance,t,e)}async rpcCall(t,...e){const n=Gl();return(await Dl(this.multicall.handle)(this.next,{jsonrpc:dh,id:n,method:t,params:e})).result}}var bh=Object.freeze({__proto__:null,ProxyMethods:yh,MulticallProvider:wh,MulticallExternalProvider:class{constructor(t,e){if(this.provider=t,this.multicall=void 0,this.multicall=mh.isMulticall(e)?e:new mh(e),t.send){const e=async function(e,n){t.send(e,n)};this.send=(t,n)=>{this.multicall.handle(e,t,n)}}if(t.sendAsync){const e=async function(e,n){t.sendAsync(e,n)};this.sendAsync=(t,n)=>{this.multicall.handle(e,t,n)}}}get isMetaMask(){return this.provider.isMetaMask}get isStatus(){return this.provider.isStatus}},multicallMiddleware:t=>e=>{const n=mh.isMulticall(t)?t:new mh(t);return(t,r)=>n.handle(e,t,r)}});const vh="0x603a600e3d39601a805130553df3363d3d373d3d3d363d30545af43d82803e903d91601857fd5bf3",Eh="@sequence.config.imageHashes",Ih=t=>`@sequence.config.${t}`;let Ah;try{Ah=localStorage}catch(t){const e=new Map;Ah={getItem:t=>{var n;return null!=(n=e.get(t))?n:null},setItem:(t,n)=>e.set(t,n),removeItem:t=>e.delete(t)}}function kh(t){var e;const n=JSON.parse(null!=(e=Ah.getItem(Ih(t)))?e:"null");return n?(Ch(t),n):void 0}function Ch(t){var e;let n=JSON.parse(null!=(e=Ah.getItem(Eh))?e:"[]");for(n=n.filter(e=>e!==t),n.push(t);n.length>10;)Ah.removeItem(Ih(n.shift()));Ah.setItem(Eh,JSON.stringify(n))}const Nh=async(t,e)=>{const n={threshold:t,signers:[]};if(e.forEach(async t=>{n.signers.push({weight:t.weight,address:o.Signer.isSigner(t.signer)?await t.signer.getAddress():t.signer})}),!Th(n))throw new Error("wallet config is not usable");return n},Th=t=>t.signers.reduce((t,e)=>s.BigNumber.from(e.weight).add(t),s.constants.Zero).gte(s.BigNumber.from(t.threshold)),Oh=(t,e)=>{if(0===e.length)return!0;const n=t.signers.map(t=>s.utils.getAddress(t.address)),r=e.map(t=>s.utils.getAddress(t));let i=!0;return r.forEach(t=>{n.includes(t)||(i=!1)}),i},xh=(t,e,n=!1)=>{if("string"==typeof t){const n=s.utils.keccak256(s.utils.solidityPack(["bytes","bytes32"],[vh,s.utils.hexZeroPad(e.mainModule,32)])),r=s.utils.keccak256(s.utils.solidityPack(["bytes1","address","bytes32","bytes32"],["0xff",e.factory,t,n]));return s.utils.getAddress(s.utils.hexDataSlice(r,12))}return t.address&&!n?t.address:xh(Sh(t),e)},Sh=t=>{const e=(t=Rh(t)).signers.reduce((t,e)=>s.utils.keccak256(s.utils.defaultAbiCoder.encode(["bytes32","uint8","address"],[t,e.weight,e.address])),s.utils.solidityPack(["uint256"],[t.threshold]));return function(t,e){Ah.setItem(Ih(t),JSON.stringify(e)),Ch(t)}(e,t),e},Rh=t=>{t.signers.sort((t,e)=>Ph(t.address,e.address)),t.signers.forEach(t=>t.address=s.utils.getAddress(t.address)),t.address&&(t.address=s.utils.getAddress(t.address));const e=t.signers.map(t=>t.address);if(e.filter((t,n)=>e.indexOf(t)!==n).length>0)throw new Error("invalid wallet config: duplicate signer addresses detected in the config, ${signerDupes}");return t},_h=(t,e)=>Sh(t)===Sh(e),Ph=(t,e)=>{const n=s.BigNumber.from(t),r=s.BigNumber.from(e);return n.lt(r)?-1:n.eq(r)?0:1};function Bh(t,e){const n=t=>({weight:s.BigNumber.from(t.weight).toNumber(),address:s.utils.getAddress(t.address)}),r=t.signers.map(n),i=e.set?e.set.map(n):[],o=e.del?e.del.map(t=>s.utils.getAddress(t.address)):[],a=i.map(t=>t.address),c=r.filter(t=>-1===o.indexOf(t.address)&&-1===a.indexOf(t.address)).concat(...i);return Rh({address:t.address,threshold:e.threshold?s.BigNumber.from(e.threshold).toNumber():t.threshold,signers:c})}function Uh(t,e){return Rh({threshold:s.BigNumber.from(t).toNumber(),signers:e.map(t=>({weight:s.BigNumber.from(t.weight).toNumber(),address:s.utils.getAddress(t.address)}))})}class Lh{constructor(){this.findCurrentConfig=void 0,this.findLastWalletOfInitialSigner=void 0}}function Mh(){return Mh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mh.apply(this,arguments)}class Fh{constructor(t){var e=this;this.authProvider=t,this.findCurrentConfig=async function(t){const{provider:n,context:r,ignoreIndex:i,requireIndex:o,skipCache:a}=t,c=s.utils.getAddress(t.address);if(Ml.info(`[findCurrentConfig] address:${c}, ignoreIndex:${i}, requireIndex:${o}`),o&&i)throw Error("findCurrentConfig: can't ignore index and require index");const l=n.getNetwork(),h=t.knownConfigs?t.knownConfigs:[],{imageHash:u,config:d}=await e.findCurrentImageHash(r,n,c,h,a);if(void 0===u)return{config:void 0};const f=await e.findConfigForImageHash(r,u,d?[d,...h]:h,a),p=(await l).chainId;return{config:f?Mh({},f,{chainId:p,address:c}):void 0}},this.findLastWalletOfInitialSigner=async function(t){const{signer:n,context:r,ignoreIndex:i,requireIndex:s}=t;if(Ml.info(`[findLastWalletOfInitialSigner] signer:${n}`),s&&i)throw Error("findCurrentConfig: can't ignore index and require index");const o=new Kr(r.sequenceUtils,b.sequenceUtils.abi,e.authProvider),a=i?0:(await o.lastSignerUpdate(n)).toNumber();if(s&&0===a)return{wallet:void 0};const c=o.filters.RequiredSigner(null,n),l=await e.findLatestLog(e.authProvider,Mh({},c,{fromBlock:a,toBlock:0!==a?a:"latest"}));return void 0===l?(Ml.warn("publishConfig: wallet config last log not found"),{wallet:void 0}):{wallet:o.interface.decodeEventLog("RequiredSigner",l.data,l.topics)._wallet}},this.findConfigForImageHash=async function(t,n,r=[],i=!1){const o=r.find(t=>Sh(t)===n);if(o)return o;if(!i){const t=kh(n);if(t)return t}Ml.info(`[findConfigForImageHash] image:${n}`);const a=new Kr(t.sequenceUtils,b.sequenceUtils.abi,e.authProvider),c=(await a.lastImageHashUpdate(n)).toNumber(),l=a.filters.RequiredConfig(void 0,n),h=await e.findLatestLog(e.authProvider,Mh({},l,{fromBlock:c,toBlock:0!==c?c:"latest"}));if(void 0===h)return;const u=a.interface.decodeEventLog("RequiredConfig",h.data,h.topics),d=s.utils.defaultAbiCoder.decode(["tuple(\n        uint256 weight,\n        address signer\n      )[]"],u._signers)[0],f={threshold:s.BigNumber.from(u._threshold).toNumber(),signers:d.map(t=>({address:t.signer,weight:s.BigNumber.from(t.weight).toNumber()}))};return Sh(f),f},this.findCurrentImageHash=async function(t,n,r,i=[],o){Ml.info(`[findCurrentImageHash] address:${r}`);const a=new Kr(r,b.mainModuleUpgradable.abi,n),c=await a.functions.imageHash.call([]).catch(()=>[]);if(void 0!==c[0])return{imageHash:c[0],config:o?void 0:kh(c[0])};const l=s.utils.getAddress(r),h=i.find(e=>xh(e,t,!0)===l);if(h)return{imageHash:Sh(h),config:h};const u=new Kr(t.sequenceUtils,b.sequenceUtils.abi,e.authProvider),d=await u.knownImageHashes(r);if(d!==s.constants.HashZero){if(xh(d,t)!==r)throw Error("findCurrentImageHash: inconsistent RequireUtils results");return{imageHash:d}}const f=u.filters.RequiredConfig(r),p=await e.findFirstLog(e.authProvider,f);if(void 0!==p){const e=u.interface.decodeEventLog("RequiredConfig",p.data,p.topics),n=s.utils.defaultAbiCoder.decode(["tuple(\n          uint256 weight,\n          address signer\n        )[]"],e._signers)[0],i={threshold:s.BigNumber.from(e._threshold).toNumber(),signers:n.map(t=>({address:t.signer,weight:s.BigNumber.from(t.weight).toNumber()}))},o=Sh(i);if(xh(o,t)===r)return{imageHash:o,config:i}}return{}},this.findLatestLog=async function(t,n){const r="latest"===n.toBlock?await t.getBlockNumber():n.toBlock,i=n.fromBlock;0===i&&Ml.warn(`findLatestLog: expensive getLogs query fromBlock 0 toBlock ${r}`);try{const e=await t.getLogs(Mh({},n,{toBlock:r}));return 0===e.length?void 0:e[e.length-1]}catch(s){const o=Math.floor((r-i)/2+i),a=await e.findLatestLog(t,Mh({},n,{fromBlock:o,toBlock:r}));return void 0!==a?a:e.findLatestLog(t,Mh({},n,{fromBlock:i,toBlock:o}))}},this.findFirstLog=async function(t,n){const r="latest"!==n.toBlock&&n.toBlock?n.toBlock:await t.getBlockNumber(),i=n.fromBlock?n.fromBlock:0;0===i&&Ml.warn(`findFirstLog: expensive getLogs query fromBlock 0 toBlock ${r}`);try{const e=await t.getLogs(Mh({},n,{fromBlock:i,toBlock:r}));return 0===e.length?void 0:e[0]}catch(s){const o=Math.floor((r-i)/2+i),a=await e.findFirstLog(t,Mh({},n,{fromBlock:i,toBlock:o}));return void 0!==a?a:e.findFirstLog(t,Mh({},n,{fromBlock:o,toBlock:r}))}}}}function Dh(t){return void 0!==t.address&&!Gh(t)}function Gh(t){return $h(t)||Vh(t)||qh(t)}function $h(t){const e=t;return void 0!==e.signature&&void 0===e.address}function Vh(t){const e=t;return void 0!==e.r&&void 0!==e.s&&void 0!==e.v&&void 0!==e.t}function qh(t){const e=t;return void 0!==e.address&&void 0!==e.signature}let jh;!function(t){t[t.EOA=0]="EOA",t[t.Address=1]="Address",t[t.Full=2]="Full"}(jh||(jh={}));const Wh=t=>{if("string"!=typeof t)return t;const e=t.replace("0x",""),n=s.BigNumber.from(`0x${e.slice(0,4)}`).toNumber(),r=[];for(let t=4;t<e.length;){const n=s.BigNumber.from(e.slice(t,t+2)).toNumber();t+=2;const i=s.BigNumber.from(`0x${e.slice(t,t+2)}`).toNumber();switch(t+=2,n){case jh.Address:const n=s.utils.getAddress(e.slice(t,t+40));t+=40,r.push({weight:i,address:n});break;case jh.EOA:const o=s.utils.arrayify(`0x${e.slice(t,t+132)}`);t+=132;const a=s.utils.splitSignature(o.slice(0,65)),c=a.r,l=a.s,h=a.v,u=s.BigNumber.from(o[o.length-1]).toNumber();r.push({weight:i,signature:o,r:c,s:l,v:h,t:u});break;case jh.Full:const d=s.utils.getAddress(e.slice(t,t+40));t+=40;const f=s.BigNumber.from(`0x${e.slice(t,t+4)}`).mul(2).toNumber();t+=4;const p=s.utils.arrayify(`0x${e.slice(t,t+f)}`);t+=f,r.push({weight:i,address:d,signature:p});break;default:throw Error("Signature type not supported")}}return{threshold:n,signers:r}},Hh=3,Kh=t=>{const e=s.utils.arrayify(t.signature);return Mh({},t,s.utils.splitSignature(e.slice(0,65)),{t:s.BigNumber.from(e[e.length-1]).toNumber()})},zh=(t,e)=>{const n=Vh(e)?e:Kh(e);switch(n.t){case 1:return s.utils.recoverAddress(t,{r:n.r,s:n.s,v:n.v});case 2:const e=s.utils.keccak256(s.utils.solidityPack(["string","bytes32"],["Ethereum Signed Message:\n32",t]));return s.utils.recoverAddress(e,{r:n.r,s:n.s,v:n.v});default:throw new Error("Unknown signature")}},Jh=(...t)=>t.map(t=>"string"==typeof t?Wh(t):t).reduce((t,e)=>Yh(t,e)),Yh=(t,e)=>({threshold:t.threshold,signers:t.signers.map((t,n)=>Dh(t)?e.signers[n]:t)}),Zh=t=>{if("string"==typeof t)return Zh(Wh(t));const e=t.signers.map(t=>{if(Dh(t))return s.utils.solidityPack(["uint8","uint8","address"],[jh.Address,t.weight,t.address]);if(Vh(t))return s.utils.solidityPack(["uint8","uint8","bytes32","bytes32","uint8","uint8"],[jh.EOA,t.weight,t.r,t.s,t.v,t.t]);if(qh(t)){const e=s.utils.arrayify(t.signature).length;return s.utils.solidityPack(["uint8","uint8","address","uint16","bytes"],[jh.Full,t.weight,t.address,e,t.signature])}if($h(t))return s.utils.solidityPack(["uint8","uint8","bytes"],[jh.EOA,t.weight,t.signature]);throw Error("Unkwnown signature part type")});return s.utils.solidityPack(["uint16",...Array(e.length).fill("bytes")],[t.threshold,...e])};function Xh(t,e){if(Dh(t))return t.address;if(qh(t))return t.address;if(Vh(t)||$h(t))return zh(e,t);throw Error("Unkwnown signature part type")}function Qh(t,e,n){const r=t.signers.map(t=>Xh(t,n));return{threshold:e.threshold,signers:e.signers.map(e=>{const n=r.indexOf(e.address);return-1!==n?Mh({},t.signers[n],{weight:e.weight}):{weight:e.weight,address:e.address}})}}async function tu(t,e){const n=new bh.MulticallProvider(t);let r=(await Promise.all(e.signers.map(async(t,e)=>Mh({},t,{index:e,isEOA:0===s.utils.arrayify(await n.getCode(t.address)).length})))).sort((t,e)=>t.weight-e.weight),i=0;r=r.map(t=>i>=e.threshold||t.isEOA?t:(i+=t.weight,Mh({},t,{willSign:!0}))),i<e.threshold&&(r=r.map(t=>t.willSign||i>=e.threshold?t:(i+=t.weight,Mh({},t,{willSign:!0}))));const o=s.utils.arrayify("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a01b02"),a=r.sort((t,e)=>t.index-e.index);return{threshold:e.threshold,signers:a.map(t=>t.willSign?t.isEOA?{weight:t.weight,signature:o}:{weight:t.weight,address:t.address,signature:Zh({threshold:1,signers:[{address:Il.createRandom().address,weight:1},{weight:1,signature:o}]})+s.utils.hexlify(Hh).substring(2)}:{address:t.address,weight:t.weight})}}function eu(){return eu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eu.apply(this,arguments)}const nu="v1",ru="v0.4.0",iu="3254a537c563d6b612b7ab5365c305664abb5951";let su,ou,au,cu,lu,hu,uu;!function(t){t.UNKNOWN="UNKNOWN",t.ERC20="ERC20",t.ERC721="ERC721",t.ERC1155="ERC1155",t.SEQUENCE_WALLET="SEQUENCE_WALLET",t.ERC20_BRIDGE="ERC20_BRIDGE",t.ERC721_BRIDGE="ERC721_BRIDGE",t.ERC1155_BRIDGE="ERC1155_BRIDGE"}(su||(su={})),function(t){t.UNKNOWN="UNKNOWN",t.BLOCK_ADDED="BLOCK_ADDED",t.BLOCK_REMOVED="BLOCK_REMOVED"}(ou||(ou={})),function(t){t.UNKNOWN="UNKNOWN",t.TOKEN_TRANSFER="TOKEN_TRANSFER",t.NATIVE_TOKEN_TRANSFER="NATIVE_TOKEN_TRANSFER",t.SEQUENCE_TXN="SEQUENCE_TXN"}(au||(au={})),function(t){t.UNKNOWN="UNKNOWN",t.SEND="SEND",t.RECEIVE="RECEIVE"}(cu||(cu={})),function(t){t.FAILED="FAILED",t.SUCCESSFUL="SUCCESSFUL"}(lu||(lu={})),function(t){t.LegacyTxnType="LegacyTxnType",t.AccessListTxnType="AccessListTxnType",t.DynamicFeeTxnType="DynamicFeeTxnType"}(hu||(hu={})),function(t){t.DESC="DESC",t.ASC="ASC"}(uu||(uu={}));class du{constructor(t,e){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Indexer/",this.ping=t=>this.fetch(this.url("Ping"),fu({},t)).then(t=>pu(t).then(t=>({status:t.status}))),this.version=t=>this.fetch(this.url("Version"),fu({},t)).then(t=>pu(t).then(t=>({version:t.version}))),this.runtimeStatus=t=>this.fetch(this.url("RuntimeStatus"),fu({},t)).then(t=>pu(t).then(t=>({status:t.status}))),this.getChainID=t=>this.fetch(this.url("GetChainID"),fu({},t)).then(t=>pu(t).then(t=>({chainID:t.chainID}))),this.getEtherBalance=(t,e)=>this.fetch(this.url("GetEtherBalance"),fu(t,e)).then(t=>pu(t).then(t=>({balance:t.balance}))),this.getTokenBalances=(t,e)=>this.fetch(this.url("GetTokenBalances"),fu(t,e)).then(t=>pu(t).then(t=>({page:t.page,balances:t.balances}))),this.getTokenSupplies=(t,e)=>this.fetch(this.url("GetTokenSupplies"),fu(t,e)).then(t=>pu(t).then(t=>({page:t.page,contractType:t.contractType,tokenIDs:t.tokenIDs}))),this.getTokenSuppliesMap=(t,e)=>this.fetch(this.url("GetTokenSuppliesMap"),fu(t,e)).then(t=>pu(t).then(t=>({supplies:t.supplies}))),this.getBalanceUpdates=(t,e)=>this.fetch(this.url("GetBalanceUpdates"),fu(t,e)).then(t=>pu(t).then(t=>({page:t.page,balances:t.balances}))),this.getTransactionHistory=(t,e)=>this.fetch(this.url("GetTransactionHistory"),fu(t,e)).then(t=>pu(t).then(t=>({page:t.page,transactions:t.transactions}))),this.syncBalance=(t,e)=>this.fetch(this.url("SyncBalance"),fu(t,e)).then(t=>pu(t).then(t=>({}))),this.fetchTransactionReceipt=(t,e)=>this.fetch(this.url("FetchTransactionReceipt"),fu(t,e)).then(t=>pu(t).then(t=>({receipt:t.receipt}))),this.fetchTransactionReceiptWithFilter=(t,e)=>this.fetch(this.url("FetchTransactionReceiptWithFilter"),fu(t,e)).then(t=>pu(t).then(t=>({receipt:t.receipt}))),this.hostname=t,this.fetch=(t,n)=>e(t,n)}url(t){return this.hostname+this.path+t}}const fu=(t={},e={})=>({method:"POST",headers:eu({},e,{"Content-Type":"application/json"}),body:JSON.stringify(t||{})}),pu=t=>t.text().then(e=>{let n;try{n=JSON.parse(e)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${e}`,status:t.status}}if(!t.ok)throw n;return n});let gu;!function(t){t.MAINNET="https://mainnet-indexer.sequence.app",t.POLYGON="https://polygon-indexer.sequence.app",t.POLYGON_MUMBAI="https://mumbai-indexer.sequence.app",t.POLYGON_ZKEVM="https://polygon-zkevm-indexer.sequence.app",t.ARBITRUM="https://arbitrum-indexer.sequence.app",t.ARBITRUM_NOVA="https://arbitrum-nova-indexer.sequence.app",t.OPTIMISM="https://optimism-indexer.sequence.app",t.AVALANCHE="https://avalanche-indexer.sequence.app",t.GNOSIS="https://gnosis-indexer.sequence.app",t.BSC="https://bsc-indexer.sequence.app",t.BSC_TESTNET="https://bsc-testnet-indexer.sequence.app",t.GOERLI="https://goerli-indexer.sequence.app"}(gu||(gu={}));const mu="object"==typeof n.g?n.g.fetch:window.fetch;class yu extends du{constructor(t,e){super(t.endsWith("/")?t.slice(0,-1):t,mu),this.jwtAuth=e,this._fetch=(t,e)=>{const n={};return this.jwtAuth&&this.jwtAuth.length>0&&(n.Authorization=`BEARER ${this.jwtAuth}`),e.headers=eu({},e.headers,n),mu(t,e)},this.fetch=this._fetch}}function wu(){return wu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wu.apply(this,arguments)}const bu="v1",vu="v0.4.0",Eu="5d87d77b951c5d197544d97d75241bf3d02679d9";let Iu,Au,ku,Cu;!function(t){t.UNKNOWN="UNKNOWN",t.ERC20="ERC20",t.ERC721="ERC721",t.ERC1155="ERC1155"}(Iu||(Iu={})),function(t){t.INT="INT",t.STRING="STRING",t.ARRAY="ARRAY",t.GENERIC="GENERIC"}(Au||(Au={})),function(t){t.UNKNOWN="UNKNOWN",t.BUY="BUY",t.SELL="SELL"}(ku||(ku={})),function(t){t.DESC="DESC",t.ASC="ASC"}(Cu||(Cu={}));class Nu{constructor(t,e){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Metadata/",this.ping=t=>this.fetch(this.url("Ping"),Tu({},t)).then(t=>Ou(t).then(t=>({status:t.status}))),this.version=t=>this.fetch(this.url("Version"),Tu({},t)).then(t=>Ou(t).then(t=>({version:t.version}))),this.runtimeStatus=t=>this.fetch(this.url("RuntimeStatus"),Tu({},t)).then(t=>Ou(t).then(t=>({status:t.status}))),this.getTokenMetadata=(t,e)=>this.fetch(this.url("GetTokenMetadata"),Tu(t,e)).then(t=>Ou(t).then(t=>({tokenMetadata:t.tokenMetadata}))),this.refreshTokenMetadata=(t,e)=>this.fetch(this.url("RefreshTokenMetadata"),Tu(t,e)).then(t=>Ou(t).then(t=>({status:t.status}))),this.getTokenMetadataBatch=(t,e)=>this.fetch(this.url("GetTokenMetadataBatch"),Tu(t,e)).then(t=>Ou(t).then(t=>({contractTokenMetadata:t.contractTokenMetadata}))),this.searchTokenMetadata=(t,e)=>this.fetch(this.url("SearchTokenMetadata"),Tu(t,e)).then(t=>Ou(t).then(t=>({page:t.page,tokenMetadata:t.tokenMetadata}))),this.searchTokenIDs=(t,e)=>this.fetch(this.url("SearchTokenIDs"),Tu(t,e)).then(t=>Ou(t).then(t=>({page:t.page,tokenIds:t.tokenIds}))),this.tokenCollectionFilters=(t,e)=>this.fetch(this.url("TokenCollectionFilters"),Tu(t,e)).then(t=>Ou(t).then(t=>({filters:t.filters}))),this.getContractInfo=(t,e)=>this.fetch(this.url("GetContractInfo"),Tu(t,e)).then(t=>Ou(t).then(t=>({contractInfo:t.contractInfo}))),this.getContractInfoBatch=(t,e)=>this.fetch(this.url("GetContractInfoBatch"),Tu(t,e)).then(t=>Ou(t).then(t=>({contractInfoMap:t.contractInfoMap}))),this.searchContractInfo=(t,e)=>this.fetch(this.url("SearchContractInfo"),Tu(t,e)).then(t=>Ou(t).then(t=>({contractInfoList:t.contractInfoList}))),this.searchContractInfoBatch=(t,e)=>this.fetch(this.url("SearchContractInfoBatch"),Tu(t,e)).then(t=>Ou(t).then(t=>({contractInfoByChain:t.contractInfoByChain}))),this.searchMetadata=(t,e)=>this.fetch(this.url("SearchMetadata"),Tu(t,e)).then(t=>Ou(t).then(t=>({tokenMetadata:t.tokenMetadata,contractInfo:t.contractInfo}))),this.getNiftyswapTokenQuantity=(t,e)=>this.fetch(this.url("GetNiftyswapTokenQuantity"),Tu(t,e)).then(t=>Ou(t).then(t=>({quantity:t.quantity}))),this.getNiftyswapUnitPrices=(t,e)=>this.fetch(this.url("GetNiftyswapUnitPrices"),Tu(t,e)).then(t=>Ou(t).then(t=>({prices:t.prices}))),this.getNiftyswapUnitPricesWithQuantities=(t,e)=>this.fetch(this.url("GetNiftyswapUnitPricesWithQuantities"),Tu(t,e)).then(t=>Ou(t).then(t=>({prices:t.prices}))),this.hostname=t,this.fetch=(t,n)=>e(t,n)}url(t){return this.hostname+this.path+t}}const Tu=(t={},e={})=>({method:"POST",headers:wu({},e,{"Content-Type":"application/json"}),body:JSON.stringify(t||{})}),Ou=t=>t.text().then(e=>{let n;try{n=JSON.parse(e)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${e}`,status:t.status}}if(!t.ok)throw n;return n}),xu="object"==typeof n.g?n.g.fetch:window.fetch;class Su extends Nu{constructor(t="https://metadata.sequence.app"){super(t.endsWith("/")?t.slice(0,-1):t,xu)}}function Ru(){return Ru=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ru.apply(this,arguments)}const _u=t=>((t,e=!1)=>(((t,e=!1,n=!1)=>{if(!t)throw new Error("invalid network config: empty config");const r=[];if(Array.isArray(t)?r.push(...t):r.push(t),0===r.length){if(e)throw new Error("invalid network config: empty config");return!1}const i=r.map(t=>t.chainId).sort(),s=i.filter((t,e)=>i.indexOf(t)!==e);if(s.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}r.forEach(t=>t.name=t.name.toLowerCase());const o=r.map(t=>t.name).sort(),a=o.filter((t,e)=>o.indexOf(t)!==e);if(a.length>0){if(e)throw new Error(`invalid network config: duplicate network names ${a}`);return!1}let c=!1,l=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&e)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(e)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l&&e)throw new Error("invalid network config: AuthChain must be set")})(t,!0,e),t))(Pu(t)),Pu=t=>{if(!t)return[];const e=t.sort((t,e)=>t.chainId===e.chainId?0:t.chainId<e.chainId?-1:1),n=e.findIndex(t=>t.isDefaultChain);n>0&&e.splice(0,0,e.splice(n,1)[0]);const r=e.findIndex(t=>t.isAuthChain&&!0!==t.isDefaultChain);return r>0&&e.splice(1,0,e.splice(r,1)[0]),e},Bu=(t,e)=>"string"==typeof t?(e=e||{},t.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,function(t,n){let r=e[n];return r="function"==typeof r?r():null==r?"":"object"==typeof r||"symbol"==typeof r?r.toString():r.valueOf(),r})):"";let Uu;!function(t){t[t.MAINNET=1]="MAINNET",t[t.ROPSTEN=3]="ROPSTEN",t[t.RINKEBY=4]="RINKEBY",t[t.GOERLI=5]="GOERLI",t[t.KOVAN=42]="KOVAN",t[t.POLYGON=137]="POLYGON",t[t.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",t[t.POLYGON_ZKEVM=1101]="POLYGON_ZKEVM",t[t.BSC=56]="BSC",t[t.BSC_TESTNET=97]="BSC_TESTNET",t[t.OPTIMISM=10]="OPTIMISM",t[t.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",t[t.ARBITRUM=42161]="ARBITRUM",t[t.ARBITRUM_GOERLI=421613]="ARBITRUM_GOERLI",t[t.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",t[t.AVALANCHE=43114]="AVALANCHE",t[t.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",t[t.FANTOM=250]="FANTOM",t[t.FANTOM_TESTNET=4002]="FANTOM_TESTNET",t[t.GNOSIS=100]="GNOSIS",t[t.AURORA=1313161554]="AURORA",t[t.AURORA_TESTNET=1313161556]="AURORA_TESTNET",t[t.BASE_GOERLI=84531]="BASE_GOERLI"}(Uu||(Uu={}));const Lu=t=>Bu("https://${network}-indexer.sequence.app",{network:t}),Mu=t=>Bu("https://${network}-relayer.sequence.app",{network:t}),Fu=t=>Bu("https://nodes.sequence.app/${network}",{network:t}),Du={[Uu.MAINNET]:{chainId:Uu.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[Uu.ROPSTEN]:{chainId:Uu.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[Uu.RINKEBY]:{chainId:Uu.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",disabled:!0},[Uu.GOERLI]:{chainId:Uu.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[Uu.KOVAN]:{chainId:Uu.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[Uu.POLYGON]:{chainId:Uu.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[Uu.POLYGON_MUMBAI]:{chainId:Uu.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[Uu.POLYGON_ZKEVM]:{chainId:Uu.POLYGON_ZKEVM,name:"polygon-zkevm",title:"Polygon zkEVM",blockExplorer:{name:"Polygonscan (zkEVM)",rootUrl:"https://zkevm.polygonscan.com/"}},[Uu.BSC]:{chainId:Uu.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[Uu.BSC_TESTNET]:{chainId:Uu.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[Uu.OPTIMISM]:{chainId:Uu.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[Uu.OPTIMISM_TESTNET]:{chainId:Uu.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[Uu.ARBITRUM]:{chainId:Uu.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[Uu.ARBITRUM_GOERLI]:{chainId:Uu.ARBITRUM_GOERLI,name:"arbitrum-goerli",title:"Arbitrum Goerli",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[Uu.ARBITRUM_NOVA]:{chainId:Uu.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[Uu.AVALANCHE]:{chainId:Uu.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[Uu.AVALANCHE_TESTNET]:{chainId:Uu.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[Uu.FANTOM]:{chainId:Uu.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[Uu.FANTOM_TESTNET]:{chainId:Uu.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[Uu.GNOSIS]:{chainId:Uu.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[Uu.AURORA]:{chainId:Uu.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[Uu.AURORA_TESTNET]:{chainId:Uu.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}},[Uu.BASE_GOERLI]:{chainId:Uu.BASE_GOERLI,name:"base-goerli",title:"Base Goerli",blockExplorer:{name:"Base Goerli Explorer",rootUrl:"https://goerli.basescan.org/"}}},Gu=(_u([Ru({},Du[Uu.MAINNET],{rpcUrl:Fu("mainnet"),relayer:{url:Mu("mainnet")},indexerUrl:Lu("mainnet")}),Ru({},Du[Uu.POLYGON],{rpcUrl:Fu("polygon"),relayer:{url:Mu("polygon")},indexerUrl:Lu("polygon"),isDefaultChain:!0,isAuthChain:!0}),Ru({},Du[Uu.BSC],{rpcUrl:Fu("bsc"),indexerUrl:Lu("bsc"),relayer:{url:Mu("bsc")}}),Ru({},Du[Uu.AVALANCHE],{rpcUrl:Fu("avalanche"),indexerUrl:Lu("avalanche"),relayer:{url:Mu("avalanche")}}),Ru({},Du[Uu.ARBITRUM],{rpcUrl:Fu("arbitrum"),indexerUrl:Lu("arbitrum"),relayer:{url:Mu("arbitrum")}}),Ru({},Du[Uu.ARBITRUM_NOVA],{rpcUrl:Fu("arbitrum-nova"),indexerUrl:Lu("arbitrum-nova"),relayer:{url:Mu("arbitrum-nova")}}),Ru({},Du[Uu.OPTIMISM],{rpcUrl:Fu("optimism"),indexerUrl:Lu("optimism"),relayer:{url:Mu("optimism")}}),Ru({},Du[Uu.POLYGON_ZKEVM],{rpcUrl:Fu("polygon-zkevm"),indexerUrl:Lu("polygon-zkevm"),relayer:{url:Mu("polygon-zkevm")}}),Ru({},Du[Uu.GNOSIS],{rpcUrl:Fu("gnosis"),indexerUrl:Lu("gnosis"),relayer:{url:Mu("gnosis")}})]),_u([Ru({},Du[Uu.RINKEBY],{rpcUrl:Fu("rinkeby"),relayer:{url:Mu("rinkeby")},indexerUrl:Lu("rinkeby")}),Ru({},Du[Uu.GOERLI],{rpcUrl:Fu("goerli"),relayer:{url:Mu("goerli")},indexerUrl:Lu("goerli")}),Ru({},Du[Uu.POLYGON_MUMBAI],{rpcUrl:Fu("mumbai"),relayer:{url:Mu("mumbai")},indexerUrl:Lu("mumbai"),isDefaultChain:!0,isAuthChain:!0}),Ru({},Du[Uu.BSC_TESTNET],{rpcUrl:Fu("bsc-testnet"),relayer:{url:Mu("bsc-testnet")},indexerUrl:Lu("bsc-testnet")}),Ru({},Du[Uu.ARBITRUM_GOERLI],{rpcUrl:Fu("arbitrum-goerli"),relayer:{url:Mu("arbitrum-goerli")},indexerUrl:Lu("arbitrum-goerli")}),Ru({},Du[Uu.BASE_GOERLI],{rpcUrl:Fu("base-goerli"),relayer:{url:Mu("base-goerli")},indexerUrl:Lu("base-goerli")})]),{factory:"0xf9D09D634Fb818b05149329C1dcCFAeA53639d96",mainModule:"0xd01F11855bCcb95f88D7A48492F66410d4637313",mainModuleUpgradable:"0x7EFE6cE415956c5f80C6530cC6cc81b4808F6118",guestModule:"0x02390F3E6E5FD1C6786CB78FD3027C117a9955A7",sequenceUtils:"0xd130B43062D875a4B7aF3f8fc036Bc6e9D3E1B3E",libs:{requireFreshSigner:"0xE6B9B21C077F382333220a072e4c44280b873907"}});class $u{constructor(t,e){this.sender=void 0,this.handler=void 0,this.sender=e,t&&this.setMiddleware(t)}setMiddleware(t){this.handler=Vu(t,this.sender.sendAsync)}sendAsync(t,e,n){try{this.handler(t,e,n)}catch(t){e(t,void 0)}}}const Vu=(t,e)=>{if(0===t.length)return e;const n=t=>t.sendAsyncMiddleware?t.sendAsyncMiddleware:t;let r;r=n(t[t.length-1])(e);for(let e=t.length-2;e>=0;e--)r=n(t[e])(r);return r};let qu=0;class ju{constructor(t,e){var n;this.send=void 0,this.request=void 0,this.defaultChainId=void 0,this.sendAsync=(t,e,n)=>{this.send(t.method,t.params,n||this.defaultChainId).then(n=>{e(void 0,{jsonrpc:"2.0",id:t.id,result:n})}).catch(t=>{e(t,void 0)})},this.defaultChainId=e,void 0!==(n=t)&&void 0!==n.send&&void 0!==n.constructor.defaultUrl&&void 0!==n.detectNetwork&&void 0!==n.getSigner&&void 0!==n.perform?this.send=t.send.bind(t):function(t){return void 0!==t&&void 0!==t.sendAsync}(t)?this.send=(e,n,r)=>new Promise((i,s)=>{t.sendAsync({jsonrpc:"2.0",id:++qu,method:e,params:n},(t,e)=>{t?s(t):i(e?e.result:void 0)},r||this.defaultChainId)}):this.send=t,this.request=(t,e)=>this.send(t.method,t.params,e)}}class Wu{constructor(t){this.cachableJsonRpcMethods=["net_version","eth_chainId","eth_accounts","sequence_getWalletContext","sequence_getNetworks"],this.cachableJsonRpcMethodsByBlock=["eth_call","eth_getCode"],this.cache=void 0,this.cacheByBlock=void 0,this.cacheByBlockResetLock=!1,this.onUpdateCallback=void 0,this.defaultChainId=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method)){const t=this.cacheKey(e.method,e.params,r||this.defaultChainId),i=this.getCacheValue(t);if(i&&""!==i)return void n(void 0,{jsonrpc:"2.0",id:e.id,result:i})}t(e,(t,r,i)=>{if((this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method))&&r&&r.result&&this.shouldCacheResponse(e,r)){const t=this.cacheKey(e.method,e.params,i||this.defaultChainId);this.cachableJsonRpcMethods.includes(e.method)?this.setCacheValue(t,r.result):this.setCacheByBlockValue(t,r.result)}n(t,r)},r||this.defaultChainId)},this.cacheKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.getCache=()=>this.cache,this.setCache=t=>{this.cache=t,this.onUpdateCallback&&this.onUpdateCallback()},this.getCacheValue=t=>this.cache[t]?this.cache[t]:this.cacheByBlock[t]?this.cacheByBlock[t]:void 0,this.setCacheValue=(t,e)=>{this.cache[t]=e,this.onUpdateCallback&&this.onUpdateCallback(t,e)},this.setCacheByBlockValue=(t,e)=>{this.cacheByBlock[t]=e,this.cacheByBlockResetLock||(this.cacheByBlockResetLock=!0,setTimeout(()=>{this.cacheByBlockResetLock=!1,this.cacheByBlock={}},1500))},this.shouldCacheResponse=(t,e)=>!(!e||!e.result||"eth_getCode"===t.method&&e.result.length<=2),this.clearCache=()=>{this.cache={},this.cacheByBlock={}},this.cache={},this.cacheByBlock={},this.defaultChainId=null==t?void 0:t.defaultChainId,null!=t&&t.blockCache?!0!==(null==t?void 0:t.blockCache)&&(this.cachableJsonRpcMethodsByBlock=null==t?void 0:t.blockCache):this.cachableJsonRpcMethodsByBlock=[]}onUpdate(t){this.onUpdateCallback=t}}class Hu{constructor(t){this.options=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{const{id:i,method:o}=e;switch(o){case"net_version":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:`${this.options.chainId}`});break;case"eth_chainId":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:s.utils.hexlify(this.options.chainId)});break;case"eth_accounts":if(this.options.accountAddress)return void n(void 0,{jsonrpc:"2.0",id:i,result:[s.utils.getAddress(this.options.accountAddress)]});break;case"sequence_getWalletContext":if(this.options.walletContext)return void n(void 0,{jsonrpc:"2.0",id:i,result:this.options.walletContext})}t(e,n,r)},this.options=t}}class Ku{constructor(){this.singleflightJsonRpcMethods=["eth_chainId","net_version","eth_call","eth_getCode","eth_blockNumber","eth_getBalance","eth_getStorageAt","eth_getTransactionCount","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getBlockByHash","eth_getBlockByNumber","eth_getTransactionByHash","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getLogs"],this.inflight=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(!this.singleflightJsonRpcMethods.includes(e.method))return void t(e,n,r);const i=this.requestKey(e.method,e.params||[],r);this.inflight[i]?this.inflight[i].push({id:e.id,callback:n}):(this.inflight[i]=[],t(e,(t,e,r)=>{n(t,e);for(let n=0;n<this.inflight[i].length;n++){const r=this.inflight[i][n];t?r.callback(t,e):e&&r.callback(void 0,{jsonrpc:"2.0",id:r.id,result:e.result})}delete this.inflight[i]},r))},this.requestKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.inflight={}}}class zu extends s.providers.JsonRpcProvider{constructor(t,e){super(t,null==e?void 0:e.chainId),this._chainId=void 0,this._sender=void 0,this.send=(t,e)=>this._sender.send(t,e),this.fetch=(t,e)=>{const n={method:t,params:e,id:this._nextId++,jsonrpc:"2.0"};return s.utils.fetchJson(this.connection,JSON.stringify(n),Ju).then(t=>t,t=>{throw t})};const n=null==e?void 0:e.chainId,r=null==e?void 0:e.middlewares,i=null==e?void 0:e.blockCache;this._chainId=n;const o=new $u(null!=r?r:[new Hu({chainId:n}),new Ku,new Wu({defaultChainId:n,blockCache:i})],new ju(this.fetch,n));this._sender=new ju(o,n)}async getNetwork(){const t=this._chainId;if(t){const e=Du[t];return{name:(null==e?void 0:e.name)||"",chainId:t,ensAddress:null==e?void 0:e.ensAddress}}{const t=await this.send("eth_chainId",[]);return this._chainId=s.BigNumber.from(t).toNumber(),this.getNetwork()}}}function Ju(t){if(t.error){const e=new Error(t.error.message);throw e.code=t.error.code,e.data=t.error.data,e}return t.result}function Yu(){return Yu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yu.apply(this,arguments)}const Zu="tuple(\n  bool delegateCall,\n  bool revertOnError,\n  uint256 gasLimit,\n  address target,\n  uint256 value,\n  bytes data\n)[]";function Xu(...t){const e=ld(...t);if(void 0===e)throw new Error("Encoding transactions without defined nonce");return Qu(e,...t)}function Qu(t,...e){return s.utils.defaultAbiCoder.encode(["uint256",Zu],[t,hd(e)])}function td(...t){const e=ld(...t);if(void 0===e)throw new Error("Computing hash for transactions without defined nonce");return ed(e,...t)}function ed(t,...e){return s.utils.keccak256(Qu(t,...e))}function nd(t,e,...n){return Sl(t,e,td(...n)).replace(/^0x/,"")}async function rd(t,e,n=!1,r){const i=id(e),o=(await Promise.all(e.map(t=>t.nonce))).filter(t=>void 0!==t).map(t=>s.BigNumber.from(t)),a=0!==o.length?o.reduce((t,e)=>t.lt(e)?t:e):void 0;return Promise.all(i.map(e=>sd(t,e,n,r,a)))}function id(t){if(!Array.isArray(t)){if("auxiliary"in t){const e=t.auxiliary,n=Yu({},t);return delete n.auxiliary,e?[n,...id(e)]:[n]}return[t]}return t.flatMap(id)}async function sd(t,e,n=!1,r,i){if(ad(e))return e;const s=void 0===e.gasLimit?e.gas:e.gasLimit;if(e.to)return{delegateCall:!1,revertOnError:n,gasLimit:s?await s:r,to:await e.to,value:e.value?await e.value:0,data:await e.data,nonce:i||await e.nonce};{const a=new o.utils.Interface(b.mainModule.abi),c=a.encodeFunctionData(a.getFunction("createContract"),[e.data]),l="string"==typeof t?t:t.getAddress();return{delegateCall:!1,revertOnError:n,gasLimit:s?await s:r,to:await l,value:e.value?await e.value:0,data:c,nonce:i||await e.nonce}}}function od(t){return t.send||t.sendAsync}function ad(t){return void 0!==t.delegateCall||void 0!==t.revertOnError}function cd(t){return void 0!==t.find(t=>ad(t))}function ld(...t){const e=t.find(t=>void 0!==t.nonce);if(!e)return;const n=s.BigNumber.from(e.nonce);if(t.find(t=>void 0!==t.nonce&&!s.BigNumber.from(t.nonce).eq(n)))throw new Error("Mixed nonces on Sequence transactions");return e?e.nonce:void 0}function hd(t){return t.map(t=>{var e;return{delegateCall:!0===t.delegateCall,revertOnError:!0===t.revertOnError,gasLimit:void 0!==t.gasLimit?t.gasLimit:s.constants.Zero,target:null!=(e=t.to)?e:s.constants.AddressZero,value:void 0!==t.value?t.value:s.constants.Zero,data:void 0!==t.data?t.data:[]}})}function ud(t,e){return t.map(t=>Yu({},t,{nonce:e}))}function dd(t,e,n){const r=new o.utils.Interface(b.sequenceUtils.abi);if(!t||!t.sequenceUtils)throw new Error("Undefined sequenceUtils");return[{delegateCall:!1,revertOnError:!0,gasLimit:0,to:t.sequenceUtils,value:0,data:r.encodeFunctionData(r.getFunction("requireNonExpired"),[n])},...e]}function fd(t,e,n){const r=new o.utils.Interface(b.sequenceUtils.abi);if(!t||!t.sequenceUtils)throw new Error("Undefined sequenceUtils");return[{delegateCall:!1,revertOnError:!0,gasLimit:0,to:t.sequenceUtils,value:0,data:r.encodeFunctionData(r.getFunction("requireMinNonce"),[n.address,n.space?pd(n.space,n.nonce):n.nonce])},...e]}function pd(t,e){const n=s.BigNumber.from(t),r=s.BigNumber.from(e),i=s.constants.Two.pow(s.BigNumber.from(96));if(!r.div(i).eq(s.constants.Zero))throw new Error("Space already encoded");return r.add(n.mul(i))}function gd(t){const e=s.BigNumber.from(t),n=s.constants.Two.pow(s.BigNumber.from(96));return[e.div(n),e.mod(n)]}function md(t){return void 0!==t&&void 0!==t.chainId&&void 0!==t.config&&void 0!==t.context&&void 0!==t.signature&&void 0!==t.transactions&&Array.isArray(t.transactions)&&t.transactions.reduce((t,e)=>t&&ad(e),!0)}async function yd(t,e,n){let r=[];if(r=Array.isArray(n)?cd(n)?id(n):await rd(e,n):ad(n)?id([n]):await rd(e,[n]),n.expiration&&(r=dd(t,r,n.expiration)),n.afterNonce){const i=n.afterNonce;r=fd(t,r,i.address?{address:i.address,nonce:i.nonce,space:i.space}:{address:e,nonce:i})}return r}function wd(){return wd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wd.apply(this,arguments)}const bd=t=>"number"==typeof t?t:t.chainId?t.chainId:s.BigNumber.from(t).toNumber(),vd=(t,e=!1)=>(((t,e=!1,n=!1)=>{if(!t)throw new Error("invalid network config: empty config");const r=[];if(Array.isArray(t)?r.push(...t):r.push(t),0===r.length){if(e)throw new Error("invalid network config: empty config");return!1}const i=r.map(t=>t.chainId).sort(),s=i.filter((t,e)=>i.indexOf(t)!==e);if(s.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}r.forEach(t=>t.name=t.name.toLowerCase());const o=r.map(t=>t.name).sort(),a=o.filter((t,e)=>o.indexOf(t)!==e);if(a.length>0){if(e)throw new Error(`invalid network config: duplicate network names ${a}`);return!1}let c=!1,l=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&e)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(e)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l){if(e)throw new Error("invalid network config: AuthChain must be set")}})(t,!0,e),t),Ed=t=>vd(Id(t)),Id=t=>{if(!t)return[];const e=t.sort((t,e)=>t.chainId===e.chainId?0:t.chainId<e.chainId?-1:1),n=e.findIndex(t=>t.isDefaultChain);n>0&&e.splice(0,0,e.splice(n,1)[0]);const r=e.findIndex(t=>t.isAuthChain&&!0!==t.isDefaultChain);return r>0&&e.splice(1,0,e.splice(r,1)[0]),e},Ad=(t,e)=>"string"==typeof t?(e=e||{},t.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,function(t,n){let r=e[n];return r="function"==typeof r?r():null==r?"":"object"==typeof r||"symbol"==typeof r?r.toString():r.valueOf(),r})):"";let kd;!function(t){t[t.MAINNET=1]="MAINNET",t[t.ROPSTEN=3]="ROPSTEN",t[t.RINKEBY=4]="RINKEBY",t[t.GOERLI=5]="GOERLI",t[t.KOVAN=42]="KOVAN",t[t.POLYGON=137]="POLYGON",t[t.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",t[t.POLYGON_ZKEVM=1101]="POLYGON_ZKEVM",t[t.BSC=56]="BSC",t[t.BSC_TESTNET=97]="BSC_TESTNET",t[t.OPTIMISM=10]="OPTIMISM",t[t.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",t[t.ARBITRUM=42161]="ARBITRUM",t[t.ARBITRUM_GOERLI=421613]="ARBITRUM_GOERLI",t[t.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",t[t.AVALANCHE=43114]="AVALANCHE",t[t.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",t[t.FANTOM=250]="FANTOM",t[t.FANTOM_TESTNET=4002]="FANTOM_TESTNET",t[t.GNOSIS=100]="GNOSIS",t[t.AURORA=1313161554]="AURORA",t[t.AURORA_TESTNET=1313161556]="AURORA_TESTNET",t[t.BASE_GOERLI=84531]="BASE_GOERLI"}(kd||(kd={}));const Cd=t=>Ad("https://${network}-indexer.sequence.app",{network:t}),Nd=t=>Ad("https://${network}-relayer.sequence.app",{network:t}),Td=t=>Ad("https://nodes.sequence.app/${network}",{network:t}),Od={[kd.MAINNET]:{chainId:kd.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[kd.ROPSTEN]:{chainId:kd.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[kd.RINKEBY]:{chainId:kd.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",disabled:!0},[kd.GOERLI]:{chainId:kd.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[kd.KOVAN]:{chainId:kd.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[kd.POLYGON]:{chainId:kd.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[kd.POLYGON_MUMBAI]:{chainId:kd.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[kd.POLYGON_ZKEVM]:{chainId:kd.POLYGON_ZKEVM,name:"polygon-zkevm",title:"Polygon zkEVM",blockExplorer:{name:"Polygonscan (zkEVM)",rootUrl:"https://zkevm.polygonscan.com/"}},[kd.BSC]:{chainId:kd.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[kd.BSC_TESTNET]:{chainId:kd.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[kd.OPTIMISM]:{chainId:kd.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[kd.OPTIMISM_TESTNET]:{chainId:kd.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[kd.ARBITRUM]:{chainId:kd.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[kd.ARBITRUM_GOERLI]:{chainId:kd.ARBITRUM_GOERLI,name:"arbitrum-goerli",title:"Arbitrum Goerli",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[kd.ARBITRUM_NOVA]:{chainId:kd.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[kd.AVALANCHE]:{chainId:kd.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[kd.AVALANCHE_TESTNET]:{chainId:kd.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[kd.FANTOM]:{chainId:kd.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[kd.FANTOM_TESTNET]:{chainId:kd.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[kd.GNOSIS]:{chainId:kd.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[kd.AURORA]:{chainId:kd.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[kd.AURORA_TESTNET]:{chainId:kd.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}},[kd.BASE_GOERLI]:{chainId:kd.BASE_GOERLI,name:"base-goerli",title:"Base Goerli",blockExplorer:{name:"Base Goerli Explorer",rootUrl:"https://goerli.basescan.org/"}}},xd=Ed([wd({},Od[kd.MAINNET],{rpcUrl:Td("mainnet"),relayer:{url:Nd("mainnet")},indexerUrl:Cd("mainnet")}),wd({},Od[kd.POLYGON],{rpcUrl:Td("polygon"),relayer:{url:Nd("polygon")},indexerUrl:Cd("polygon"),isDefaultChain:!0,isAuthChain:!0}),wd({},Od[kd.BSC],{rpcUrl:Td("bsc"),indexerUrl:Cd("bsc"),relayer:{url:Nd("bsc")}}),wd({},Od[kd.AVALANCHE],{rpcUrl:Td("avalanche"),indexerUrl:Cd("avalanche"),relayer:{url:Nd("avalanche")}}),wd({},Od[kd.ARBITRUM],{rpcUrl:Td("arbitrum"),indexerUrl:Cd("arbitrum"),relayer:{url:Nd("arbitrum")}}),wd({},Od[kd.ARBITRUM_NOVA],{rpcUrl:Td("arbitrum-nova"),indexerUrl:Cd("arbitrum-nova"),relayer:{url:Nd("arbitrum-nova")}}),wd({},Od[kd.OPTIMISM],{rpcUrl:Td("optimism"),indexerUrl:Cd("optimism"),relayer:{url:Nd("optimism")}}),wd({},Od[kd.POLYGON_ZKEVM],{rpcUrl:Td("polygon-zkevm"),indexerUrl:Cd("polygon-zkevm"),relayer:{url:Nd("polygon-zkevm")}}),wd({},Od[kd.GNOSIS],{rpcUrl:Td("gnosis"),indexerUrl:Cd("gnosis"),relayer:{url:Nd("gnosis")}})]),Sd=(Ed([wd({},Od[kd.RINKEBY],{rpcUrl:Td("rinkeby"),relayer:{url:Nd("rinkeby")},indexerUrl:Cd("rinkeby")}),wd({},Od[kd.GOERLI],{rpcUrl:Td("goerli"),relayer:{url:Nd("goerli")},indexerUrl:Cd("goerli")}),wd({},Od[kd.POLYGON_MUMBAI],{rpcUrl:Td("mumbai"),relayer:{url:Nd("mumbai")},indexerUrl:Cd("mumbai"),isDefaultChain:!0,isAuthChain:!0}),wd({},Od[kd.BSC_TESTNET],{rpcUrl:Td("bsc-testnet"),relayer:{url:Nd("bsc-testnet")},indexerUrl:Cd("bsc-testnet")}),wd({},Od[kd.ARBITRUM_GOERLI],{rpcUrl:Td("arbitrum-goerli"),relayer:{url:Nd("arbitrum-goerli")},indexerUrl:Cd("arbitrum-goerli")}),wd({},Od[kd.BASE_GOERLI],{rpcUrl:Td("base-goerli"),relayer:{url:Nd("base-goerli")},indexerUrl:Cd("base-goerli")})]),{factory:"0xf9D09D634Fb818b05149329C1dcCFAeA53639d96",mainModule:"0xd01F11855bCcb95f88D7A48492F66410d4637313",mainModuleUpgradable:"0x7EFE6cE415956c5f80C6530cC6cc81b4808F6118",guestModule:"0x02390F3E6E5FD1C6786CB78FD3027C117a9955A7",sequenceUtils:"0xd130B43062D875a4B7aF3f8fc036Bc6e9D3E1B3E",libs:{requireFreshSigner:"0xE6B9B21C077F382333220a072e4c44280b873907"}});class Rd{constructor(t,e){this.sender=void 0,this.handler=void 0,this.sender=e,t&&this.setMiddleware(t)}setMiddleware(t){this.handler=_d(t,this.sender.sendAsync)}sendAsync(t,e,n){try{this.handler(t,e,n)}catch(t){e(t,void 0)}}}const _d=(t,e)=>{if(0===t.length)return e;const n=t=>t.sendAsyncMiddleware?t.sendAsyncMiddleware:t;let r;r=n(t[t.length-1])(e);for(let e=t.length-2;e>=0;e--)r=n(t[e])(r);return r};function Pd(t){return void 0!==t&&void 0!==t.send&&void 0!==t.constructor.defaultUrl&&void 0!==t.detectNetwork&&void 0!==t.getSigner&&void 0!==t.perform}let Bd=0;class Ud{constructor(t,e){var n;this.send=void 0,this.request=void 0,this.defaultChainId=void 0,this.sendAsync=(t,e,n)=>{this.send(t.method,t.params,n||this.defaultChainId).then(n=>{e(void 0,{jsonrpc:"2.0",id:t.id,result:n})}).catch(t=>{e(t,void 0)})},this.defaultChainId=e,Pd(t)?this.send=t.send.bind(t):void 0!==(n=t)&&void 0!==n.sendAsync?this.send=(e,n,r)=>new Promise((i,s)=>{t.sendAsync({jsonrpc:"2.0",id:++Bd,method:e,params:n},(t,e)=>{t?s(t):i(e?e.result:void 0)},r||this.defaultChainId)}):this.send=t,this.request=(t,e)=>this.send(t.method,t.params,e)}}class Ld{constructor(t){this.cachableJsonRpcMethods=["net_version","eth_chainId","eth_accounts","sequence_getWalletContext","sequence_getNetworks"],this.cachableJsonRpcMethodsByBlock=["eth_call","eth_getCode"],this.cache=void 0,this.cacheByBlock=void 0,this.cacheByBlockResetLock=!1,this.onUpdateCallback=void 0,this.defaultChainId=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method)){const t=this.cacheKey(e.method,e.params,r||this.defaultChainId),i=this.getCacheValue(t);if(i&&""!==i)return void n(void 0,{jsonrpc:"2.0",id:e.id,result:i})}t(e,(t,r,i)=>{if((this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method))&&r&&r.result&&this.shouldCacheResponse(e,r)){const t=this.cacheKey(e.method,e.params,i||this.defaultChainId);this.cachableJsonRpcMethods.includes(e.method)?this.setCacheValue(t,r.result):this.setCacheByBlockValue(t,r.result)}n(t,r)},r||this.defaultChainId)},this.cacheKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.getCache=()=>this.cache,this.setCache=t=>{this.cache=t,this.onUpdateCallback&&this.onUpdateCallback()},this.getCacheValue=t=>this.cache[t]?this.cache[t]:this.cacheByBlock[t]?this.cacheByBlock[t]:void 0,this.setCacheValue=(t,e)=>{this.cache[t]=e,this.onUpdateCallback&&this.onUpdateCallback(t,e)},this.setCacheByBlockValue=(t,e)=>{this.cacheByBlock[t]=e,this.cacheByBlockResetLock||(this.cacheByBlockResetLock=!0,setTimeout(()=>{this.cacheByBlockResetLock=!1,this.cacheByBlock={}},1500))},this.shouldCacheResponse=(t,e)=>!(!e||!e.result||"eth_getCode"===t.method&&e.result.length<=2),this.clearCache=()=>{this.cache={},this.cacheByBlock={}},this.cache={},this.cacheByBlock={},this.defaultChainId=null==t?void 0:t.defaultChainId,null!=t&&t.blockCache?!0!==(null==t?void 0:t.blockCache)&&(this.cachableJsonRpcMethodsByBlock=null==t?void 0:t.blockCache):this.cachableJsonRpcMethodsByBlock=[]}onUpdate(t){this.onUpdateCallback=t}}class Md{constructor(t){this.options=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{const{id:i,method:o}=e;switch(o){case"net_version":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:`${this.options.chainId}`});break;case"eth_chainId":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:s.utils.hexlify(this.options.chainId)});break;case"eth_accounts":if(this.options.accountAddress)return void n(void 0,{jsonrpc:"2.0",id:i,result:[s.utils.getAddress(this.options.accountAddress)]});break;case"sequence_getWalletContext":if(this.options.walletContext)return void n(void 0,{jsonrpc:"2.0",id:i,result:this.options.walletContext})}t(e,n,r)},this.options=t}}class Fd{constructor(){this.singleflightJsonRpcMethods=["eth_chainId","net_version","eth_call","eth_getCode","eth_blockNumber","eth_getBalance","eth_getStorageAt","eth_getTransactionCount","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getBlockByHash","eth_getBlockByNumber","eth_getTransactionByHash","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getLogs"],this.inflight=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(!this.singleflightJsonRpcMethods.includes(e.method))return void t(e,n,r);const i=this.requestKey(e.method,e.params||[],r);this.inflight[i]?this.inflight[i].push({id:e.id,callback:n}):(this.inflight[i]=[],t(e,(t,e,r)=>{n(t,e);for(let n=0;n<this.inflight[i].length;n++){const r=this.inflight[i][n];t?r.callback(t,e):e&&r.callback(void 0,{jsonrpc:"2.0",id:r.id,result:e.result})}delete this.inflight[i]},r))},this.requestKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.inflight={}}}class Dd extends s.providers.JsonRpcProvider{constructor(t,e){super(t,null==e?void 0:e.chainId),this._chainId=void 0,this._sender=void 0,this.send=(t,e)=>this._sender.send(t,e),this.fetch=(t,e)=>{const n={method:t,params:e,id:this._nextId++,jsonrpc:"2.0"};return s.utils.fetchJson(this.connection,JSON.stringify(n),Gd).then(t=>t,t=>{throw t})};const n=null==e?void 0:e.chainId,r=null==e?void 0:e.middlewares,i=null==e?void 0:e.blockCache;this._chainId=n;const o=new Rd(null!=r?r:[new Md({chainId:n}),new Fd,new Ld({defaultChainId:n,blockCache:i})],new Ud(this.fetch,n));this._sender=new Ud(o,n)}async getNetwork(){const t=this._chainId;if(t){const e=Od[t];return{name:(null==e?void 0:e.name)||"",chainId:t,ensAddress:null==e?void 0:e.ensAddress}}{const t=await this.send("eth_chainId",[]);return this._chainId=s.BigNumber.from(t).toNumber(),this.getNetwork()}}}function Gd(t){if(t.error){const e=new Error(t.error.message);throw e.code=t.error.code,e.data=t.error.data,e}return t.result}function $d(){return $d=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$d.apply(this,arguments)}const Vd="v1",qd="v0.4.0",jd="98e0726794b2b5922a0e356280daac3a409602e4";class Wd{constructor(t,e){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Guard/",this.ping=t=>this.fetch(this.url("Ping"),Hd({},t)).then(t=>Kd(t).then(t=>({status:t.status}))),this.version=t=>this.fetch(this.url("Version"),Hd({},t)).then(t=>Kd(t).then(t=>({version:t.version}))),this.runtimeStatus=t=>this.fetch(this.url("RuntimeStatus"),Hd({},t)).then(t=>Kd(t).then(t=>({status:t.status}))),this.getSequenceContext=t=>this.fetch(this.url("GetSequenceContext"),Hd({},t)).then(t=>Kd(t).then(t=>({data:t.data}))),this.getSignerConfig=t=>this.fetch(this.url("GetSignerConfig"),Hd({},t)).then(t=>Kd(t).then(t=>({signerConfig:t.signerConfig}))),this.sign=(t,e)=>this.fetch(this.url("Sign"),Hd(t,e)).then(t=>Kd(t).then(t=>({sig:t.sig}))),this.hostname=t,this.fetch=(t,n)=>e(t,n)}url(t){return this.hostname+this.path+t}}const Hd=(t={},e={})=>({method:"POST",headers:$d({},e,{"Content-Type":"application/json"}),body:JSON.stringify(t||{})}),Kd=t=>t.text().then(e=>{let n;try{n=JSON.parse(e)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${e}`,status:t.status}}if(!t.ok)throw n;return n});function zd(){return zd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zd.apply(this,arguments)}function Jd(t){return void 0!==t.bundleCreation&&"boolean"==typeof t.bundleCreation||void 0!==t.creationGasLimit&&nh(t.creationGasLimit)||void 0!==t.provider&&(o.providers.Provider.isProvider(t.provider)||"string"==typeof t.provider)}const Yd={bundleCreation:!0,creationGasLimit:s.constants.Two.pow(17)};class Zd{constructor(t){this.provider=void 0,this.bundleCreation=void 0,this.creationGasLimit=void 0;const e=zd({},Yd,t);this.bundleCreation=e.bundleCreation,this.provider=e.provider,this.creationGasLimit=s.BigNumber.from(e.creationGasLimit)}async isWalletDeployed(t){if(!this.provider)throw new Error("Bundled creation provider not found");return"0x"!==await this.provider.getCode(t)}prepareWalletDeploy(t,e){const n=new o.utils.Interface(b.factory.abi);return{to:e.factory,data:n.encodeFunctionData(n.getFunction("deploy"),[e.mainModule,Sh(t)])}}async prependWalletDeploy(t){const{config:e,context:n,transactions:r,nonce:i,signature:a}=t,c=xh(e,n),l=new o.utils.Interface(b.mainModule.abi),h=async function(){const t=await a;return"string"==typeof t?t:Zh(t)}();return this.bundleCreation&&!await this.isWalletDeployed(c)?{to:n.guestModule,execute:{transactions:[zd({},this.prepareWalletDeploy(e,n),{delegateCall:!1,revertOnError:!1,gasLimit:this.creationGasLimit,value:s.constants.Zero}),{delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:c,value:s.constants.Zero,data:l.encodeFunctionData(l.getFunction("execute"),[hd(r),i,await h])}],nonce:s.constants.Zero,signature:"0x"}}:{to:c,execute:{transactions:r,nonce:s.BigNumber.from(i),signature:await h}}}async prepareTransactions(t,e,n,...r){const i=ld(...r);if(!i)throw new Error("Unable to prepare transactions without a defined nonce");const{to:s,execute:a}=await this.prependWalletDeploy({config:t,context:e,transactions:r,nonce:i,signature:n}),c=new o.utils.Interface(b.mainModule.abi);return{to:s,data:c.encodeFunctionData(c.getFunction("execute"),[hd(a.transactions),a.nonce,a.signature])}}}const Xd=s.BigNumber.from(8e5),Qd={waitPollRate:1e3,deltaBlocksLog:12,fromBlockLog:-1024};function tf(t){return void 0!==t.provider&&o.providers.Provider.isProvider(t.provider)}class ef extends Zd{constructor(t){super(t),this.provider=void 0,this.waitPollRate=void 0,this.deltaBlocksLog=void 0,this.fromBlockLog=void 0;const e=zd({},Qd,t);this.provider=e.provider,this.waitPollRate=e.waitPollRate,this.deltaBlocksLog=e.deltaBlocksLog,this.fromBlockLog=e.fromBlockLog}async simulate(t,...e){var n=this;return(await Promise.all(e.map(async function(e){if(e.gasLimit&&!s.BigNumber.from(e.gasLimit||0).eq(s.constants.Zero))return e.gasLimit;if(e.delegateCall)return Xd;if(e.to===t&&!await n.isWalletDeployed(t))return Xd;if(!n.provider)throw new Error("signer.provider is not set, but is required");return n.provider.estimateGas({from:t,to:e.to,data:e.data,value:e.value})}))).map(t=>({executed:!0,succeeded:!0,gasUsed:s.BigNumber.from(t).toNumber(),gasLimit:s.BigNumber.from(t).toNumber()}))}async getNonce(t,e,n,r){if(!this.provider)throw new Error("provider is not set");const i=xh(t,e);if("0x"===await this.provider.getCode(i))return 0;void 0===n&&(n=0);const s=new Kr(i,b.mainModule.abi,this.provider);return pd(n,await s.readNonce(n,{blockTag:r}))}async wait(t,e,n=this.waitPollRate,r=5){var i=this;"string"!=typeof t&&(Ml.info("computing id",t.config,t.context,t.chainId,...t.transactions),t=nd(xh(t.config,t.context),t.chainId,...t.transactions));let s=!1;const o=async function(t,e){let i=0;for(;!s;){try{return await t()}catch(t){if(i++,void 0!==r&&i>=r)throw Ml.error(`giving up after ${i} failed attempts${e?`: ${e}`:""}`,t),t;Ml.warn(`attempt #${i} failed${e?`: ${e}`:""}`,t)}n>0&&await new Promise(t=>setTimeout(t,n))}throw new Error(`timed out after ${i} failed attempts${e?`: ${e}`:""}`)},a=async function(){let e=i.fromBlockLog;if(e<0){const t=await o(()=>i.provider.getBlockNumber(),"unable to get latest block number");e=t+e}if("string"!=typeof t)throw new Error("impossible");const r=t.replace("0x","");for(;!s;){const t=await o(()=>i.provider.getBlockNumber(),"unable to get latest block number"),a=await o(()=>i.provider.getLogs({fromBlock:Math.max(0,e-i.deltaBlocksLog),toBlock:t,topics:["0x1f180c27086c7a39ea2a7b25239d1ab92348f07ca7bb59d1438fcf527568f881"]}),`unable to get NonceChange logs for blocks ${Math.max(0,e-i.deltaBlocksLog)} to ${t}`);e=t;const c=(await Promise.all(a.map(t=>o(()=>i.provider.getTransactionReceipt(t.transactionHash),`unable to get receipt for transaction ${t.transactionHash}`)))).find(t=>t.logs.find(t=>0===t.topics.length&&t.data.replace("0x","")===r||1===t.topics.length&&"0x3dbd1590ea96dd3253a91f24e64e3a502e1225d602a5731357bc12643070ccd7"===t.topics[0]&&t.data.length>=64&&t.data.replace("0x","").startsWith(r)));if(c)return zd({receipt:c},await o(()=>i.provider.getTransaction(c.transactionHash),`unable to get transaction ${c.transactionHash}`));s||await new Promise(t=>setTimeout(t,n))}throw new Error(`Timeout waiting for transaction receipt ${t}`)};return void 0!==e?Promise.race([a(),new Promise((n,r)=>setTimeout(()=>{s=!0,r(`Timeout waiting for transaction receipt ${t}`)},e))]):a()}}function nf(t){return void 0!==t.signer&&o.Signer.isSigner(t.signer)}class rf extends ef{constructor(t){if(super(o.Signer.isSigner(t)?{provider:t.provider}:zd({},t,{provider:t.signer.provider})),this.signer=void 0,this.txnOptions=void 0,this.signer=o.Signer.isSigner(t)?t:t.signer,!this.signer.provider)throw new Error("Signer must have a provider")}async deployWallet(t,e){const n=this.prepareWalletDeploy(t,e);return this.signer.sendTransaction(zd({},n,{gasLimit:s.constants.Two.pow(17)}))}async getFeeOptions(t,e,...n){return{options:[]}}async gasRefundOptions(t,e,...n){const{options:r}=await this.getFeeOptions(t,e,...n);return r}setTransactionOptions(t){this.txnOptions=t}async relay(t,e,n=!0){if(void 0!==e&&Ml.warn("LocalRelayer doesn't accept fee quotes"),!t.context.guestModule||42!==t.context.guestModule.length)throw new Error("LocalRelayer requires the context.guestModule address");const{to:r,execute:i}=await this.prependWalletDeploy(t),o=new s.utils.Interface(b.mainModule.abi),a=o.encodeFunctionData(o.getFunction("execute"),[hd(i.transactions),i.nonce,i.signature]),c=this.signer.sendTransaction(zd({to:r,data:a},this.txnOptions));if(n){const t=await c;return t.receipt=await t.wait(),t}return c}}let sf,of,af,cf;!function(t){t.UNKNOWN="UNKNOWN",t.DROPPED="DROPPED",t.QUEUED="QUEUED",t.SENT="SENT",t.SUCCEEDED="SUCCEEDED",t.PARTIALLY_FAILED="PARTIALLY_FAILED",t.FAILED="FAILED"}(sf||(sf={})),function(t){t.SEND="SEND",t.RECEIVE="RECEIVE",t.BRIDGE_DEPOSIT="BRIDGE_DEPOSIT",t.BRIDGE_WITHDRAW="BRIDGE_WITHDRAW",t.BURN="BURN",t.UNKNOWN="UNKNOWN"}(of||(of={})),function(t){t.UNKNOWN="UNKNOWN",t.ERC20_TOKEN="ERC20_TOKEN",t.ERC1155_TOKEN="ERC1155_TOKEN"}(af||(af={})),function(t){t.DESC="DESC",t.ASC="ASC"}(cf||(cf={}));class lf{constructor(t,e){this.hostname=void 0,this.fetch=void 0,this.path="/rpc/Relayer/",this.ping=t=>this.fetch(this.url("Ping"),hf({},t)).then(t=>uf(t).then(t=>({status:t.status}))),this.version=t=>this.fetch(this.url("Version"),hf({},t)).then(t=>uf(t).then(t=>({version:t.version}))),this.runtimeStatus=t=>this.fetch(this.url("RuntimeStatus"),hf({},t)).then(t=>uf(t).then(t=>({status:t.status}))),this.getSequenceContext=t=>this.fetch(this.url("GetSequenceContext"),hf({},t)).then(t=>uf(t).then(t=>({data:t.data}))),this.getChainID=t=>this.fetch(this.url("GetChainID"),hf({},t)).then(t=>uf(t).then(t=>({chainID:t.chainID}))),this.sendMetaTxn=(t,e)=>this.fetch(this.url("SendMetaTxn"),hf(t,e)).then(t=>uf(t).then(t=>({status:t.status,txnHash:t.txnHash}))),this.getMetaTxnNonce=(t,e)=>this.fetch(this.url("GetMetaTxnNonce"),hf(t,e)).then(t=>uf(t).then(t=>({nonce:t.nonce}))),this.getMetaTxnReceipt=(t,e)=>this.fetch(this.url("GetMetaTxnReceipt"),hf(t,e)).then(t=>uf(t).then(t=>({receipt:t.receipt}))),this.simulate=(t,e)=>this.fetch(this.url("Simulate"),hf(t,e)).then(t=>uf(t).then(t=>({results:t.results}))),this.updateMetaTxnGasLimits=(t,e)=>this.fetch(this.url("UpdateMetaTxnGasLimits"),hf(t,e)).then(t=>uf(t).then(t=>({payload:t.payload}))),this.feeTokens=t=>this.fetch(this.url("FeeTokens"),hf({},t)).then(t=>uf(t).then(t=>({isFeeRequired:t.isFeeRequired,tokens:t.tokens}))),this.feeOptions=(t,e)=>this.fetch(this.url("FeeOptions"),hf(t,e)).then(t=>uf(t).then(t=>({options:t.options,quote:t.quote}))),this.getMetaTxnNetworkFeeOptions=(t,e)=>this.fetch(this.url("GetMetaTxnNetworkFeeOptions"),hf(t,e)).then(t=>uf(t).then(t=>({options:t.options}))),this.sentTransactions=(t,e)=>this.fetch(this.url("SentTransactions"),hf(t,e)).then(t=>uf(t).then(t=>({page:t.page,transactions:t.transactions}))),this.pendingTransactions=(t,e)=>this.fetch(this.url("PendingTransactions"),hf(t,e)).then(t=>uf(t).then(t=>({page:t.page,transactions:t.transactions}))),this.listGasSponsors=(t,e)=>this.fetch(this.url("ListGasSponsors"),hf(t,e)).then(t=>uf(t).then(t=>({page:t.page,gasSponsors:t.gasSponsors}))),this.addGasSponsor=(t,e)=>this.fetch(this.url("AddGasSponsor"),hf(t,e)).then(t=>uf(t).then(t=>({status:t.status,gasSponsor:t.gasSponsor}))),this.updateGasSponsor=(t,e)=>this.fetch(this.url("UpdateGasSponsor"),hf(t,e)).then(t=>uf(t).then(t=>({status:t.status,gasSponsor:t.gasSponsor}))),this.reportGasSponsorUsage=(t,e)=>this.fetch(this.url("ReportGasSponsorUsage"),hf(t,e)).then(t=>uf(t).then(t=>({gasSponsorUsage:t.gasSponsorUsage}))),this.hostname=t,this.fetch=(t,n)=>e(t,n)}url(t){return this.hostname+this.path+t}}const hf=(t={},e={})=>({method:"POST",headers:zd({},e,{"Content-Type":"application/json"}),body:JSON.stringify(t||{})}),uf=t=>t.text().then(e=>{let n;try{n=JSON.parse(e)}catch(n){throw{code:"unknown",msg:`expecting JSON, got: ${e}`,status:t.status}}if(!t.ok)throw n;return n});var df=Object.freeze({__proto__:null,WebRPCVersion:"v1",WebRPCSchemaVersion:"v0.4.0",WebRPCSchemaHash:"752f4f4274ca80d2fd974b5b44ed8245dfe40554",get ETHTxnStatus(){return sf},get TransferType(){return of},get FeeTokenType(){return af},get SortOrder(){return cf},Relayer:lf});const ff=[sf.DROPPED,sf.SUCCEEDED,sf.PARTIALLY_FAILED,sf.FAILED],pf=[sf.DROPPED,sf.PARTIALLY_FAILED,sf.FAILED];function gf(t){return void 0!==t.url&&"string"==typeof t.url}const mf="object"==typeof n.g?n.g.fetch:window.fetch;class yf extends Zd{constructor(t){super(t),this.service=void 0,this.service=new lf(t.url,mf)}async waitReceipt(t,e=1e3,n=5,r){"string"!=typeof t&&(Ml.info("computing id",t.config,t.context,t.chainId,...t.transactions),t=nd(xh(t.config,t.context),t.chainId,...t.transactions)),Ml.info(`[rpc-relayer/waitReceipt] waiting for ${t}`);let i=0;for(;void 0===r||!r();){try{const{receipt:e}=await this.service.getMetaTxnReceipt({metaTxID:t});if(e&&e.txnReceipt&&"null"!==e.txnReceipt&&ff.includes(e.status))return{receipt:e}}catch(t){if(i++,i===n)throw t}void 0!==r&&r()||await new Promise(t=>setTimeout(t,e))}throw new Error(`Cancelled waiting for transaction receipt ${t}`)}async simulate(t,...e){const n=s.utils.defaultAbiCoder.encode([Zu],[hd(e)]);return(await this.service.simulate({wallet:t,transactions:n})).results}async getFeeOptions(t,e,...n){const r=await this.service.feeTokens();if(r.isFeeRequired){const i=r.tokens.map(t=>t.symbol).join(", ");Ml.info(`[rpc-relayer/getFeeOptions] relayer fees are required, accepted tokens are ${i}`);const o=xh(t,e);let a=ld(...n);if(void 0===a&&(a=await this.getNonce(t,e)),!this.provider)throw Ml.warn("[rpc-relayer/getFeeOptions] provider not set, needed for stub signature"),new Error("provider is not set");const{to:c,execute:l}=await this.prependWalletDeploy({config:t,context:e,transactions:n,nonce:a,signature:tu(this.provider,t)}),h=new s.utils.Interface(b.mainModule.abi),u=h.encodeFunctionData(h.getFunction("execute"),[hd(l.transactions),l.nonce,l.signature]),{options:d,quote:f}=await this.service.feeOptions({wallet:o,to:c,data:u});return Ml.info(`[rpc-relayer/getFeeOptions] got refund options ${JSON.stringify(d)}`),{options:d,quote:{_tag:"FeeQuote",_quote:f}}}return Ml.info("[rpc-relayer/getFeeOptions] relayer fees are not required"),{options:[]}}async gasRefundOptions(t,e,...n){const{options:r}=await this.getFeeOptions(t,e,...n);return r}async getNonce(t,e,n){const r=xh(t,e);Ml.info(`[rpc-relayer/getNonce] get nonce for wallet ${r} space: ${n}`);const i=void 0!==n?s.BigNumber.from(n).toHexString():void 0,o=await this.service.getMetaTxnNonce({walletContractAddress:r,space:i}),a=s.BigNumber.from(o.nonce),[c,l]=gd(a);return Ml.info(`[rpc-relayer/getNonce] got next nonce for wallet ${r} ${l} space: ${c}`),a}async relay(t,e,n=!0){var r=this;let i;if(Ml.info(`[rpc-relayer/relay] relaying signed meta-transactions ${JSON.stringify(t)} with quote ${JSON.stringify(e)}`),void 0!==e&&("string"==typeof e._quote?i=e._quote:Ml.warn("[rpc-relayer/relay] ignoring invalid fee quote")),!this.provider)throw Ml.warn("[rpc-relayer/relay] provider not set, failed relay"),new Error("provider is not set");const{to:o,execute:a}=await this.prependWalletDeploy(t),c=xh(t.config,t.context),l=new s.utils.Interface(b.mainModule.abi),h=l.encodeFunctionData(l.getFunction("execute"),[hd(a.transactions),a.nonce,a.signature]),u=await this.service.sendMetaTxn({call:{walletAddress:c,contract:o,input:h},quote:i});if(Ml.info(`[rpc-relayer/relay] got relay result ${JSON.stringify(u)}`),n)return this.wait(u.txnHash);{const t={hash:u.txnHash,confirmations:0,from:c,wait:t=>Promise.reject(new Error("impossible"))},e=async function(e){var n;if(!r.provider)throw new Error("cannot wait for receipt, relayer has no provider set");const i=await r.wait(u.txnHash),s=null==(n=i.receipt)?void 0:n.transactionHash;if(!s)throw new Error("cannot wait for receipt, unknown native transaction hash");return Object.assign(t,i),r.provider.waitForTransaction(s,e)};return t.wait=e,t}}async wait(t,e,n=1e3,r=5){var i=this;let o=!1;const{receipt:a}=await(void 0!==e?Promise.race([this.waitReceipt(t,n,r,()=>o),new Promise((n,r)=>setTimeout(()=>{o=!0,r(`Timeout waiting for transaction receipt ${t}`)},e))]):this.waitReceipt(t,n,r));if(!a.txnReceipt||pf.includes(a.status))throw new wf(a);const c=JSON.parse(a.txnReceipt);return{blockHash:c.blockHash,blockNumber:s.BigNumber.from(c.blockNumber).toNumber(),confirmations:1,from:"string"==typeof t?void 0:xh(t.config,t.context),hash:c.transactionHash,raw:a.txnReceipt,receipt:c,wait:async function(t){return i.provider.waitForTransaction(c.transactionHash,t)}}}}class wf{constructor(t){this.receipt=t}}function bf(t){return"object"==typeof t&&"function"==typeof t.simulate&&"function"==typeof t.getFeeOptions&&"function"==typeof t.gasRefundOptions&&"function"==typeof t.getNonce&&"function"==typeof t.relay&&"function"==typeof t.wait}function vf(){return vf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vf.apply(this,arguments)}class Ef extends o.Signer{static isSequenceSigner(t){return If(t)}}function If(t){const e=t;return e&&void 0!==e.updateConfig&&void 0!==e.publishConfig&&void 0!==e.getWalletContext&&void 0!==e.getWalletConfig}class Af extends Error{}class kf extends o.Signer{signMessage(t,e){return this.signMessageWithData(t)}sendTransaction(t){throw new Error("sendTransaction method is not supported in RemoteSigner")}signTransaction(t){throw new Error("signTransaction method is not supported in RemoteSigner")}connect(t){throw new Error("connect method is not supported in RemoteSigner")}static signMessageWithData(t,e,n,r){return this.isRemoteSigner(t)?t.signMessageWithData(e,n,r):t.signMessage(e)}static isRemoteSigner(t){return void 0!==t.signMessageWithData}}async function Cf(t){return Array.isArray(t)?Promise.all(t.map(t=>o.utils.resolveProperties(t))):o.utils.resolveProperties(t)}"object"==typeof n.g?n.g.fetch:window.fetch;class Nf extends Ef{constructor(t,...e){super(),this.context=void 0,this.config=void 0,this._signers=void 0,this.provider=void 0,this.sender=void 0,this.relayer=void 0,this.chainId=void 0;const{config:n,context:r,strict:i}=t;if(this.context=vf({},r||Sd),!0===i?this.context.nonStrict=void 0:!1===i&&(this.context.nonStrict=!0),!this.context.nonStrict&&!Th(n))throw new Error("wallet config is not usable (strict mode)");this.config=Rh(n),this._signers=e.map(t=>o.Signer.isSigner(t)?t:new Il(t)),this.imageHash}useConfig(t,e){return new Nf({config:t,context:this.context,strict:e},...this._signers).setProvider(this.provider,this.chainId).setRelayer(this.relayer)}useSigners(...t){return new Nf({config:this.config,context:this.context},...t).setProvider(this.provider,this.chainId).setRelayer(this.relayer)}connect(t,e){if(Pd(t))return new Nf({config:this.config,context:this.context},...this._signers).setProvider(t,this.chainId).setRelayer(e);throw new Error("Wallet provider argument is expected to be a JsonRpcProvider")}setProvider(t,e){if(void 0===t)return this;if(o.providers.Provider.isProvider(t))this.provider=t,this.sender=new Ud(t);else{const n=new Dd(t,{chainId:e,blockCache:!0});this.provider=n,this.sender=new Ud(n)}return this.chainId=e,this}setRelayer(t){return void 0===t||(this.relayer=t),this}async getProvider(t){return t&&await this.getChainIdNumber(t),this.provider}async getRelayer(t){return t&&await this.getChainIdNumber(t),this.relayer}async getWalletContext(){return this.context}async getWalletConfig(t){return t=await this.getChainIdNumber(t),[vf({},this.config,{chainId:t})]}async getWalletState(t){const[e,n,r]=await Promise.all([this.getAddress(),this.getChainId(),this.isDeployed()]);return[{context:this.context,config:this.config,address:e,chainId:n,deployed:r,imageHash:this.imageHash,lastImageHash:r?await Sf(this):void 0}]}get connected(){return void 0!==this.sender}get address(){return xh(this.config,this.context)}get imageHash(){return Sh(this.config)}async getAddress(){return this.address}async getSigners(){return this._signers&&0!==this._signers.length?Promise.all(this._signers.map(t=>t.getAddress().then(t=>s.utils.getAddress(t)))):[]}async getChainId(){if(this.chainId)return this.chainId;if(!this.provider)throw new Error("provider is not set, first connect a provider");return this.chainId=(await this.provider.getNetwork()).chainId,this.chainId}async getNetworks(){return[{chainId:await this.getChainId(),name:"",rpcUrl:""}]}async getNonce(t,e){return this.relayer.getNonce(this.config,this.context,e,t)}async getTransactionCount(t){const e=await this.getNonce(t,0),[n,r]=gd(e);return s.BigNumber.from(r).toNumber()}async sendTransaction(t,e,n,r,i,s){const o=await this.signTransactions(t,e,n);return i&&i(o,nd(xh(o.config,o.context),o.chainId,...o.transactions)),this.relayer.relay(o,r,s)}async sendTransactionBatch(t,e,n=!0,r,i,s){return this.sendTransaction(t,e,n,r,i,s)}async signTransactions(t,e,n){const r=await this.getChainIdNumber(e),i=await Cf(t);if(!this.provider)throw new Error("missing provider");if(!this.relayer)throw new Error("missing relayer");let s=await yd(this.context,this.address,i);if(s.some(t=>void 0===t.gasLimit)){const t=await this.relayer.simulate(this.address,...s);for(const e in s)void 0===s[e].gasLimit&&(s[e].gasLimit=t[e].gasLimit)}const o=ld(...s)||await this.getNonce();s=ud(s,o);const a=ed(o,...s);return{digest:a,chainId:r,context:this.context,config:this.config,transactions:s,nonce:o,signature:await this.sign(a,!0,e,n)}}async sendSignedTransactions(t,e,n){if(!this.relayer)throw new Error("relayer is not set, first connect a relayer");return await this.getChainIdNumber(e),this.relayer.relay(t,n)}async signMessage(t,e,n,r=!1){const i="string"!=typeof t||t.startsWith("0x")?t:s.utils.toUtf8Bytes(t);return this.sign(i,r,e,n)}async signTypedData(t,e,n,r,i){const s=await this.getChainIdNumber(r),a=t.chainId?o.BigNumber.from(t.chainId).toNumber():void 0;if(a&&a!==s)throw new Error(`signTypedData: domain.chainId (${t.chainId}) is expected to be ${s}`);const c=zl({domain:t,types:e,message:n});return this.sign(c,!0,s,i)}async _signTypedData(t,e,n,r,i){return this.signTypedData(t,e,n,r,i)}async subDigest(t,e){const n=await this.getChainIdNumber(e);return s.utils.arrayify(Sl(this.address,n,t))}async sign(t,e=!0,n,r){var i=this;const o=await this.getChainIdNumber(n),a=e?t:s.utils.keccak256(t),c=await this.subDigest(a,n),l=async function(t,e){const n=await Promise.all(t.map(t=>t.getAddress())),s=await Promise.all(i.config.signers.map(async function(s){try{const a=t[n.indexOf(s.address)];if(!a)return s;if(If(a)){if(a===i)throw Error("Can't sign transactions for self");return vf({},s,{signature:await a.signMessage(c,o,r,!0)+"03"})}if(kf.isRemoteSigner(a)){const t=await a.signMessageWithData(c,e,o);try{if(zh(c,{weight:s.weight,signature:t})===s.address)return{weight:s.weight,signature:t}}catch(t){}return vf({},s,{signature:t})}return{weight:s.weight,signature:await a.signMessage(c)+"02"}}catch(t){if(r)throw t;return console.warn(`Skipped signer ${s.address}`),s}}));return{threshold:i.config.threshold,signers:s}},h=this._signers.filter(t=>!kf.isRemoteSigner(t)),u=await l(h,this.packMsgAndSig(a,[],o));if(u.signers.filter(Gh).reduce((t,e)=>t+e.weight,0)>=this.config.threshold)return Zh(u);const d=this._signers.filter(t=>kf.isRemoteSigner(t)),f=await l(d,this.packMsgAndSig(a,Zh(u),o));return Zh(Jh(u,f))}async signWeight(){return(await this.getSigners()).reduce((t,e)=>{const n=this.config.signers.find(t=>t.address===e);return n?t.add(n.weight):t},s.constants.Zero)}async isDeployed(t){await this.getChainIdNumber(t);const e=await this.provider.getCode(this.address);return!!e&&"0x"!==e}async updateConfig(t,e,n=!1,r,i,s,o){t||(t=this.config);const[a,c]=await Promise.all([this.buildUpdateConfigTransaction(t,n,r),null!=e?e:this.getNonce()]);return[vf({address:this.address},t),await this.sendTransaction(ud(a,c),void 0,void 0,i,s,o)]}async publishConfig(t,e,n=[],r,i,s){return this.sendTransaction(this.config.address?this.buildPublishConfigTransaction(this.config,t,e):await this.buildPublishSignersTransaction(t,e,n),void 0,void 0,r,i,s)}async buildUpdateConfigTransaction(t,e=!1,n){var r=this;if(!this.context.nonStrict&&!Th(t))throw new Error("wallet config is not usable (strict mode)");const i=await async function(){try{const t=await r.provider.getStorageAt(r.address,s.utils.defaultAbiCoder.encode(["address"],[r.address]));return 0===Ph(t,r.context.mainModuleUpgradable)}catch(t){return!1}}(),a=new o.utils.Interface(b.mainModule.abi),c=2*(1e5+1800*t.signers.length),l=i?[]:[{delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:this.address,value:s.constants.Zero,data:a.encodeFunctionData(a.getFunction("updateImplementation"),[this.context.mainModuleUpgradable])}],h=new o.utils.Interface(b.mainModuleUpgradable.abi),u=[...l,{delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:this.address,value:s.constants.Zero,data:h.encodeFunctionData(h.getFunction("updateImageHash"),[Sh(t)])},...e?await this.buildPublishConfigTransaction(t,n):[]];return 1===u.length?u:[{delegateCall:!1,revertOnError:!1,gasLimit:c,to:this.address,value:s.constants.Zero,data:a.encodeFunctionData(a.getFunction("selfExecute"),[hd(u)])}]}buildPublishConfigTransaction(t,e=!0,n){const r=new o.utils.Interface(b.sequenceUtils.abi);return[{delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:this.context.sequenceUtils,value:s.constants.Zero,nonce:n,data:r.encodeFunctionData(r.getFunction("publishConfig"),[this.address,t.threshold,Rh(t).signers.map(t=>({weight:t.weight,signer:t.address})),e])}]}async buildPublishSignersTransaction(t=!0,e,n=[]){var r;const i=new o.utils.Interface(b.sequenceUtils.abi),a=new o.utils.Interface(b.requireFreshSigner.abi),c=s.utils.randomBytes(32),l=await this.signMessage(c,this.chainId,!1),h=Wh(l),u=Zh({threshold:h.threshold,signers:h.signers.map((t,e)=>{if(qh(t)){const t=this.config.signers[e];return{weight:t.weight,address:t.address}}return t})}),d=null==(r=this.context.libs)?void 0:r.requireFreshSigner;if(n.length>0&&void 0===d)throw Error("requireFreshSigners missing library");return[...n.map(t=>({delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:d,value:s.constants.Zero,nonce:e,data:a.encodeFunctionData(a.getFunction("requireFreshSigner"),[t])})),{delegateCall:!1,revertOnError:!0,gasLimit:s.constants.Zero,to:this.context.sequenceUtils,value:s.constants.Zero,nonce:e,data:i.encodeFunctionData(i.getFunction("publishInitialSigners"),[this.address,s.utils.keccak256(c),this.config.signers.length,u,t])}]}async getChainIdNumber(t){if(!t)return await this.getChainId();const e=bd(t);if(this.context.nonStrict)return e;const n=await this.getChainId();if(n!==e)throw new Error(`the specified chainId ${e} does not match the wallet's connected chainId ${n}`);return n}packMsgAndSig(t,e,n){return s.utils.defaultAbiCoder.encode(["address","uint256","bytes","bytes"],[this.address,n,t,e])}signTransaction(t){throw new Error("signTransaction method is not supported in Wallet, please use signTransactions(...)")}static async singleOwner(t,e){const n=o.Signer.isSigner(t)?t:new Il(t),r={threshold:1,signers:[{weight:1,address:s.utils.getAddress(await n.getAddress())}]};return new Nf({config:r,context:e},n)}async hasEnoughSigners(t){return t&&await this.getChainIdNumber(t),(await this.signWeight()).gte(this.config.threshold)}}class Tf extends Ef{constructor(t,...e){super(),this.options=void 0,this._wallets=void 0,this._signers=void 0,this.provider=void 0,this._chainId=void 0,this.options=t,this._signers=e,t.context||(this.options.context=vf({},Sd)),this.options.networks?this.setNetworks(this.options.networks):this.setNetworks([...xd])}useSigners(...t){return this._signers=t,this._wallets.forEach(e=>{e.wallet=e.wallet.useSigners(...t)}),this}async getWalletContext(){return this.options.context}getConfigFinder(){return this.options.configFinder?this.options.configFinder:new Fh(this.authWallet().wallet.provider)}async getWalletConfig(t){let e=[];if(t){const n=this.getWalletByNetwork(t);n&&e.push(n)}else e=this._wallets;return(await Promise.all(e.map(t=>t.wallet.getWalletConfig()))).flat()}async getWalletState(t){let e=[];if(t){const n=this.getWalletByNetwork(t);n&&e.push(n)}else e=this._wallets;const n=Promise.all(e.map(t=>this.getConfigFinder().findCurrentConfig({address:t.wallet.address,provider:t.wallet.provider,context:t.wallet.context,knownConfigs:[t.wallet.config]}))),r=(await Promise.all(e.map(t=>t.wallet.getWalletState()))).flat(),i=r.findIndex(t=>t.chainId===this.getAuthChainId());i>=0&&(r[i].config=await this.currentConfig(e[i].wallet));const s=await n;return r.map((t,e)=>{var n;return vf({},t,{config:null==(n=s[e])?void 0:n.config})})}get address(){return this._wallets[0].wallet.address}getAddress(){return this._wallets[0].wallet.getAddress()}async getSigners(){return this._wallets[0].wallet.getSigners()}async getProvider(t){var e,n;return t?null==(n=this._wallets.find(e=>e.network.chainId===t))?void 0:n.wallet.getProvider():null==(e=this.mainWallet())?void 0:e.wallet.getProvider()}async getRelayer(t){var e,n;return t?null==(n=this._wallets.find(e=>e.network.chainId===t))?void 0:n.wallet.getRelayer():null==(e=this.mainWallet())?void 0:e.wallet.getRelayer()}async getNetworks(){return this.options.networks}async getChainId(){if(this._chainId)return this._chainId;const t=await this.provider.getNetwork();return this._chainId=t.chainId,this._chainId}getAuthChainId(){try{return this.options.networks.find(t=>t.isAuthChain).chainId}catch(t){throw new Error("no auth network")}}async signMessage(t,e,n=!0,r=!1){var i=this;let{wallet:s}=await async function(){if(!e)return i.mainWallet();if(e.address){const t=await e.getChainId();return i.getWalletByNetwork(t)}return i.getWalletByNetwork(e)}(),o=await this.currentConfig(s);o=o||this._wallets[0].wallet.config,s=s.useConfig(o);const a=await s.signWeight();if(a.lt(s.config.threshold)&&!1!==n)throw new Af(`Sign message - wallet combined weight ${a.toString()} below required ${s.config.threshold.toString()}`);return s.signMessage(t,void 0,n,r)}async signAuthMessage(t,e=!0,n=!1){var r;return this.signMessage(t,null==(r=this.authWallet())?void 0:r.wallet,e,n)}async signTypedData(t,e,n,r,i=!0){const s=r?this.getWalletByNetwork(r).wallet:this.mainWallet().wallet,o=zl({domain:t,types:e,message:n});return this.signMessage(o,s,i,!0)}async _signTypedData(t,e,n,r,i=!0){return this.signTypedData(t,e,n,r,i)}async hasEnoughSigners(t){const e=t?this.getWalletByNetwork(t).wallet:this.mainWallet().wallet,n=await this.currentConfig(e);return e.useConfig(n).hasEnoughSigners()}async getFeeOptions(t,e,n=!0){const r=e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet,i=this.options.context;if(!i)throw new Error("missing wallet context");const[s,o]=await Promise.all([this.currentConfig(r),this.prependConfigUpdate(t,e,n,!0)]);if(!s)throw new Error(`missing current config for chain ${e}`);const a=await yd(i,this.address,o);return r.relayer.getFeeOptions(s,i,...a)}async sendTransaction(t,e,n=!0,r,i){const s=await this.signTransactions(t,e,n);return i&&i(s,nd(xh(s.config,s.context),s.chainId,...s.transactions)),(e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet).sendSignedTransactions(s,e,r)}async sendTransactionBatch(t,e,n=!0,r,i){return this.sendTransaction(t,e,n,r,i)}async signTransactions(t,e,n){const r=e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet;let i=await this.currentConfig(r);if(!i&&(i=await this.currentConfig(),!i))throw new Error("missing auth chain config");const s=await this.prependConfigUpdate(t,e,n);return r.useConfig(i).signTransactions(s)}async prependConfigUpdate(t,e,n,r){const i=await Cf(t),s=e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet,[o,a]=await Promise.all([this.currentConfig(s),this.currentConfig()]);if(!r){const t=await s.useConfig(o).signWeight();if(t.lt(o.threshold)&&n)throw new Af(`wallet combined weight ${t.toString()} below required threshold ${o.threshold.toString()}`)}if(await s.isDeployed()&&_h(a,o))return i;const c=Array.isArray(i)?i:[i];return[...await s.buildUpdateConfigTransaction(a,!1),...c]}async sendSignedTransactions(t,e,n){return(e?this.getWalletByNetwork(e).wallet:this.mainWallet().wallet).sendSignedTransactions(t,void 0,n)}async updateConfig(t,e,n,r){const i=this.authWallet().wallet;if(t=t?Rh(t):i.config,_h(i.config,t)&&!await this.isDeployed())return await i.updateConfig(t,void 0,!0,e,n,r);const s=await this.currentConfig();if(_h(s,t))return[vf({},s,{address:this.address}),void 0];const[o,a]=await i.useConfig(s).updateConfig(t,void 0,!0,e,n,r);return[vf({},t,{address:this.address}),a]}publishConfig(t,e=[],n,r){return this.authWallet().wallet.publishConfig(t,void 0,e,n,r)}async isDeployed(t){return(()=>t?t.address?t:this.getWalletByNetwork(t).wallet:this.authWallet().wallet)().isDeployed()}async currentConfig(t){const e=(()=>t?t.address?t:this.getWalletByNetwork(t).wallet:this.authWallet().wallet)();return(await this.getConfigFinder().findCurrentConfig({address:this.address,provider:e.provider,context:e.context,knownConfigs:[e.config]})).config}getWallets(){return this._wallets}getWalletByNetwork(t){const e=bd(t),n=this._wallets.find(t=>t.network.chainId===e);if(!n)throw new Error(`network ${t} not found in wallets list`);return n}mainWallet(){const t=this._wallets.find(t=>t.network.isDefaultChain);if(!t)throw new Error("mainWallet not found");return t}authWallet(){const t=this._wallets.find(t=>t.network.isAuthChain);if(!t)throw new Error("authChain wallet not found");return t}setNetworks(t,e=[],n){let r=[];if(this._chainId=void 0,n){const i=parseInt(n),s=t.find(t=>t.name===n||t.chainId===i),o=e.find(t=>t.name===n||t.chainId===i);if(!s&&!o)throw new Error(`unable to set default network as chain '${n}' does not exist`);s?(t.forEach(t=>t.isDefaultChain=!1),s.isDefaultChain=!0,r=t):o&&(e.forEach(t=>t.isDefaultChain=!1),o.isDefaultChain=!0,r=e)}else r=t;return this.options.networks=vd(Id(r)),this._wallets=this.options.networks.map(t=>{const e=new Nf({config:this.options.initialConfig,context:this.options.context},...this._signers);if(t.provider)e.setProvider(t.provider,t.chainId);else{if(!t.rpcUrl||""===t.rpcUrl)throw new Error(`network config is missing provider settings for chainId ${t.chainId}`);e.setProvider(t.rpcUrl,t.chainId)}if(bf(t.relayer))e.setRelayer(t.relayer);else{if(!gf(t.relayer))throw new Error(`network config is missing relayer settings for chainId ${t.chainId}`);e.setRelayer(new yf(vf({provider:e.provider},t.relayer)))}return t.isDefaultChain&&(this._chainId=t.chainId,this.provider=e.provider),{network:t,wallet:e}}),this.options.networks.find(t=>t.isDefaultChain).chainId}connect(t){throw new Error("connect method is not supported in MultiWallet")}signTransaction(t){throw new Error("signTransaction method is not supported in MultiWallet, please use signTransactions(...)")}}async function Of(t,e,n,r,i,o){if(function(t,e,n){try{return 0===Ph(s.utils.recoverAddress(e,s.utils.splitSignature(n)),t)}catch(t){return!1}}(t,e,n)||function(t,e,n){try{const r=s.utils.keccak256(s.utils.solidityPack(["string","bytes32"],["Ethereum Signed Message:\n32",e]));return 0===Ph(s.utils.recoverAddress(r,s.utils.splitSignature(n)),t)}catch(t){return!1}}(t,e,n))return!0;const a=await async function(t,e,n,r){if(r)try{if("0x"===await r.getCode(t))return;const i=new Kr(t,b.erc1271.abi,r),s=await i.isValidSignature(e,n);return b.erc1271.returns.isValidSignatureBytes32===s}catch(t){return!1}}(t,e,n,r);return void 0===a?!!await xf(t,e,n,i,r,o):a}async function xf(t,e,n,r,i,o){if((i||o)&&r)try{const a=o||(await i.getNetwork()).chainId,c=Wh(n),l=s.utils.arrayify(s.utils.keccak256(xl(t,a,e))),h=await Rf(l,c,i,r,o,!0),u=c.signers.reduce((t,e)=>$h(e)||qh(e)?t+e.weight:t,0);return 0===Ph(xh(h,r),t)&&u>=c.threshold}catch(t){return!1}}const Sf=async t=>{const e=await t.getAddress(),n=new Kr(e,b.mainModuleUpgradable.abi,await t.getProvider()),r=await n.functions.imageHash.call([]).catch(()=>[]);return r&&r.length>0?r[0]:""},Rf=async(t,e,n,r,i,o)=>{const a=void 0!==e.threshold?e:Wh(e),c=await Promise.all(a.signers.map(async e=>{if($h(e))return{weight:e.weight,address:zh(t,e)};if(Dh(e))return{weight:e.weight,address:s.utils.getAddress(e.address)};if(qh(e)){if(o&&!await Of(e.address,s.utils.arrayify(t),s.utils.hexlify(e.signature),n,r,i))throw Error("Invalid signature");return{weight:e.weight,address:e.address}}throw Error("Uknown signature type")}));return{threshold:a.threshold,signers:c}};function _f(){return _f=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_f.apply(this,arguments)}const Pf=604800,Bf=3e7;class Uf{constructor(t,e,n,r,i,s,o,a,c){var l;this.sequenceApiUrl=t,this.sequenceMetadataUrl=e,this.networks=n,this.config=r,this.context=i,this.account=s,this.metadata=o,this.authProvider=a,this._initialAuthRequest=void 0,this._jwt=void 0,this.proofStrings=new Map,this.onAuthCallbacks=[],this.apiClient=void 0,this.metadataClient=void 0,this.indexerClients=new Map,c&&(this._jwt={token:Promise.resolve(c.token),expiration:null!=(l=c.expiration)?l:Mf(c.token)})}get name(){return this.metadata.name}get expiration(){return this.metadata.expiration?Math.max(this.metadata.expiration,120):Pf}onAuth(t){this.onAuthCallbacks.push(t)}setAccount(t){this.account=t}setConfig(t){this.config=t}async auth(t=5){const e=this.sequenceApiUrl;if(!e)throw Error("No sequence api url");let n;for(let e=0;;e++)try{n=(await this.getJWT(!0)).token;break}catch(n){if(e===t-1)throw console.error(`couldn't authenticate after ${t} attempts`,n),n}return new R(e,n)}get isTestnetMode(){if(this.networks&&0!==this.networks.length)return!!this.networks[0].testnet}async getAPIClient(t=!0){if(!this.apiClient){const e=this.sequenceApiUrl;if(!e)throw Error("No chaind url");const n=(await this.getJWT(t)).token;this.apiClient=new R(e,n)}return this.apiClient}getMetadataClient(){return this.metadataClient||(this.metadataClient=new Su(this.sequenceMetadataUrl)),this.metadataClient}async getIndexerClient(t){const e=((t,e)=>{if("string"==typeof e){if(e.startsWith("0x")){const n=s.BigNumber.from(e).toNumber();return t.find(t=>t.chainId===n)}return t.find(t=>t.name===e)}return"number"==typeof e?t.find(t=>t.chainId===e):e.chainId?t.find(t=>t.chainId===e.chainId):void 0})(this.networks,t);if(!e)throw Error(`No network for chain ${t}`);if(!this.indexerClients.has(e.chainId))if(e.indexer)this.indexerClients.set(e.chainId,e.indexer);else{if(!e.indexerUrl)throw Error(`No indexer url for chain ${t}`);this.indexerClients.set(e.chainId,new yu(e.indexerUrl))}return this.indexerClients.get(e.chainId)}async getJWT(t){var e=this;const n=this.sequenceApiUrl;if(!n)throw Error("No chaind url");if(this._jwt){const t=this._jwt,e=await t.token;if(this.now()<t.expiration)return{token:e,expiration:t.expiration};this._jwt=void 0}if(!t)throw new Error("no auth token in memory");const r=this.getProofStringKey(),{proofString:i,expiration:s}=this.getProofString(r),o={token:i.then(async function(t){const i=new R(n),s=await i.getAuthToken({ewtString:t,testnetMode:e.isTestnetMode});if(!0===(null==s?void 0:s.status)&&0!==s.jwtToken.length)return s.jwtToken;throw await e.isProofStringValid(t)||e.proofStrings.delete(r),new Error("no auth token from server")}).catch(t=>{throw this._jwt=void 0,t}),expiration:s};return this._jwt=o,o.token.then(()=>{this.onAuthCallbacks.forEach(t=>{try{t({status:"fulfilled",value:void 0})}catch(t){}})}).catch(t=>{this.onAuthCallbacks.forEach(e=>{try{e({status:"rejected",reason:t})}catch(t){}})}),{token:await o.token,expiration:s}}getProofString(t){if(this.proofStrings.has(t)){const e=this.proofStrings.get(t);if(this.now()<e.expiration)return e;this.proofStrings.delete(t)}const e=new bi({address:this.account.address});e.claims.app=this.name,"object"==typeof window&&(e.claims.ogn=window.location.origin),e.setExpiryIn(this.expiration);const n=new Ti,r=new Fh(this.authProvider),i=this.account.authWallet(),s=this.now()+this.expiration-60,o={proofString:r.findCurrentConfig({address:i.wallet.address,provider:this.authProvider,context:i.wallet.context,knownConfigs:[i.wallet.config]}).then(t=>{if(!t.config)throw Error("Can't find latest config");return i.wallet.useConfig(t.config).sign(e.messageDigest()).then(t=>{const r=Wh(t),i=r.signers.filter(Gh).reduce((t,e)=>t+e.weight,0);if(i<r.threshold)throw Error(`insufficient signing power, need ${r.threshold}, have ${i}`);return e.signature=t,n.encodeProof(e,!0)})}).catch(e=>{throw this.proofStrings.delete(t),e}),expiration:s};return this.proofStrings.set(t,o),o}getProofStringKey(){return`${this.account.address} - ${this.name}`}async isProofStringValid(t){try{const e=new Ti;return e.provider=this.authProvider,await e.decodeProof(t),!0}catch(t){return!1}}async dump(){let t;if(this._jwt)try{const e=this._jwt.expiration;t={token:await this._jwt.token,expiration:e}}catch(t){}return{config:this.config,context:this.context,metadata:this.metadata,jwt:t}}now(){return Math.floor((new Date).getTime()/1e3)}static async open(t){const{sequenceApiUrl:e,sequenceMetadataUrl:n,context:r,networks:i,referenceSigner:s,signers:o,threshold:a,deepSearch:c,knownConfigs:l,noIndex:h,metadata:u}=t,d=Lf(i),f=t.configFinder?t.configFinder:new Fh(d),p=Promise.all(o.map(async function(t){return _f({},t,{address:"string"==typeof t.signer?t.signer:await t.signer.getAddress()})})),g=o.filter(t=>"string"!=typeof t.signer).map(t=>t.signer),m=(await f.findLastWalletOfInitialSigner({signer:s,context:r,provider:d,requireIndex:!c})).wallet;if(m){const t=(await f.findCurrentConfig({address:m,provider:d,context:r,knownConfigs:l})).config;if(!t)throw Error("Wallet config not found");const s=new Tf({initialConfig:t,networks:i,context:r},...g),o=new Uf(e,n,i,t,r,s,u,d),[c]=await s.updateConfig(Bh(t,{threshold:a,set:await p}),!h);return o.setConfig(c),o.setAccount(new Tf({initialConfig:c,networks:i,context:r},...g)),o._initialAuthRequest=e?o.auth():Promise.reject("no sequence api url"),o}{const t=Uh(a,await p),o=new Tf({initialConfig:t,networks:i,context:r},...g);await o.publishConfig(!h,[s]);const c=new Uf(e,n,i,t,r,o,u,d);return c._initialAuthRequest=e?c.auth():Promise.reject("no sequence api url"),c}}static load(t){const{sequenceApiUrl:e,sequenceMetadataUrl:n,dump:r,signers:i,networks:s}=t;return new Uf(e,n,s,r.config,r.context,new Tf({initialConfig:r.config,context:r.context,networks:s},...i),r.metadata,Lf(s),r.jwt)}}function Lf(t){var e;const n=(t=>t.find(t=>t.isAuthChain))(t);if(!n)throw Error("Auth chain not found");return null!=(e=n.provider)?e:new zu(n.rpcUrl,{chainId:n.chainId,blockCache:!0})}function Mf(t){return Pl(t).exp}const Ff=async(t,e)=>{const n=await t.getChainId(),r=s.utils.getAddress(await t.getAddress());if(!r||""===r||"0x"===r)throw Gf;const i=new bi;if(i.address=r,!e||!e.app||""===e.app)throw new Df("authorization options requires app to be set");i.claims.app=e.app,i.claims.ogn=e.origin,i.setExpiryIn(e.expiry?Math.max(e.expiry,200):Pf);const o=i.messageTypedData();i.signature=await t.signTypedData(o.domain,o.types,o.message,n);const a=new Ti;return{typedData:o,proofString:await a.encodeProof(i,!0)}};class Df extends Error{constructor(t){super(t),this.name="AuthError"}}const Gf=new Df("auth error: account address is empty"),$f=async(t,e,n)=>{if(!t||void 0===t||void 0===e)return{isValid:!1};const r=n.messageDigest(),i=await t.getCode(n.address);if("0x"===i||i.length<=2)throw new Error("ValidateSequenceDeployedWalletProof failed. unable to fetch wallet contract code");const o=new Kr(n.address,["function isValidSignature(bytes32, bytes) public view returns (bytes4)"],t);return await o.isValidSignature(r,s.utils.arrayify(n.signature))===Ai?{isValid:!0}:{isValid:!1}},Vf=t=>async(e,n,r)=>{if(!e||void 0===e||void 0===n)return{isValid:!1};if(0!==s.utils.arrayify(await e.getCode(r.address)).length)return{isValid:!1};const i=r.messageDigest(),o=s.utils.arrayify(s.utils.keccak256(i));return{isValid:!!await xf(r.address,o,r.signature,t||Gu,e,n)}};function qf(){return qf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qf.apply(this,arguments)}function jf(t){return t&&void 0!==t.chainId&&void 0!==t.name&&void 0!==t.rpcUrl&&void 0!==t.relayer}const Wf=t=>"number"==typeof t?t:t.chainId?t.chainId:s.BigNumber.from(t).toNumber(),Hf=t=>{if(t)return Wf(t)},Kf=t=>t.find(t=>t.isAuthChain),zf=(t,e=!1,n=!1)=>{if(!t)throw new Error("invalid network config: empty config");const r=[];if(Array.isArray(t)?r.push(...t):r.push(t),0===r.length){if(e)throw new Error("invalid network config: empty config");return!1}const i=r.map(t=>t.chainId).sort(),s=i.filter((t,e)=>i.indexOf(t)!==e);if(s.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}r.forEach(t=>t.name=t.name.toLowerCase());const o=r.map(t=>t.name).sort(),a=o.filter((t,e)=>o.indexOf(t)!==e);if(a.length>0){if(e)throw new Error(`invalid network config: duplicate network names ${a}`);return!1}let c=!1,l=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&e)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(e)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l){if(e)throw new Error("invalid network config: AuthChain must be set");return!1}return!0},Jf=(t,e=!1)=>(zf(t,!0,e),t),Yf=(t,e=!0)=>{const n=t.map(t=>t.chainId).sort(),r=n.filter((t,e)=>n.indexOf(t)!==e);if(r.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${r}`);return!1}return!0},Zf=(t,e)=>{if(t&&e){if(!t.chainId&&!t.name)throw new Error("failed to update network config: source config is missing chainId or name");if(t.chainId!==e.chainId&&t.name!==e.name)throw new Error("failed to update network config: one of chainId or name must match");t.rpcUrl&&(e.rpcUrl=t.rpcUrl,e.provider=void 0),t.provider&&(e.provider=t.provider),t.relayer&&(e.relayer=t.relayer)}},Xf=t=>Jf(np(t)),Qf=(t,e)=>{if("string"==typeof e){if(e.startsWith("0x")){const n=s.BigNumber.from(e).toNumber();return t.find(t=>t.chainId===n)}return t.find(t=>t.name===e)}return"number"==typeof e?t.find(t=>t.chainId===e):e.chainId?t.find(t=>t.chainId===e.chainId):void 0},tp=(t,e)=>!!t&&(t.name===e||t.chainId===e),ep=t=>{const e={};for(let n=0;n<t.length;n++)e[t[n].name]=t[n];return e},np=t=>{if(!t)return[];const e=t.sort((t,e)=>t.chainId===e.chainId?0:t.chainId<e.chainId?-1:1),n=e.findIndex(t=>t.isDefaultChain);n>0&&e.splice(0,0,e.splice(n,1)[0]);const r=e.findIndex(t=>t.isAuthChain&&!0!==t.isDefaultChain);return r>0&&e.splice(1,0,e.splice(r,1)[0]),e},rp=(t,e)=>"string"==typeof t?(e=e||{},t.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,function(t,n){let r=e[n];return r="function"==typeof r?r():null==r?"":"object"==typeof r||"symbol"==typeof r?r.toString():r.valueOf(),r})):"";let ip;!function(t){t[t.MAINNET=1]="MAINNET",t[t.ROPSTEN=3]="ROPSTEN",t[t.RINKEBY=4]="RINKEBY",t[t.GOERLI=5]="GOERLI",t[t.KOVAN=42]="KOVAN",t[t.POLYGON=137]="POLYGON",t[t.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",t[t.POLYGON_ZKEVM=1101]="POLYGON_ZKEVM",t[t.BSC=56]="BSC",t[t.BSC_TESTNET=97]="BSC_TESTNET",t[t.OPTIMISM=10]="OPTIMISM",t[t.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",t[t.ARBITRUM=42161]="ARBITRUM",t[t.ARBITRUM_GOERLI=421613]="ARBITRUM_GOERLI",t[t.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",t[t.AVALANCHE=43114]="AVALANCHE",t[t.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",t[t.FANTOM=250]="FANTOM",t[t.FANTOM_TESTNET=4002]="FANTOM_TESTNET",t[t.GNOSIS=100]="GNOSIS",t[t.AURORA=1313161554]="AURORA",t[t.AURORA_TESTNET=1313161556]="AURORA_TESTNET",t[t.BASE_GOERLI=84531]="BASE_GOERLI"}(ip||(ip={}));const sp=t=>rp("https://${network}-indexer.sequence.app",{network:t}),op=t=>rp("https://${network}-relayer.sequence.app",{network:t}),ap=t=>rp("https://nodes.sequence.app/${network}",{network:t}),cp={[ip.MAINNET]:{chainId:ip.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ip.ROPSTEN]:{chainId:ip.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ip.RINKEBY]:{chainId:ip.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",disabled:!0},[ip.GOERLI]:{chainId:ip.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[ip.KOVAN]:{chainId:ip.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[ip.POLYGON]:{chainId:ip.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[ip.POLYGON_MUMBAI]:{chainId:ip.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[ip.POLYGON_ZKEVM]:{chainId:ip.POLYGON_ZKEVM,name:"polygon-zkevm",title:"Polygon zkEVM",blockExplorer:{name:"Polygonscan (zkEVM)",rootUrl:"https://zkevm.polygonscan.com/"}},[ip.BSC]:{chainId:ip.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[ip.BSC_TESTNET]:{chainId:ip.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[ip.OPTIMISM]:{chainId:ip.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[ip.OPTIMISM_TESTNET]:{chainId:ip.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[ip.ARBITRUM]:{chainId:ip.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[ip.ARBITRUM_GOERLI]:{chainId:ip.ARBITRUM_GOERLI,name:"arbitrum-goerli",title:"Arbitrum Goerli",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[ip.ARBITRUM_NOVA]:{chainId:ip.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[ip.AVALANCHE]:{chainId:ip.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[ip.AVALANCHE_TESTNET]:{chainId:ip.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[ip.FANTOM]:{chainId:ip.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[ip.FANTOM_TESTNET]:{chainId:ip.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[ip.GNOSIS]:{chainId:ip.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[ip.AURORA]:{chainId:ip.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[ip.AURORA_TESTNET]:{chainId:ip.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}},[ip.BASE_GOERLI]:{chainId:ip.BASE_GOERLI,name:"base-goerli",title:"Base Goerli",blockExplorer:{name:"Base Goerli Explorer",rootUrl:"https://goerli.basescan.org/"}}},lp=Xf([qf({},cp[ip.MAINNET],{rpcUrl:ap("mainnet"),relayer:{url:op("mainnet")},indexerUrl:sp("mainnet")}),qf({},cp[ip.POLYGON],{rpcUrl:ap("polygon"),relayer:{url:op("polygon")},indexerUrl:sp("polygon"),isDefaultChain:!0,isAuthChain:!0}),qf({},cp[ip.BSC],{rpcUrl:ap("bsc"),indexerUrl:sp("bsc"),relayer:{url:op("bsc")}}),qf({},cp[ip.AVALANCHE],{rpcUrl:ap("avalanche"),indexerUrl:sp("avalanche"),relayer:{url:op("avalanche")}}),qf({},cp[ip.ARBITRUM],{rpcUrl:ap("arbitrum"),indexerUrl:sp("arbitrum"),relayer:{url:op("arbitrum")}}),qf({},cp[ip.ARBITRUM_NOVA],{rpcUrl:ap("arbitrum-nova"),indexerUrl:sp("arbitrum-nova"),relayer:{url:op("arbitrum-nova")}}),qf({},cp[ip.OPTIMISM],{rpcUrl:ap("optimism"),indexerUrl:sp("optimism"),relayer:{url:op("optimism")}}),qf({},cp[ip.POLYGON_ZKEVM],{rpcUrl:ap("polygon-zkevm"),indexerUrl:sp("polygon-zkevm"),relayer:{url:op("polygon-zkevm")}}),qf({},cp[ip.GNOSIS],{rpcUrl:ap("gnosis"),indexerUrl:sp("gnosis"),relayer:{url:op("gnosis")}})]),hp=Xf([qf({},cp[ip.RINKEBY],{rpcUrl:ap("rinkeby"),relayer:{url:op("rinkeby")},indexerUrl:sp("rinkeby")}),qf({},cp[ip.GOERLI],{rpcUrl:ap("goerli"),relayer:{url:op("goerli")},indexerUrl:sp("goerli")}),qf({},cp[ip.POLYGON_MUMBAI],{rpcUrl:ap("mumbai"),relayer:{url:op("mumbai")},indexerUrl:sp("mumbai"),isDefaultChain:!0,isAuthChain:!0}),qf({},cp[ip.BSC_TESTNET],{rpcUrl:ap("bsc-testnet"),relayer:{url:op("bsc-testnet")},indexerUrl:sp("bsc-testnet")}),qf({},cp[ip.ARBITRUM_GOERLI],{rpcUrl:ap("arbitrum-goerli"),relayer:{url:op("arbitrum-goerli")},indexerUrl:sp("arbitrum-goerli")}),qf({},cp[ip.BASE_GOERLI],{rpcUrl:ap("base-goerli"),relayer:{url:op("base-goerli")},indexerUrl:sp("base-goerli")})]),up={factory:"0xf9D09D634Fb818b05149329C1dcCFAeA53639d96",mainModule:"0xd01F11855bCcb95f88D7A48492F66410d4637313",mainModuleUpgradable:"0x7EFE6cE415956c5f80C6530cC6cc81b4808F6118",guestModule:"0x02390F3E6E5FD1C6786CB78FD3027C117a9955A7",sequenceUtils:"0xd130B43062D875a4B7aF3f8fc036Bc6e9D3E1B3E",libs:{requireFreshSigner:"0xE6B9B21C077F382333220a072e4c44280b873907"}},dp="2.0";class fp{constructor(t,e){this.sender=void 0,this.handler=void 0,this.sender=e,t&&this.setMiddleware(t)}setMiddleware(t){this.handler=pp(t,this.sender.sendAsync)}sendAsync(t,e,n){try{this.handler(t,e,n)}catch(t){e(t,void 0)}}}const pp=(t,e)=>{if(0===t.length)return e;const n=t=>t.sendAsyncMiddleware?t.sendAsyncMiddleware:t;let r;r=n(t[t.length-1])(e);for(let e=t.length-2;e>=0;e--)r=n(t[e])(r);return r};function gp(t){return void 0!==t&&void 0!==t.send&&void 0!==t.constructor.defaultUrl&&void 0!==t.detectNetwork&&void 0!==t.getSigner&&void 0!==t.perform}function mp(t){return void 0!==t&&void 0!==t.sendAsync}let yp=0;class wp{constructor(t,e){this.send=void 0,this.request=void 0,this.defaultChainId=void 0,this.sendAsync=(t,e,n)=>{this.send(t.method,t.params,n||this.defaultChainId).then(n=>{e(void 0,{jsonrpc:"2.0",id:t.id,result:n})}).catch(t=>{e(t,void 0)})},this.defaultChainId=e,gp(t)?this.send=t.send.bind(t):mp(t)?this.send=(e,n,r)=>new Promise((i,s)=>{t.sendAsync({jsonrpc:dp,id:++yp,method:e,params:n},(t,e)=>{t?s(t):i(e?e.result:void 0)},r||this.defaultChainId)}):this.send=t,this.request=(t,e)=>this.send(t.method,t.params,e)}}class bp{constructor(t){this.provider=t,this.sendAsync=(t,e)=>{this.provider.send(t.method,t.params).then(n=>{e(void 0,{jsonrpc:"2.0",id:t.id,result:n})}).catch(t=>{e(t,void 0)})},this.send=this.sendAsync}}class vp{constructor(t){this.sendAsyncMiddleware=void 0,this.isAllowedFunc=void 0,this.isAllowedFunc=t||(t=>!0),this.sendAsyncMiddleware=Ep(this.isAllowedFunc)}setIsAllowedFunc(t){this.isAllowedFunc=t,this.sendAsyncMiddleware=Ep(this.isAllowedFunc)}}const Ep=t=>e=>(n,r,i)=>{if(!t(n))throw new Error("allowProvider middleware precondition is unmet.");e(n,r,i)};class Ip{constructor(t){this.cachableJsonRpcMethods=["net_version","eth_chainId","eth_accounts","sequence_getWalletContext","sequence_getNetworks"],this.cachableJsonRpcMethodsByBlock=["eth_call","eth_getCode"],this.cache=void 0,this.cacheByBlock=void 0,this.cacheByBlockResetLock=!1,this.onUpdateCallback=void 0,this.defaultChainId=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method)){const t=this.cacheKey(e.method,e.params,r||this.defaultChainId),i=this.getCacheValue(t);if(i&&""!==i)return void n(void 0,{jsonrpc:"2.0",id:e.id,result:i})}t(e,(t,r,i)=>{if((this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method))&&r&&r.result&&this.shouldCacheResponse(e,r)){const t=this.cacheKey(e.method,e.params,i||this.defaultChainId);this.cachableJsonRpcMethods.includes(e.method)?this.setCacheValue(t,r.result):this.setCacheByBlockValue(t,r.result)}n(t,r)},r||this.defaultChainId)},this.cacheKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.getCache=()=>this.cache,this.setCache=t=>{this.cache=t,this.onUpdateCallback&&this.onUpdateCallback()},this.getCacheValue=t=>this.cache[t]?this.cache[t]:this.cacheByBlock[t]?this.cacheByBlock[t]:void 0,this.setCacheValue=(t,e)=>{this.cache[t]=e,this.onUpdateCallback&&this.onUpdateCallback(t,e)},this.setCacheByBlockValue=(t,e)=>{this.cacheByBlock[t]=e,this.cacheByBlockResetLock||(this.cacheByBlockResetLock=!0,setTimeout(()=>{this.cacheByBlockResetLock=!1,this.cacheByBlock={}},1500))},this.shouldCacheResponse=(t,e)=>!(!e||!e.result||"eth_getCode"===t.method&&e.result.length<=2),this.clearCache=()=>{this.cache={},this.cacheByBlock={}},this.cache={},this.cacheByBlock={},this.defaultChainId=null==t?void 0:t.defaultChainId,null!=t&&t.blockCache?!0!==(null==t?void 0:t.blockCache)&&(this.cachableJsonRpcMethodsByBlock=null==t?void 0:t.blockCache):this.cachableJsonRpcMethodsByBlock=[]}onUpdate(t){this.onUpdateCallback=t}}class Ap{constructor(t){this.options=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{const{id:i,method:o}=e;switch(o){case"net_version":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:`${this.options.chainId}`});break;case"eth_chainId":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:s.utils.hexlify(this.options.chainId)});break;case"eth_accounts":if(this.options.accountAddress)return void n(void 0,{jsonrpc:"2.0",id:i,result:[s.utils.getAddress(this.options.accountAddress)]});break;case"sequence_getWalletContext":if(this.options.walletContext)return void n(void 0,{jsonrpc:"2.0",id:i,result:this.options.walletContext})}t(e,n,r)},this.options=t}}const kp=t=>(e,n,r)=>{t(e,(t,e)=>{if(!t&&e&&e.error)throw"string"==typeof e.error?new Error(e.error):new Error(e.error.message);n(t,e)},r)},Cp=t=>(e,n,r)=>{const i=r?` chainId:${r}`:"";Ml.info(`[provider request]${i} id:${e.id} method:${e.method} params:`,e.params),t(e,(t,r)=>{t?Ml.warn(`[provider response]${i} id:${e.id} method:${e.method} params:`,e.params,"error:",t):Ml.info(`[provider response]${i} id:${e.id} method:${e.method} params:`,e.params,"response:",r),n(t,r)},r)},Np=t=>e=>(n,r,i)=>{const o=t(n),{id:a,method:c}=n;switch(c){case"net_version":return void r(void 0,{jsonrpc:"2.0",id:a,result:`${o}`});case"eth_chainId":return void r(void 0,{jsonrpc:"2.0",id:a,result:s.utils.hexlify(o)})}e(n,r,i)},Tp=["personal_sign","eth_sign","eth_signTypedData","eth_signTypedData_v4","eth_sendTransaction","eth_sendRawTransaction","sequence_getWalletContext","sequence_getWalletConfig","sequence_getWalletState","sequence_getNetworks","sequence_updateConfig","sequence_publishConfig","sequence_gasRefundOptions","sequence_getNonce","sequence_relay","eth_decrypt","eth_getEncryptionPublicKey","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];class Op{constructor(t){this.provider=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{Tp.includes(e.method)?this.provider.sendAsync(e,n,r):t(e,n,r)},this.provider=t}}class xp{constructor(t){this.privateJsonRpcMethods=["net_version","eth_chainId","eth_accounts",...Tp],this.provider=void 0,this.rpcUrl=void 0,this.sendAsyncMiddleware=t=>(e,n)=>{!this.provider||this.privateJsonRpcMethods.includes(e.method)?(Ml.debug("[public-provider] sending request to signer window",e.method),t(e,n)):this.provider.send(e.method,e.params).then(t=>{n(void 0,{jsonrpc:"2.0",id:e.id,result:t})}).catch(t=>n(t))},t&&this.setRpcUrl(t)}getRpcUrl(){return this.rpcUrl}setRpcUrl(t){t&&""!==t?(this.rpcUrl=t,this.provider=new o.providers.JsonRpcProvider(t)):(this.rpcUrl=void 0,this.provider=void 0)}}class Sp{constructor(){this.singleflightJsonRpcMethods=["eth_chainId","net_version","eth_call","eth_getCode","eth_blockNumber","eth_getBalance","eth_getStorageAt","eth_getTransactionCount","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getBlockByHash","eth_getBlockByNumber","eth_getTransactionByHash","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getLogs"],this.inflight=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(!this.singleflightJsonRpcMethods.includes(e.method))return void t(e,n,r);const i=this.requestKey(e.method,e.params||[],r);this.inflight[i]?this.inflight[i].push({id:e.id,callback:n}):(this.inflight[i]=[],t(e,(t,e,r)=>{n(t,e);for(let n=0;n<this.inflight[i].length;n++){const r=this.inflight[i][n];t?r.callback(t,e):e&&r.callback(void 0,{jsonrpc:"2.0",id:r.id,result:e.result})}delete this.inflight[i]},r))},this.requestKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.inflight={}}}class Rp extends s.providers.JsonRpcProvider{constructor(t,e){super(t,null==e?void 0:e.chainId),this._chainId=void 0,this._sender=void 0,this.send=(t,e)=>this._sender.send(t,e),this.fetch=(t,e)=>{const n={method:t,params:e,id:this._nextId++,jsonrpc:"2.0"};return s.utils.fetchJson(this.connection,JSON.stringify(n),_p).then(t=>t,t=>{throw t})};const n=null==e?void 0:e.chainId,r=null==e?void 0:e.middlewares,i=null==e?void 0:e.blockCache;this._chainId=n;const o=new fp(null!=r?r:[new Ap({chainId:n}),new Sp,new Ip({defaultChainId:n,blockCache:i})],new wp(this.fetch,n));this._sender=new wp(o,n)}async getNetwork(){const t=this._chainId;if(t){const e=cp[t];return{name:(null==e?void 0:e.name)||"",chainId:t,ensAddress:null==e?void 0:e.ensAddress}}{const t=await this.send("eth_chainId",[]);return this._chainId=s.BigNumber.from(t).toNumber(),this.getNetwork()}}}function _p(t){if(t.error){const e=new Error(t.error.message);throw e.code=t.error.code,e.data=t.error.data,e}return t.result}var Pp=n(39902);function Bp(){return Bp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bp.apply(this,arguments)}const Up=t=>{if(t)return(t=>"number"==typeof t?t:t.chainId?t.chainId:s.BigNumber.from(t).toNumber())(t)},Lp=(t,e=!1)=>(((t,e=!1,n=!1)=>{if(!t)throw new Error("invalid network config: empty config");const r=[];if(Array.isArray(t)?r.push(...t):r.push(t),0===r.length){if(e)throw new Error("invalid network config: empty config");return!1}const i=r.map(t=>t.chainId).sort(),s=i.filter((t,e)=>i.indexOf(t)!==e);if(s.length>0){if(e)throw new Error(`invalid network config: duplicate chainIds ${s}`);return!1}r.forEach(t=>t.name=t.name.toLowerCase());const o=r.map(t=>t.name).sort(),a=o.filter((t,e)=>o.indexOf(t)!==e);if(a.length>0){if(e)throw new Error(`invalid network config: duplicate network names ${a}`);return!1}let c=!1,l=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!(i.rpcUrl&&""!==i.rpcUrl||i.provider)){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: rpcUrl or provider must be provided`);return!1}if(!n&&!i.relayer){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: relayer must be provided`);return!1}if(i.isDefaultChain){if(c){if(e)throw new Error(`invalid network config for chainId ${i.chainId}: DefaultChain is already set by another config`);return!1}c=!0}if(i.isAuthChain){if(l&&e)throw new Error(`invalid network config for chainId ${i.chainId}: AuthChain is already set by another config`);l=!0}}if(!c){if(e)throw new Error("invalid network config: DefaultChain must be set");return!1}if(!l){if(e)throw new Error("invalid network config: AuthChain must be set")}})(t,!0,e),t),Mp=t=>Lp(Dp(t)),Fp=(t,e)=>{if("string"==typeof e){if(e.startsWith("0x")){const n=s.BigNumber.from(e).toNumber();return t.find(t=>t.chainId===n)}return t.find(t=>t.name===e)}return"number"==typeof e?t.find(t=>t.chainId===e):e.chainId?t.find(t=>t.chainId===e.chainId):void 0},Dp=t=>{if(!t)return[];const e=t.sort((t,e)=>t.chainId===e.chainId?0:t.chainId<e.chainId?-1:1),n=e.findIndex(t=>t.isDefaultChain);n>0&&e.splice(0,0,e.splice(n,1)[0]);const r=e.findIndex(t=>t.isAuthChain&&!0!==t.isDefaultChain);return r>0&&e.splice(1,0,e.splice(r,1)[0]),e},Gp=(t,e)=>"string"==typeof t?(e=e||{},t.replace(/\$\{\s*([$#@\-\d\w]+)\s*\}/gim,function(t,n){let r=e[n];return r="function"==typeof r?r():null==r?"":"object"==typeof r||"symbol"==typeof r?r.toString():r.valueOf(),r})):"";let $p;!function(t){t[t.MAINNET=1]="MAINNET",t[t.ROPSTEN=3]="ROPSTEN",t[t.RINKEBY=4]="RINKEBY",t[t.GOERLI=5]="GOERLI",t[t.KOVAN=42]="KOVAN",t[t.POLYGON=137]="POLYGON",t[t.POLYGON_MUMBAI=80001]="POLYGON_MUMBAI",t[t.POLYGON_ZKEVM=1101]="POLYGON_ZKEVM",t[t.BSC=56]="BSC",t[t.BSC_TESTNET=97]="BSC_TESTNET",t[t.OPTIMISM=10]="OPTIMISM",t[t.OPTIMISM_TESTNET=69]="OPTIMISM_TESTNET",t[t.ARBITRUM=42161]="ARBITRUM",t[t.ARBITRUM_GOERLI=421613]="ARBITRUM_GOERLI",t[t.ARBITRUM_NOVA=42170]="ARBITRUM_NOVA",t[t.AVALANCHE=43114]="AVALANCHE",t[t.AVALANCHE_TESTNET=43113]="AVALANCHE_TESTNET",t[t.FANTOM=250]="FANTOM",t[t.FANTOM_TESTNET=4002]="FANTOM_TESTNET",t[t.GNOSIS=100]="GNOSIS",t[t.AURORA=1313161554]="AURORA",t[t.AURORA_TESTNET=1313161556]="AURORA_TESTNET",t[t.BASE_GOERLI=84531]="BASE_GOERLI"}($p||($p={}));const Vp=t=>Gp("https://${network}-indexer.sequence.app",{network:t}),qp=t=>Gp("https://${network}-relayer.sequence.app",{network:t}),jp=t=>Gp("https://nodes.sequence.app/${network}",{network:t}),Wp={[$p.MAINNET]:{chainId:$p.MAINNET,name:"mainnet",title:"Ethereum",blockExplorer:{name:"Etherscan",rootUrl:"https://etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[$p.ROPSTEN]:{chainId:$p.ROPSTEN,name:"ropsten",title:"Ropsten",testnet:!0,blockExplorer:{name:"Etherscan (Ropsten)",rootUrl:"https://ropsten.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[$p.RINKEBY]:{chainId:$p.RINKEBY,name:"rinkeby",title:"Rinkeby",testnet:!0,blockExplorer:{name:"Etherscan (Rinkeby)",rootUrl:"https://rinkeby.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",disabled:!0},[$p.GOERLI]:{chainId:$p.GOERLI,name:"goerli",title:"Goerli",testnet:!0,blockExplorer:{name:"Etherscan (Goerli)",rootUrl:"https://goerli.etherscan.io/"},ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},[$p.KOVAN]:{chainId:$p.KOVAN,name:"kovan",title:"Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Kovan)",rootUrl:"https://kovan.etherscan.io/"}},[$p.POLYGON]:{chainId:$p.POLYGON,name:"polygon",title:"Polygon",blockExplorer:{name:"Polygonscan",rootUrl:"https://polygonscan.com/"}},[$p.POLYGON_MUMBAI]:{chainId:$p.POLYGON_MUMBAI,name:"mumbai",title:"Polygon Mumbai",testnet:!0,blockExplorer:{name:"Polygonscan (Mumbai)",rootUrl:"https://mumbai.polygonscan.com/"}},[$p.POLYGON_ZKEVM]:{chainId:$p.POLYGON_ZKEVM,name:"polygon-zkevm",title:"Polygon zkEVM",blockExplorer:{name:"Polygonscan (zkEVM)",rootUrl:"https://zkevm.polygonscan.com/"}},[$p.BSC]:{chainId:$p.BSC,name:"bsc",title:"BNB Smart Chain",blockExplorer:{name:"BSCScan",rootUrl:"https://bscscan.com/"}},[$p.BSC_TESTNET]:{chainId:$p.BSC_TESTNET,name:"bsc-testnet",title:"BNB Smart Chain Testnet",testnet:!0,blockExplorer:{name:"BSCScan (Testnet)",rootUrl:"https://testnet.bscscan.com/"}},[$p.OPTIMISM]:{chainId:$p.OPTIMISM,name:"optimism",title:"Optimism",blockExplorer:{name:"Etherscan (Optimism)",rootUrl:"https://optimistic.etherscan.io/"}},[$p.OPTIMISM_TESTNET]:{chainId:$p.OPTIMISM_TESTNET,name:"optimism-testnet",title:"Optimistic Kovan",testnet:!0,blockExplorer:{name:"Etherscan (Optimism Testnet)",rootUrl:"https://kovan-optimistic.etherscan.io/"}},[$p.ARBITRUM]:{chainId:$p.ARBITRUM,name:"arbitrum",title:"Arbitrum One",blockExplorer:{name:"Arbiscan",rootUrl:"https://arbiscan.io/"}},[$p.ARBITRUM_GOERLI]:{chainId:$p.ARBITRUM_GOERLI,name:"arbitrum-goerli",title:"Arbitrum Goerli",testnet:!0,blockExplorer:{name:"Arbiscan (Testnet)",rootUrl:"https://testnet.arbiscan.io/"}},[$p.ARBITRUM_NOVA]:{chainId:$p.ARBITRUM_NOVA,name:"arbitrum-nova",title:"Arbitrum Nova",blockExplorer:{name:"Nova Explorer",rootUrl:"https://nova-explorer.arbitrum.io/"}},[$p.AVALANCHE]:{chainId:$p.AVALANCHE,name:"avalanche",title:"Avalanche",blockExplorer:{name:"Snowtrace",rootUrl:"https://snowtrace.io/"}},[$p.AVALANCHE_TESTNET]:{chainId:$p.AVALANCHE_TESTNET,name:"avalanche-testnet",title:"Avalanche Testnet",testnet:!0,blockExplorer:{name:"Snowtrace (Testnet)",rootUrl:"https://testnet.snowtrace.io/"}},[$p.FANTOM]:{chainId:$p.FANTOM,name:"fantom",title:"Fantom",blockExplorer:{name:"FTMScan",rootUrl:"https://ftmscan.com/"}},[$p.FANTOM_TESTNET]:{chainId:$p.FANTOM_TESTNET,name:"fantom-testnet",title:"Fantom Testnet",testnet:!0,blockExplorer:{name:"FTMScan (Testnet)",rootUrl:"https://testnet.ftmscan.com/"}},[$p.GNOSIS]:{chainId:$p.GNOSIS,name:"gnosis",title:"Gnosis Chain",blockExplorer:{name:"Gnosis Chain Explorer",rootUrl:"https://blockscout.com/xdai/mainnet/"}},[$p.AURORA]:{chainId:$p.AURORA,name:"aurora",title:"Aurora",blockExplorer:{name:"Aurora Explorer",rootUrl:"https://aurorascan.dev/"}},[$p.AURORA_TESTNET]:{chainId:$p.AURORA_TESTNET,name:"aurora-testnet",title:"Aurora Testnet",blockExplorer:{name:"Aurora Explorer (Testnet)",rootUrl:"https://testnet.aurorascan.dev/"}},[$p.BASE_GOERLI]:{chainId:$p.BASE_GOERLI,name:"base-goerli",title:"Base Goerli",blockExplorer:{name:"Base Goerli Explorer",rootUrl:"https://goerli.basescan.org/"}}};Mp([Bp({},Wp[$p.MAINNET],{rpcUrl:jp("mainnet"),relayer:{url:qp("mainnet")},indexerUrl:Vp("mainnet")}),Bp({},Wp[$p.POLYGON],{rpcUrl:jp("polygon"),relayer:{url:qp("polygon")},indexerUrl:Vp("polygon"),isDefaultChain:!0,isAuthChain:!0}),Bp({},Wp[$p.BSC],{rpcUrl:jp("bsc"),indexerUrl:Vp("bsc"),relayer:{url:qp("bsc")}}),Bp({},Wp[$p.AVALANCHE],{rpcUrl:jp("avalanche"),indexerUrl:Vp("avalanche"),relayer:{url:qp("avalanche")}}),Bp({},Wp[$p.ARBITRUM],{rpcUrl:jp("arbitrum"),indexerUrl:Vp("arbitrum"),relayer:{url:qp("arbitrum")}}),Bp({},Wp[$p.ARBITRUM_NOVA],{rpcUrl:jp("arbitrum-nova"),indexerUrl:Vp("arbitrum-nova"),relayer:{url:qp("arbitrum-nova")}}),Bp({},Wp[$p.OPTIMISM],{rpcUrl:jp("optimism"),indexerUrl:Vp("optimism"),relayer:{url:qp("optimism")}}),Bp({},Wp[$p.POLYGON_ZKEVM],{rpcUrl:jp("polygon-zkevm"),indexerUrl:Vp("polygon-zkevm"),relayer:{url:qp("polygon-zkevm")}}),Bp({},Wp[$p.GNOSIS],{rpcUrl:jp("gnosis"),indexerUrl:Vp("gnosis"),relayer:{url:qp("gnosis")}})]),Mp([Bp({},Wp[$p.RINKEBY],{rpcUrl:jp("rinkeby"),relayer:{url:qp("rinkeby")},indexerUrl:Vp("rinkeby")}),Bp({},Wp[$p.GOERLI],{rpcUrl:jp("goerli"),relayer:{url:qp("goerli")},indexerUrl:Vp("goerli")}),Bp({},Wp[$p.POLYGON_MUMBAI],{rpcUrl:jp("mumbai"),relayer:{url:qp("mumbai")},indexerUrl:Vp("mumbai"),isDefaultChain:!0,isAuthChain:!0}),Bp({},Wp[$p.BSC_TESTNET],{rpcUrl:jp("bsc-testnet"),relayer:{url:qp("bsc-testnet")},indexerUrl:Vp("bsc-testnet")}),Bp({},Wp[$p.ARBITRUM_GOERLI],{rpcUrl:jp("arbitrum-goerli"),relayer:{url:qp("arbitrum-goerli")},indexerUrl:Vp("arbitrum-goerli")}),Bp({},Wp[$p.BASE_GOERLI],{rpcUrl:jp("base-goerli"),relayer:{url:qp("base-goerli")},indexerUrl:Vp("base-goerli")})]);class Hp{constructor(t,e){this.sender=void 0,this.handler=void 0,this.sender=e,t&&this.setMiddleware(t)}setMiddleware(t){this.handler=Kp(t,this.sender.sendAsync)}sendAsync(t,e,n){try{this.handler(t,e,n)}catch(t){e(t,void 0)}}}const Kp=(t,e)=>{if(0===t.length)return e;const n=t=>t.sendAsyncMiddleware?t.sendAsyncMiddleware:t;let r;r=n(t[t.length-1])(e);for(let e=t.length-2;e>=0;e--)r=n(t[e])(r);return r};let zp=0;class Jp{constructor(t,e){var n;this.send=void 0,this.request=void 0,this.defaultChainId=void 0,this.sendAsync=(t,e,n)=>{this.send(t.method,t.params,n||this.defaultChainId).then(n=>{e(void 0,{jsonrpc:"2.0",id:t.id,result:n})}).catch(t=>{e(t,void 0)})},this.defaultChainId=e,void 0!==(n=t)&&void 0!==n.send&&void 0!==n.constructor.defaultUrl&&void 0!==n.detectNetwork&&void 0!==n.getSigner&&void 0!==n.perform?this.send=t.send.bind(t):function(t){return void 0!==t&&void 0!==t.sendAsync}(t)?this.send=(e,n,r)=>new Promise((i,s)=>{t.sendAsync({jsonrpc:"2.0",id:++zp,method:e,params:n},(t,e)=>{t?s(t):i(e?e.result:void 0)},r||this.defaultChainId)}):this.send=t,this.request=(t,e)=>this.send(t.method,t.params,e)}}class Yp{constructor(t){this.cachableJsonRpcMethods=["net_version","eth_chainId","eth_accounts","sequence_getWalletContext","sequence_getNetworks"],this.cachableJsonRpcMethodsByBlock=["eth_call","eth_getCode"],this.cache=void 0,this.cacheByBlock=void 0,this.cacheByBlockResetLock=!1,this.onUpdateCallback=void 0,this.defaultChainId=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{if(this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method)){const t=this.cacheKey(e.method,e.params,r||this.defaultChainId),i=this.getCacheValue(t);if(i&&""!==i)return void n(void 0,{jsonrpc:"2.0",id:e.id,result:i})}t(e,(t,r,i)=>{if((this.cachableJsonRpcMethods.includes(e.method)||this.cachableJsonRpcMethodsByBlock.includes(e.method))&&r&&r.result&&this.shouldCacheResponse(e,r)){const t=this.cacheKey(e.method,e.params,i||this.defaultChainId);this.cachableJsonRpcMethods.includes(e.method)?this.setCacheValue(t,r.result):this.setCacheByBlockValue(t,r.result)}n(t,r)},r||this.defaultChainId)},this.cacheKey=(t,e,n)=>{let r="";return r=n?`${n}:${t}:`:`:${t}:`,e&&0!==e.length?r+JSON.stringify(e):r+"[]"},this.getCache=()=>this.cache,this.setCache=t=>{this.cache=t,this.onUpdateCallback&&this.onUpdateCallback()},this.getCacheValue=t=>this.cache[t]?this.cache[t]:this.cacheByBlock[t]?this.cacheByBlock[t]:void 0,this.setCacheValue=(t,e)=>{this.cache[t]=e,this.onUpdateCallback&&this.onUpdateCallback(t,e)},this.setCacheByBlockValue=(t,e)=>{this.cacheByBlock[t]=e,this.cacheByBlockResetLock||(this.cacheByBlockResetLock=!0,setTimeout(()=>{this.cacheByBlockResetLock=!1,this.cacheByBlock={}},1500))},this.shouldCacheResponse=(t,e)=>!(!e||!e.result||"eth_getCode"===t.method&&e.result.length<=2),this.clearCache=()=>{this.cache={},this.cacheByBlock={}},this.cache={},this.cacheByBlock={},this.defaultChainId=null==t?void 0:t.defaultChainId,null!=t&&t.blockCache?!0!==(null==t?void 0:t.blockCache)&&(this.cachableJsonRpcMethodsByBlock=null==t?void 0:t.blockCache):this.cachableJsonRpcMethodsByBlock=[]}onUpdate(t){this.onUpdateCallback=t}}class Zp{constructor(t){this.options=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{const{id:i,method:o}=e;switch(o){case"net_version":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:`${this.options.chainId}`});break;case"eth_chainId":if(this.options.chainId)return void n(void 0,{jsonrpc:"2.0",id:i,result:s.utils.hexlify(this.options.chainId)});break;case"eth_accounts":if(this.options.accountAddress)return void n(void 0,{jsonrpc:"2.0",id:i,result:[s.utils.getAddress(this.options.accountAddress)]});break;case"sequence_getWalletContext":if(this.options.walletContext)return void n(void 0,{jsonrpc:"2.0",id:i,result:this.options.walletContext})}t(e,n,r)},this.options=t}}const Xp=t=>(e,n,r)=>{t(e,(t,e)=>{if(!t&&e&&e.error)throw"string"==typeof e.error?new Error(e.error):new Error(e.error.message);n(t,e)},r)},Qp=t=>(e,n,r)=>{const i=r?` chainId:${r}`:"";Ml.info(`[provider request]${i} id:${e.id} method:${e.method} params:`,e.params),t(e,(t,r)=>{t?Ml.warn(`[provider response]${i} id:${e.id} method:${e.method} params:`,e.params,"error:",t):Ml.info(`[provider response]${i} id:${e.id} method:${e.method} params:`,e.params,"response:",r),n(t,r)},r)},tg=["personal_sign","eth_sign","eth_signTypedData","eth_signTypedData_v4","eth_sendTransaction","eth_sendRawTransaction","sequence_getWalletContext","sequence_getWalletConfig","sequence_getWalletState","sequence_getNetworks","sequence_updateConfig","sequence_publishConfig","sequence_gasRefundOptions","sequence_getNonce","sequence_relay","eth_decrypt","eth_getEncryptionPublicKey","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];class eg{constructor(t){this.provider=void 0,this.sendAsyncMiddleware=t=>(e,n,r)=>{tg.includes(e.method)?this.provider.sendAsync(e,n,r):t(e,n,r)},this.provider=t}}function ng(){return ng=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ng.apply(this,arguments)}s.providers.JsonRpcProvider;class rg extends URLSearchParams{static new(t){return new URLSearchParams(t)}}let ig,sg,og;!function(t){t.OPEN="open",t.CLOSE="close",t.MESSAGE="message",t.CONNECT="connect",t.DISCONNECT="disconnect",t.ACCOUNTS_CHANGED="accountsChanged",t.CHAIN_CHANGED="chainChanged",t.NETWORKS="networks",t.WALLET_CONTEXT="walletContext",t.INIT="init",t.DEBUG="_debug"}(ig||(ig={})),function(t){t[t.CLOSED=0]="CLOSED",t[t.OPENING=1]="OPENING",t[t.OPENED=2]="OPENED"}(sg||(sg={})),function(t){t[t.NIL=0]="NIL",t[t.SENT_NONCE=1]="SENT_NONCE",t[t.OK=2]="OK"}(og||(og={}));class ag extends Error{constructor(t){super(t),this.name="ProviderError"}}const cg=new ag("Wallet is not signed in. Connect a wallet and try again."),lg=3e4;let hg=0;const ug=()=>++hg;class dg{constructor(){var t=this;this.pendingMessageRequests=[],this.responseCallbacks=new Map,this.state=void 0,this.confirmationOnly=!1,this.events=new Pp.EventEmitter2,this.openPayload=void 0,this.connectPayload=void 0,this.accountsChangedPayload=void 0,this.networksPayload=void 0,this.walletContextPayload=void 0,this._sessionId=void 0,this._init=void 0,this._registered=void 0,this.sendAsync=async function(e,n,r){t.state===sg.CLOSED&&(t.confirmationOnly=!0),t.openWallet(void 0,{type:"jsonRpcRequest",method:e.method},r);try{t.isOpened()||await t.waitUntilOpened(),n(void 0,(await t.sendMessageRequest({idx:ug(),type:ig.MESSAGE,data:e,chainId:r})).data)}catch(t){n(t)}},this.sendMessageRequest=async function(e){return new Promise((n,r)=>{(!e.idx||e.idx<=0)&&"init"!==e.type&&r(new Error("message idx not set"));const i=e.idx;t.responseCallbacks.get(i)?r(new Error("duplicate message idx, should never happen")):t.responseCallbacks.set(i,(t,e)=>{if(t)r(t);else{if(!e)throw new Error("no valid response to return");n(e)}}),t.isOpened()?t.sendMessage(e):(Ml.debug("pushing to pending requests",e),t.pendingMessageRequests.push(e))})},this.waitUntilOpened=async function(e=lg){let n=!1;return Promise.race([new Promise((r,i)=>{const s=setTimeout(()=>{clearTimeout(s),n||(t.state=sg.CLOSED,t.events.emit("close",{code:1005,message:"opening wallet timed out"})),i(new Error("opening wallet timed out"))},e)}),new Promise(e=>{var r;if(t.isOpened())return n=!0,void e(null==(r=t.openPayload)?void 0:r.session);t.events.once("open",r=>{t.openPayload=r,n=!0,e(r.session)})})])},this.waitUntilConnected=async function(){await t.waitUntilOpened();const e=new Promise(e=>{t.connectPayload?e(t.connectPayload):t.events.once("connect",n=>{t.connectPayload=n,e(n)})}),n=new Promise((e,n)=>{t.events.once("close",t=>{n(t?new Error(`wallet closed due to ${JSON.stringify(t)}`):new Error("user closed the wallet"))})});return Promise.race([e,n])},this.state=sg.CLOSED,this._registered=!1,this._init=og.NIL}get registered(){return this._registered}register(){throw new Error("abstract method")}unregister(){throw new Error("abstract method")}openWallet(t,e,n){throw new Error("abstract method")}closeWallet(){throw new Error("abstract method")}isOpened(){return this.registered&&this.state===sg.OPENED}isConnected(){var t;const e=null==(t=this.openPayload)?void 0:t.session;return this.registered&&void 0!==e&&!!e.accountAddress&&42===e.accountAddress.length&&!!e.networks&&e.networks.length>0}handleMessage(t){var e=this;if(t.type===ig.INIT){Ml.debug("MessageProvider, received INIT message",t);const{nonce:e}=t.data;if(!e||0==e.length)return void Ml.error("invalid init nonce");this._init=og.OK,this.sendMessage({idx:-1,type:ig.INIT,data:{sessionId:this._sessionId,nonce:e}})}if(this._init!==og.OK)return;Ml.debug("RECEIVED MESSAGE FROM WALLET",t.idx,t);const n=t.idx,r=this.responseCallbacks.get(n);if(n&&this.responseCallbacks.delete(n),t.type!==ig.OPEN||this.isOpened()){if(t.type===ig.MESSAGE){if(this.confirmationOnly&&setTimeout(()=>{0===this.responseCallbacks.size&&this.closeWallet()},500),!r)throw new Error("impossible state");if(r)return this.events.emit("message",t),void r(t.data.error,t)}if(t.type===ig.ACCOUNTS_CHANGED)return this.accountsChangedPayload={accounts:[]},void(t.data&&t.data.length>0?(this.accountsChangedPayload={accounts:[s.utils.getAddress(t.data[0])],origin:t.origin},this.events.emit("accountsChanged",this.accountsChangedPayload.accounts,this.accountsChangedPayload.origin)):this.events.emit("accountsChanged",[],t.origin));if(t.type!==ig.CHAIN_CHANGED){if(t.type===ig.NETWORKS)return this.networksPayload=t.data,void this.events.emit("networks",this.networksPayload);if(t.type===ig.WALLET_CONTEXT)return this.walletContextPayload=t.data,void this.events.emit("walletContext",this.walletContextPayload);t.type===ig.CLOSE&&this.state!==sg.CLOSED&&this.close(t.data),t.type===ig.CONNECT&&(this.connectPayload=t.data,this.events.emit("connect",this.connectPayload)),t.type===ig.DISCONNECT&&this.isConnected()&&(this.events.emit("disconnect",t.data),this.close())}else this.events.emit("chainChanged",t.data)}else{var i,o;if(this._sessionId&&this._sessionId!==(null==(i=t.data)?void 0:i.sessionId))return void Ml.debug("open event received from wallet, but does not match sessionId",this._sessionId);if(null!=(o=t.data)&&o.error){var a;const e=new Error(`opening wallet failed: received ${null==(a=t.data)?void 0:a.error}`);throw Ml.error(e),this.close(),e}this.state=sg.OPENED,this.openPayload=t.data,this.events.emit("open",this.openPayload),0!==this.pendingMessageRequests.length&&this.pendingMessageRequests.splice(0,this.pendingMessageRequests.length).forEach(async function(t){e.sendMessage(t)})}}sendMessage(t){throw new Error("abstract method")}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}emit(t,...e){return this.events.emit(t,...e)}close(t){this.state!==sg.CLOSED&&(this.state=sg.CLOSED,this.confirmationOnly=!1,this._sessionId=void 0,Ml.info("closing wallet and flushing!"),this.pendingMessageRequests.length=0,this.responseCallbacks.forEach(t=>{t(ng({},new Error("wallet closed"),{code:4001}))}),this.responseCallbacks.clear(),this.connectPayload=void 0,this.openPayload=void 0,this.accountsChangedPayload=void 0,this.networksPayload=void 0,this.walletContextPayload=void 0,this.events.emit("close",t))}}class fg{constructor(t,e,n,r=[]){var i=this;this.signer=void 0,this.signerReadyCallbacks=[],this.prompter=void 0,this.mainnetNetworks=void 0,this.testnetNetworks=void 0,this._openIntent=void 0,this._connectOptions=void 0,this._defaultNetworkId=void 0,this._chainId=void 0,this.events=new Pp.EventEmitter2,this.onConnectOptionsChange=void 0,this.promptConnect=async function(t){if(!t&&!i._connectOptions)throw new Error("prompter connect options are empty");if(!i.prompter)return i.connect(t);const e=await i.prompter.promptConnect(t||i._connectOptions).catch(t=>({connected:!1})),n=e;return n.connected&&!n.session&&(n.session=await i.walletSession()),e},this.sendAsync=async function(t,e,n){const r={jsonrpc:"2.0",id:t.id,result:null};await i.getSigner();try{if(!(i.signer&&null!==i.signer||pg.includes(t.method)))throw cg;const e=i.signer;if(!e)throw new Error("WalletRequestHandler: wallet signer is not configured");const a=await e.getProvider(n);if(!a)throw new Error(`WalletRequestHandler: wallet provider is not configured for chainId ${n}`);switch(t.method){case"net_version":{const t=await a.send("net_version",[]);r.result=t;break}case"eth_chainId":{const t=await a.send("eth_chainId",[]);r.result=t;break}case"eth_accounts":{const t=await e.getAddress();r.result=[t];break}case"eth_getBalance":{const[e,n]=t.params,i=await a.getBalance(e,n);r.result=i.toHexString();break}case"personal_sign":case"eth_sign":{let s;if("personal_sign"===t.method){const[e,n]=t.params;s=e}else{const[e,n]=t.params;s=n}let o="";const a=Tg(s);if(null===i.prompter?o=await e.signMessage(a,n):await i.handleConfirmWalletDeployPrompt(i.prompter,e,n)&&(o=await i.prompter.promptSignMessage({chainId:n,message:a},i.connectOptions)),!(o&&o.length>0))throw new Error("declined by user");r.result=o;break}case"eth_signTypedData":case"eth_signTypedData_v4":{const[s,o]=t.params;let a;if("string"==typeof o)try{a=JSON.parse(o)}catch(t){}else a=o;if(!(a&&a.domain&&a.types&&a.message))throw new Error("invalid typedData object");let c="";if(null===i.prompter?c=await e.signTypedData(a.domain,a.types,a.message,n):await i.handleConfirmWalletDeployPrompt(i.prompter,e,n)&&(c=await i.prompter.promptSignMessage({chainId:n,typedData:a},i.connectOptions)),!(c&&c.length>0))throw new Error("declined by user");r.result=c;break}case"eth_sendTransaction":{const[s]=t.params;"gas"in s&&void 0===s.gasLimit&&(s.gasLimit=s.gas,delete s.gas);let o="";if(o=null===i.prompter?(await e.sendTransaction(s,n)).hash:await i.prompter.promptSendTransaction(s,n,i.connectOptions),!o)throw new Error("declined by user");r.result=o;break}case"eth_signTransaction":{const[o]=t.params;if(s.utils.getAddress(o.from)!==await e.getAddress())throw new Error("sender address does not match wallet");null===i.prompter?r.result=await e.signTransactions(o,n):r.result=await i.prompter.promptSignTransaction(o,n,i.connectOptions);break}case"eth_sendRawTransaction":if(md(t.params[0])){const n=o.BigNumber.from(t.params[0].chainId).toNumber(),i=await(await e.getRelayer(n)).relay(t.params[0]);r.result=(await i).hash}else{const e=await a.sendTransaction(t.params[0]);r.result=e.hash}break;case"eth_getTransactionCount":{const n=s.utils.getAddress(t.params[0]),i=t.params[1];if(n===s.utils.getAddress(await e.getAddress())){const t=await e.getTransactionCount(i);r.result=s.BigNumber.from(t).toHexString()}else{const t=await a.getTransactionCount(n,i);r.result=s.BigNumber.from(t).toHexString()}break}case"eth_blockNumber":r.result=await a.getBlockNumber();break;case"eth_getBlockByNumber":case"eth_getBlockByHash":r.result=await a.getBlock(t.params[0]);break;case"eth_getTransactionByHash":r.result=await a.getTransaction(t.params[0]);break;case"eth_call":{const[e,n]=t.params;r.result=await a.call(e,n);break}case"eth_getCode":{const[e,n]=t.params;r.result=await a.getCode(e,n);break}case"eth_estimateGas":{const[e]=t.params;r.result=await a.estimateGas(e);break}case"eth_gasPrice":{const t=await a.getGasPrice();r.result=t.toHexString();break}case"wallet_switchEthereumChain":{const[e]=t.params;if(!e.chainId||0===e.chainId.length)throw new Error("invalid chainId");const n=s.BigNumber.from(e.chainId);if(!await i.setDefaultNetwork(n.toString(),!0))throw new Error(`unable to set chainId ${n}`);r.result=null;break}case"sequence_getWalletContext":r.result=await e.getWalletContext();break;case"sequence_getWalletConfig":{const[n]=t.params;r.result=await e.getWalletConfig(n);break}case"sequence_getWalletState":{const[n]=t.params;r.result=await e.getWalletState(n);break}case"sequence_getNetworks":r.result=await i.getNetworks(!0);break;case"sequence_isSequence":r.result=!0;break;case"sequence_updateConfig":throw new Error("sequence_updateConfig method is not allowed from a dapp");case"sequence_publishConfig":throw new Error("sequence_publishConfig method is not allowed from a dapp");case"sequence_gasRefundOptions":case"sequence_getNonce":case"sequence_relay":break;case"sequence_setDefaultNetwork":{const[e]=t.params;if(!e)throw new Error("invalid request, method argument defaultNetworkId cannot be empty");if(!await i.setDefaultNetwork(e))throw new Error(`unable to set default network ${e}`);r.result=await i.getNetworks(!0);break}default:{const e=await a.send(t.method,t.params);r.result=e}}}catch(t){Ml.error(t),r.result=null,r.error=ng({},new Error(t),{code:4001})}e(void 0,r)},this.isSignedIn=async function(){return await i.signerReady(),!!i.signer},this.getSigner=async function(){if(await i.signerReady(),void 0===i.signer)throw new Error("signerReady failed resolve");return i.signer},this.signer=t,this.prompter=e,this.mainnetNetworks=n,this.testnetNetworks=r}async signIn(t,e={}){this.setSigner(t);const{connect:n,mainnetNetworks:r,testnetNetworks:i,defaultNetworkId:s}=e;if(r&&r.length>0&&(this.mainnetNetworks=r),i&&i.length>0&&(this.testnetNetworks=i),!(this.mainnetNetworks&&0!==this.mainnetNetworks.length||this.testnetNetworks&&0!==this.testnetNetworks.length))throw new Error("signIn failed as network configuration is empty");const o=s||this._defaultNetworkId;if(o&&!await this.setDefaultNetwork(o,!1))throw new Error(`WalletRequestHandler setup unable to set defaultNetworkId ${o}`);if(n){const t=this._connectOptions;let e;var a;e=null!==this.prompter?await(null==(a=this.prompter)?void 0:a.promptSignInConnect(t)):await this.connect(t),this.notifyConnect(e),t&&!0===t.keepWalletOpened||this.notifyClose()}}signOut(){this.setSigner(null)}signerReset(){this.signer=void 0}signerReady(t=1e4){return new Promise((e,n)=>{void 0!==this.signer?e():(setTimeout(()=>{void 0===this.signer&&(this.signerReadyCallbacks=[],n("signerReady timed out"))},t),this.signerReadyCallbacks.push(e))})}async connect(t){if(!this.signer)return{connected:!1,chainId:"0x0",error:"unable to connect without signed in account"};const e={connected:!0,chainId:s.utils.hexlify(await this.getChainId())};if(t&&t.authorize){const n={app:t.app,origin:t.origin,expiry:t.expiry};try{e.proof=await Ff(this.signer,n)}catch(e){return Ml.warn(`connect, signAuthorization failed for options: ${JSON.stringify(t)}, due to: ${e.message}`),{connected:!1,chainId:"0x0",error:`signAuthorization failed: ${e.message}`}}}return e.session=await this.walletSession(),e}sendMessageRequest(t){return new Promise(e=>{this.sendAsync(t.data,(n,r)=>{const i=ng({},t,{data:r});e(i)},t.chainId)})}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}async getAddress(){return this.signer?this.signer.getAddress():""}async getChainId(){return this.signer?(this._chainId||(this._chainId=await this.signer.getChainId()),this._chainId):0}get openIntent(){return this._openIntent}setOpenIntent(t){this._openIntent=t}get connectOptions(){return this._connectOptions}setConnectOptions(t){var e;this._connectOptions=t,null==(e=this.onConnectOptionsChange)||e.call(this,t)}get defaultNetworkId(){return this._defaultNetworkId}async setDefaultNetwork(t,e=!0){if(t&&(this._defaultNetworkId=t,this._chainId=void 0,this.signer&&this.signer.setNetworks)){const n=this.signer.setNetworks(this.mainnetNetworks,this.testnetNetworks,t);return n&&e&&await this.notifyNetworks(),n}}async getNetworks(t){if(!this.signer)return Ml.warn("signer not set: getNetworks is returning an empty list"),[];const e=await this.signer.getNetworks();return t?e.map(t=>{const e=ng({},t);return e.provider=void 0,e.relayer=void 0,e}):e}async walletSession(){return this.signer?{walletContext:await this.signer.getWalletContext(),accountAddress:await this.signer.getAddress(),networks:await this.getNetworks(!0)}:void 0}notifyConnect(t,e){var n,r;this.events.emit("connect",t),null!=(n=t.session)&&n.accountAddress&&this.events.emit("accountsChanged",[null==(r=t.session)?void 0:r.accountAddress],e)}notifyDisconnect(t){this.events.emit("accountsChanged",[],t),this.events.emit("disconnect")}async notifyNetworks(t){const e=t||await this.getNetworks(!0);if(this.events.emit("networks",e),e.length>0){const t=e.find(t=>t.isDefaultChain);t&&this.events.emit("chainChanged",s.utils.hexlify(t.chainId))}else this.events.emit("chainChanged","0x0")}async notifyWalletContext(){if(!this.signer)return void Ml.warn("signer not set: skipping to notify wallet context");const t=await this.signer.getWalletContext();this.events.emit("walletContext",t)}notifyClose(t){this.events.emit("close",t)}setSigner(t){if(this.signer=t,void 0!==t){for(let t=0;t<this.signerReadyCallbacks.length;t++)this.signerReadyCallbacks[t]();this.signerReadyCallbacks=[]}}async handleConfirmWalletDeployPrompt(t,e,n){return!n||(!!await Bg(e,n)||!!await t.promptConfirmWalletDeploy(n,this.connectOptions)&&(!!await Bg(e,n)||(Ml.error("WalletRequestHandler: result for promptConfirmWalletDeploy is not correct"),!1)))}}const pg=["net_version","eth_chainId","eth_getBalance","eth_getTransactionCount","eth_blockNumber","eth_getBlockByNumber","eth_getBlockByHash","eth_getTransactionByHash","eth_getCode","eth_estimateGas","eth_gasPrice","sequence_getWalletContext","sequence_getNetworks","sequence_setDefaultNetwork"];class gg extends o.providers.Web3Provider{static isSequenceProvider(t){return mg(t)}constructor(t,e){const n=new Jp(t,Up(e));super(t=n,"any"),this._sender=void 0,this._isSequenceProvider=void 0,this._defaultChainId=void 0,this._sender=n,this._isSequenceProvider=!0,this._defaultChainId=Up(e)}sendAsync(t,e,n){this._sender.sendAsync(t,e,n)}send(t,e,n){return this._sender.send(t,e,n)}request(t){return this.send(t.method,t.params||[],t.chainId)}getSigner(){return new wg(this,this._defaultChainId)}async getChainId(){const t=await this.send("eth_chainId",[]),e=s.BigNumber.from(t).toNumber();if(this._defaultChainId&&this._defaultChainId!==e)throw new Error(`provider chainId (${e}) does not match provider-bound chainId ${this._defaultChainId}`);return e}}function mg(t){const e=t;return e&&void 0!==e.send&&!0===e._isSequenceProvider}class yg extends gg{constructor(t,e){super(new fg(t,null,e||[]))}}class wg extends Ef{constructor(t,e){super(),this.provider=void 0,this.defaultChainId=void 0,this._address=void 0,this._index=void 0,this._context=void 0,this._networks=void 0,this._providers={},this.provider=t,this.defaultChainId=e}async getAddress(){if(this._address)return this._address;const t=await this.provider.send("eth_accounts",[]);return this._address=t[0],this._index=0,s.utils.getAddress(this._address)}signTransaction(t){throw new Error("signTransaction is unsupported, use signTransactions instead")}connect(t){throw new Error("unsupported: cannot alter JSON-RPC Signer connection")}async getProvider(t){if(t){const e=await this.getChainId();if(e!==t)throw new Error(`signer is attempting to access chain ${t}, but is already bound to chain ${e}`)}return this.provider}async getSender(t){return!t||t&&t===this.defaultChainId?this.provider:(this._providers[t]||(this._providers[t]=new gg(new Jp(this.provider,t),t)),this._providers[t])}getRelayer(t){throw new Error("TODO")}async getWalletContext(){return this._context||(this._context=await this.provider.send("sequence_getWalletContext",[])),this._context}async getWalletConfig(t){return await this.provider.send("sequence_getWalletConfig",[Up(t)],Up(t)||this.defaultChainId)}async getWalletState(t){return await this.provider.send("sequence_getWalletState",[Up(t)],Up(t)||this.defaultChainId)}async getNetworks(){return this._networks||(this._networks=await this.provider.send("sequence_getNetworks",[])),this._networks}async getSigners(){const t=(await this.getNetworks()).find(t=>t.isAuthChain);if(!t)throw new Error("authChainId could not be determined from network list");const e=await this.getWalletConfig(t);if(!e||0===e.length)throw new Error("walletConfig returned zero results for authChainId {authChainId}");return e[0].signers.map(t=>t.address)}async signMessage(t,e,n){const r=await this.getSender(Up(e)||this.defaultChainId),i="string"==typeof t?s.utils.toUtf8Bytes(t):t,o=await this.getAddress();return await r.send("personal_sign",[s.utils.hexlify(i),o])}async signTypedData(t,e,n,r,i){return await this.provider.send("eth_signTypedData_v4",[await this.getAddress(),s.utils._TypedDataEncoder.getPayload(t,e,n)],Up(r)||this.defaultChainId)}async sendTransaction(t,e,n){const r=await this.getSender(Up(e)||this.defaultChainId);return this.sendUncheckedTransaction(t,e).then(t=>s.utils.poll(()=>r.getTransaction(t).then(e=>{if(null!==e)return r._wrapTransaction(e,t)}),{onceBlock:this.provider}).catch(e=>{throw e.transactionHash=t,e}))}async sendTransactionBatch(t,e,n){const r=await Cf(t);if(!r||0===r.length)throw new Error("cannot send empty batch");if(r.find(t=>void 0!==t.wait&&null!==t.wait))throw new Error("transaction request expected for sendTransactionBatch, transaction response found");const i=ng({},r[0]);return r.length>1&&(i.auxiliary=r.splice(1)),this.sendTransaction(i,e,n)}signTransactions(t,e,n){return t=Ql(t),this.provider.send("eth_signTransaction",[t],Up(e)||this.defaultChainId)}sendSignedTransactions(t,e){throw new Error("TODO")}async updateConfig(t){const[e,n]=await this.provider.send("sequence_updateConfig",[t],this.defaultChainId);return null===n?[e,void 0]:[e,(await this.getSender(this.defaultChainId))._wrapTransaction(n,n.hash)]}async publishConfig(){const t=await this.getSender(this.defaultChainId),e=await t.send("sequence_publishConfig",[]);if(null!==e)return t._wrapTransaction(e,e.hash)}async isDeployed(t){const e=await this.getSender(Up(t)),n=await e.getCode(await this.getAddress());return!!n&&"0x"!==n}async _legacySignMessage(t,e,n){const r=await this.getSender(Up(e)||this.defaultChainId),i="string"==typeof t?s.utils.toUtf8Bytes(t):t,o=await this.getAddress();return await r.send("eth_sign",[o,s.utils.hexlify(i)])}async _signTypedData(t,e,n,r,i){return this.signTypedData(t,e,n,r,i)}async sendUncheckedTransaction(t,e){t=Ql(t);const n=this.getAddress(),r=await this.getSender(Up(e)||this.defaultChainId);return Zl({tx:Zl(t),sender:await n}).then(({tx:e,sender:n})=>{if(null!=e.from){if(s.utils.getAddress(e.from)!==n)throw new Error(`from address mismatch for transaction ${t}`)}else e.from=n;const i=vg(e);return r.send("eth_sendTransaction",[i]).then(t=>t,t=>{throw t})})}connectUnchecked(){return new Eg(this.provider,this.defaultChainId)}async unlock(t){const e=await this.getAddress();return this.provider.send("personal_unlockAccount",[e,t,null])}}const bg={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,from:!0,auxiliary:!0,expiration:!0,afterNonce:!0,delegateCall:!0,revertOnError:!0},vg=(t,e)=>{const n=Ql(bg);if(e)for(const t in e)e[t]&&(n[t]=!0);s.utils.checkProperties(t,n);const r={};["gasLimit","gasPrice","nonce","value"].forEach(e=>{const n=t[e];if(null==n)return;const i=s.utils.hexValue(n);"gasLimit"===e&&(e="gas"),r[e]=i}),["from","to","data"].forEach(e=>{t[e]&&(r[e]=s.utils.hexlify(t[e]))}),["delegateCall","revertOnError"].forEach(e=>{const n=t[e];null!=n&&(r[e]=n)});const i=t.auxiliary;return i&&i.length>0&&(r.auxiliary=[],i.forEach(t=>{r.auxiliary.push(vg(t))})),r};class Eg extends wg{sendTransaction(t){return this.sendUncheckedTransaction(t).then(t=>({chainId:0,confirmations:0,data:"",from:"",gasLimit:s.constants.Zero,gasPrice:s.constants.Zero,hash:t,nonce:0,value:s.constants.Zero,wait:e=>this.provider.waitForTransaction(t,e)}))}}const Ig=[{name:"Decentraland Exception",predicate:function(t){try{const e=s.utils.toUtf8String(t);return Ag.test(e)}catch(t){return!1}}},{name:"0x v3 Exception",predicate:function(t){const e=new s.utils.Interface(kg);try{return e.decodeFunctionData("OrderWithHash",t),!0}catch(t){return!1}}}],Ag=/^Decentraland Login\nEphemeral address: 0x[a-fA-F0-9]{40}\nExpiration: (\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)((-(\d{2}):(\d{2})|Z)?)$/,kg=[{inputs:[{components:[{internalType:"address",name:"makerAddress",type:"address"},{internalType:"address",name:"takerAddress",type:"address"},{internalType:"address",name:"feeRecipientAddress",type:"address"},{internalType:"address",name:"senderAddress",type:"address"},{internalType:"uint256",name:"makerAssetAmount",type:"uint256"},{internalType:"uint256",name:"takerAssetAmount",type:"uint256"},{internalType:"uint256",name:"makerFee",type:"uint256"},{internalType:"uint256",name:"takerFee",type:"uint256"},{internalType:"uint256",name:"expirationTimeSeconds",type:"uint256"},{internalType:"uint256",name:"salt",type:"uint256"},{internalType:"bytes",name:"makerAssetData",type:"bytes"},{internalType:"bytes",name:"takerAssetData",type:"bytes"},{internalType:"bytes",name:"makerFeeAssetData",type:"bytes"},{internalType:"bytes",name:"takerFeeAssetData",type:"bytes"}],internalType:"struct IEIP1271Data.Order",name:"order",type:"tuple"},{internalType:"bytes32",name:"orderHash",type:"bytes32"}],name:"OrderWithHash",outputs:[],stateMutability:"pure",type:"function"}],Cg=s.utils.toUtf8Bytes("Ethereum Signed Message:\n"),Ng=t=>s.utils.isBytes(t)||s.utils.isHexString(t)?s.utils.arrayify(t):s.utils.toUtf8Bytes(t),Tg=t=>{const e=Ng(t);return function(t){return Ig.some(e=>e.predicate(t))}(e)?e:s.utils.concat([Cg,s.utils.toUtf8Bytes(String(e.length)),e])},Og=async(t,e,n,r,i,s)=>{var o;return i||(i=null==(o=await r.getNetwork())?void 0:o.chainId),!s&&gg.isSequenceProvider(r)&&(s=await r.getSigner().getWalletContext()),Of(t,e,n,r,s,i)},xg=async(t,e,n,r,i,s)=>{const o=Tg(e),a=Ol(o);return Og(t,a,n,r,i,s)},Sg=(t,e,n,r,i,s)=>Og(t,zl(e),n,r,i,s),Rg=async(t,e,n,r,i)=>{const o=xl(t,r,e),a=await(async(t,e)=>{const n=s.utils.arrayify(s.utils.keccak256(t));return Rf(n,e,void 0,void 0,void 0,void 0)})(o,n);if(i){const t=xh(a,i);if(a.address&&a.address!==t)throw new Error("recovered address does not match the WalletConfig address, check the WalletContext");a.address=t}return a},_g=()=>"chrome-extension:"===window.location.protocol||"moz-extension:"===window.location.protocol,Pg=()=>!!navigator.userAgent.match(/UnitySequence/i),Bg=async(t,e)=>{var n;const r=await t.getWalletState(),i=await t.getNetworks(),s=r.find(t=>t.chainId===e);if(!s)throw new Error(`WalletRequestHandler: could not find wallet state for chainId ${e}`);const o=s.deployed;if(!i)throw new Error("isWalletUpToDate util: could not get networks from signer");const a=i.find(t=>t.isAuthChain);if(!a)throw new Error("isWalletUpToDate util: could not get auth chain network information");const c=a.chainId,l=null==(n=r.find(t=>t.chainId===c))?void 0:n.config;if(!l)throw new Error("isWalletUpToDate util: could not get auth chain config");const h=s.config;if(!h)throw new Error(`isWalletUpToDate util: could not get config for chainId ${e}`);const u=_h(l,h);return o&&u};class Ug{constructor(){}static getInstance(){return"object"==typeof window?Ug._instance||(Ug._instance={getItem:t=>Promise.resolve(window.localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(window.localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(window.localStorage.removeItem(t))}):Ug._instance||(Ug._instance={getItem:t=>Promise.resolve(null),setItem:(t,e)=>Promise.resolve(),removeItem:t=>Promise.resolve()}),this._instance}static use(t){Ug._instance=t}}Ug._instance=void 0;class Lg{constructor(t,e){this.def=e,this.key=void 0,this.key=t}async get(){const t=await Ug.getInstance().getItem(this.key);if(null===t)return this.def;try{return JSON.parse(t)}catch(t){console.error(t)}}set(t){t?Ug.getInstance().setItem(this.key,JSON.stringify(t)):Ug.getInstance().removeItem(this.key)}del(){Ug.getInstance().removeItem(this.key)}}const Mg="@sequence.transportSession";class Fg{constructor(t){var e=this;this.walletRequestHandler=void 0,this._sessionId=void 0,this._registered=void 0,this._init=void 0,this._initNonce=void 0,this._initCallback=void 0,this.appOrigin=void 0,this.sendAsync=async function(t,e,n){throw new Error("abstract method")},this.handleMessage=async function(t){const n=t;if(e._init===og.OK)switch(n.type){case ig.OPEN:{if(e._init!==og.OK)return;const t={sessionId:n.data.sessionId,intent:n.data.intent,networkId:n.data.networkId};return void await e.open(t)}case ig.CLOSE:return e._init,void og.OK;case ig.MESSAGE:{const t=await e.walletRequestHandler.sendMessageRequest(n);return e.sendMessage(t),void t.data.error}default:Ml.error(`unexpected payload type ${n.type}`)}else if(n.type===ig.INIT){if(!e.isValidInitAck(t))return void(e._initCallback&&e._initCallback("invalid init"));e._initCallback&&e._initCallback()}},this.sendMessageRequest=async function(t){return e.walletRequestHandler.sendMessageRequest(t)},this.open=async function({sessionId:t,intent:n,networkId:r}){if(t&&(e._sessionId=ql(t),e.saveTransportSession({sessionId:t,intent:n,networkId:r})),e.walletRequestHandler.setOpenIntent(n),await e.init(),n&&"connect"===n.type&&n.options){const t=n.options,i=t;if(e.appOrigin&&null!=i&&i.origin){if(!_g()&&i.origin!==e.appOrigin)throw new Error("origin is invalid")}else!e.appOrigin&&null!=i&&i.origin?t.origin=Wl(i.origin):e.appOrigin&&(t.origin=e.appOrigin);t.app&&(t.app=jl(t.app)),e.walletRequestHandler.setConnectOptions(t),t.networkId?r=t.networkId:r&&(t.networkId=r)}else e.walletRequestHandler.setConnectOptions(void 0);if(await e.walletRequestHandler.getSigner(),!await e.walletRequestHandler.isSignedIn())return e.notifyOpen({sessionId:e._sessionId}),!0;if(n&&"connect"===n.type){let t;try{t=r?await e.walletRequestHandler.setDefaultNetwork(r,!1):await e.walletRequestHandler.getChainId()}catch(t){console.error(t)}(!t||t<=0)&&console.log("Failed to set default network on open"),e.notifyOpen({sessionId:e._sessionId});try{const t=await e.walletRequestHandler.promptConnect(n.options);t.connected&&e.walletRequestHandler.notifyConnect(t)}catch(t){Ml.warn("promptConnect not connected:",t)}finally{n.options&&!0===n.options.keepWalletOpened||e.notifyClose()}}else{let t;try{t=r?await e.walletRequestHandler.setDefaultNetwork(r,!1):await e.walletRequestHandler.getChainId()}catch(t){console.error(t)}if(!t||t<=0)return e.notifyOpen({sessionId:e._sessionId,error:`failed to open wallet on network ${r}`}),!1;e.notifyOpen({sessionId:e._sessionId,chainId:`${t}`,session:await e.walletRequestHandler.walletSession()})}return!0},this.saveTransportSession=t=>{Ug.getInstance().setItem(Mg,JSON.stringify(t))},this.getCachedTransportSession=async function(){const t=await Ug.getInstance().getItem(Mg);try{return t?JSON.parse(t):null}catch(e){return console.error(`unable to parse transport session: ${t}`),null}},this.walletRequestHandler=t,this._init=og.NIL,this.walletRequestHandler.on("connect",t=>{this.registered&&this.notifyConnect(t)}),this.walletRequestHandler.on("disconnect",t=>{this.registered&&this.notifyDisconnect(t)}),this.walletRequestHandler.on("accountsChanged",(t,e)=>{this.registered&&this.notifyAccountsChanged(t,e)}),this.walletRequestHandler.on("networks",t=>{this.registered&&(this.notifyNetworks(t),t&&0!==t.length?this.notifyChainChanged(s.utils.hexlify(t.find(t=>t.isDefaultChain).chainId)):this.notifyChainChanged("0x0"))}),this.walletRequestHandler.on("walletContext",t=>{this.registered&&t&&this.notifyWalletContext(t)}),this.walletRequestHandler.on("close",t=>{this.registered&&this.notifyClose(t)})}get registered(){return this._registered}register(){throw new Error("abstract method")}unregister(){throw new Error("abstract method")}sendMessage(t){throw new Error("abstract method")}notifyOpen(t){const{chainId:e,sessionId:n,session:r,error:i}=t;this.sendMessage({idx:-1,type:ig.OPEN,data:{chainId:e,sessionId:n,session:r,error:i}})}notifyClose(t){this.sendMessage({idx:-1,type:ig.CLOSE,data:t?{error:t}:null})}notifyConnect(t){this.sendMessage({idx:-1,type:ig.CONNECT,data:t})}notifyDisconnect(t){this.sendMessage({idx:-1,type:ig.DISCONNECT,data:t?{error:t}:null})}notifyAccountsChanged(t,e){this.sendMessage({idx:-1,type:ig.ACCOUNTS_CHANGED,data:t,origin:e})}notifyChainChanged(t){this.sendMessage({idx:-1,type:ig.CHAIN_CHANGED,data:t})}notifyNetworks(t){this.sendMessage({idx:-1,type:ig.NETWORKS,data:t})}notifyWalletContext(t){this.sendMessage({idx:-1,type:ig.WALLET_CONTEXT,data:t})}isValidInitAck(t){if(this._init===og.OK)return Ml.warn("isValidInitAck, already in init'd state, so inquiry is invalid."),!1;if(t.type!==ig.INIT)return Ml.warn("isValidInitAck, invalid message type, expecting init"),!1;const{sessionId:e,nonce:n}=t.data;return e&&0!==e.length&&n&&0!==n.length?e===this._sessionId&&n===this._initNonce||(Ml.error("invalid init ack match"),!1):(Ml.error("invalid init ack"),!1)}init(){return new Promise((t,e)=>{if(this._init===og.OK)return void t();if(this._init!==og.NIL||this._initCallback)return void e("transport init is in progress");const n=setTimeout(()=>{Ml.warn("transport init timed out"),this._initCallback&&this._initCallback("transport init timed out")},lg/2);this._initCallback=r=>{this._initCallback=void 0,clearTimeout(n),r?e(r):(this._init=og.OK,t())},this._initNonce=`${performance.now()}`,this.sendMessage({idx:-1,type:ig.INIT,data:{nonce:this._initNonce}}),this._init=og.SENT_NONCE})}}class Dg{constructor(){this.app=void 0,this.wallet=void 0;const t=new Gg,e=new Gg;t.conn=e,e.conn=t,this.app=t,this.wallet=e}}class Gg{constructor(){this.conn=void 0,this.events=new Pp.EventEmitter2,this.handleMessage=t=>{throw new Error("ProxyMessageChannelPort is not registered")},this.sendMessage=t=>{this.conn.handleMessage(t),"open"===t.type&&this.events.emit("open",t),"close"===t.type&&this.events.emit("close",t),"connect"===t.type&&this.events.emit("connect",t),"disconnect"===t.type&&this.events.emit("disconnect",t)}}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}}class $g extends dg{constructor(t){if(super(),this.port=void 0,this.register=()=>{this.port.handleMessage=t=>{this.handleMessage(t)},this.on("open",(...t)=>{this.port.events.emit("open",...t)}),this.on("close",(...t)=>{this.port.events.emit("close",...t)}),this.on("connect",(...t)=>{this.port.events.emit("connect",...t)}),this.on("disconnect",(...t)=>{this.port.events.emit("disconnect",...t)}),this._registered=!0},this.unregister=()=>{this._registered=!1,this.closeWallet(),this.events.removeAllListeners(),this.port.handleMessage=void 0},this.openWallet=(t,e,n)=>{if(this.state===sg.CLOSED){this.state=sg.OPENING;const r=`${performance.now()}`;this._sessionId=r,this.sendMessage({idx:-1,type:ig.OPEN,data:{path:t,intent:e,networkId:n,sessionId:r}})}},this.state=sg.CLOSED,this.port=t,!t)throw new Error("port argument cannot be empty");this._init=og.OK}closeWallet(){this.sendMessage({idx:-1,type:ig.CLOSE,data:null}),this.close()}sendMessage(t){if(!t.idx)throw new Error("message idx is empty");this.port.sendMessage(t)}}class Vg extends Fg{constructor(t,e){super(t),this.port=void 0,this.port=e,this._init=og.OK}register(){this.port.handleMessage=t=>{this.handleMessage(t)},this._registered=!0}async restoreSession(){const t=await this.getCachedTransportSession();t&&this.open(t)}unregister(){this.port.handleMessage=void 0,this._registered=!1}sendMessage(t){this.port.sendMessage(t)}}class qg{constructor(...t){var e=this;this.messageProviders=void 0,this.provider=void 0,this.register=()=>{if(1===this.messageProviders.length)return this.provider=this.messageProviders[0],void this.provider.register();this.messageProviders.forEach(t=>{t.register(),t.once("open",()=>{this.provider||(this.provider=t,this.messageProviders.forEach(t=>{this.provider!==t&&t.unregister()}))})})},this.unregister=()=>{this.messageProviders.forEach(t=>t.unregister()),this.provider=void 0},this.openWallet=(t,e,n)=>{this.provider?this.provider.openWallet(t,e,n):this.messageProviders.forEach(r=>r.openWallet(t,e,n))},this.sendAsync=async function(t,n,r){if(!e.provider)throw new Error("impossible state, wallet must be opened first");e.provider.sendAsync(t,n,r)},this.sendMessageRequest=async function(t){if(e.provider)return e.provider.sendMessageRequest(t);throw new Error("impossible state, wallet must be opened first")},this.waitUntilOpened=async function(){return e.provider?e.provider.waitUntilOpened():Promise.race(e.messageProviders.map(t=>t.waitUntilOpened()))},this.waitUntilConnected=async function(){if(e.provider)return e.provider.waitUntilConnected();throw new Error("impossible state, wallet must be opened first")},this.messageProviders=t,this.provider=void 0}add(...t){this.messageProviders.push(...t)}closeWallet(){this.provider&&this.provider.closeWallet()}isOpened(){return!!this.provider&&this.provider.isOpened()}isConnected(){return!!this.provider&&this.provider.isConnected()}on(t,e){this.provider?this.provider.on(t,e):this.messageProviders.forEach(n=>{n.on(t,e)})}once(t,e){this.provider?this.provider.once(t,e):this.messageProviders.forEach(n=>{n.once(t,e)})}emit(t,...e){if(this.provider)return this.provider.emit(t,...e);for(let n=0;n<this.messageProviders.length;n++)this.messageProviders[n].emit(t,...e);return!0}sendMessage(t){if(!t.idx||t.idx<=0)throw new Error("message idx is empty");if(!this.provider)throw new Error("impossible state, wallet must be opened first");this.provider.sendMessage(t)}handleMessage(t){if(!this.provider)throw new Error("impossible state, wallet must be opened first");this.provider.handleMessage(t)}}let jg;class Wg extends dg{constructor(t){super(),this.walletURL=void 0,this.walletWindow=void 0,this.register=()=>{jg&&(jg.unregister(),jg=this),window.addEventListener("message",this.onWindowEvent),jg=this,this.on("open",()=>{const t=this.walletWindow,e=setInterval(()=>{t&&t.closed&&(clearInterval(e),this.close())},500)}),this.on("close",()=>{this.walletWindow&&(this.walletWindow.close(),this.walletWindow=null)}),this._registered=!0},this.unregister=()=>{this._registered=!1,this.closeWallet(),jg===this&&(jg=void 0),window.removeEventListener("message",this.onWindowEvent),this.events.removeAllListeners()},this.openWallet=(t,e,n)=>{if(this.walletWindow&&this.isOpened())return void this.walletWindow.focus();const r=new URL(this.walletURL.href),i=new rg;let s,o;t&&""!==t&&(r.pathname=t.toLowerCase()),this._init=og.NIL,this._sessionId=`${performance.now()}`,i.set("sid",this._sessionId),e&&("connect"===e.type&&(e.options||(e.options={}),_g()||Pg()||(e.options.origin=window.location.origin)),i.set("intent",Cl(e))),n&&i.set("net",`${n}`),_g()?(s=[450,750],o=[Math.abs(window.screen.width/2-s[0]/2),Math.abs(window.screen.height/2-s[1]/2)]):(s=[450,750],o=[Math.abs(window.screenX+window.innerWidth/2-s[0]/2),Math.abs(window.screenY+window.innerHeight/2-s[1]/2)]);const a=`toolbar=0,location=0,menubar=0,scrollbars=yes,status=yes,width=${s[0]},height=${s[1]},left=${o[0]},top=${o[1]}`;r.search=i.toString(),this.walletWindow=window.open(r.href,"sequence.app",a)},this.onWindowEvent=t=>{if(t.origin!==this.walletURL.origin)return;let e;try{e=JSON.parse(t.data)}catch(t){return}if(!e)throw new Error("ProviderMessage object is empty");this.handleMessage(e)},this.walletURL=new URL(t)}closeWallet(){var t;this.close(),null==(t=this.walletWindow)||t.close()}sendMessage(t){if(!this.walletWindow)return void Ml.warn("WindowMessageProvider: sendMessage failed as walletWindow is unavailable");const e="string"!=typeof t?JSON.stringify(t):t;this.walletWindow.postMessage(e,this.walletURL.origin)}}class Hg extends Fg{constructor(t){var e;super(t),e=this,this.parentWindow=void 0,this._isPopup=!1,this.onWindowEvent=async function(t){if(!t.origin||""===t.origin)return;if(e.appOrigin&&t.origin!==e.appOrigin)return;let n;try{n=JSON.parse(t.data)}catch(t){return}Ml.debug("RECEIVED MESSAGE",n),e._init!==og.OK&&e.isValidInitAck(n)&&(e.appOrigin=t.origin),e._init!==og.OK||e.appOrigin&&!(e.appOrigin.length<8)?e.handleMessage(n):Ml.error("impossible state, init.OK and appOrigin required")},this.getWindowTransportSession=t=>{const e=new rg(t);return{sessionId:e.get("sid"),networkId:e.get("net"),intent:Tl(e.get("intent"))}},this._init=og.NIL}async register(t){const e=null!==parent.window.opener;if(this._isPopup=e,!0!==e)return;const{pathname:n,search:r}=new URL(t||window.location.href);let i=this.getWindowTransportSession(r);!!i.sessionId||(i=await this.getCachedTransportSession()),i?(this.parentWindow=parent.window.opener,window.addEventListener("message",this.onWindowEvent,!1),this._registered=!0,this.open(i).then(t=>{if(!t){var e;const t=`failed to open to network ${null==(e=i)?void 0:e.networkId}`;Ml.error(t),this.notifyClose({message:t}),window.close()}}).catch(t=>{var e;const n=`failed to open to network ${null==(e=i)?void 0:e.networkId}, due to: ${t}`;Ml.error(n),this.notifyClose({message:n}),window.close()})):Ml.error("window session is undefined")}unregister(){window.removeEventListener("message",this.onWindowEvent),this._registered=!1}sendMessage(t){const e=JSON.stringify(t);t.type===ig.INIT?this.postMessage(e,!0):this.postMessage(e)}get isPopup(){return this._isPopup}postMessage(t,e=!1){!0===e||this._init===og.OK?e?this.parentWindow.postMessage(t,"*"):this.appOrigin&&this.appOrigin.length>4?this.parentWindow.postMessage(t,this.appOrigin):Ml.error("unable to postMessage as parentOrigin is invalid"):Ml.error("impossible state, should not be calling postMessage until inited")}}const Kg="sequence-extension-message-handler";class zg extends Fg{constructor(t,e){super(t),this.runtime=e,this.port=void 0,this._init=og.OK}register(){this._registered=!0,this.port=this.runtime.connect({name:Kg})}sendMessage(t){Ml.info("[ExtensionMessageHandler send]",t),this.port.postMessage(t)}}class Jg extends dg{constructor(t){super(),this.register=()=>{this._registered=!0},t.onConnect.addListener(t=>{t.name===Kg&&(this._init=og.OK,t.onMessage.addListener(t=>{this.handleMessage(t)}))})}sendMessage(t){}unregister(){}openWallet(t,e,n){}closeWallet(){}}class Yg extends Pp.EventEmitter2{constructor(t){var e;super(),e=this,this.stream=t,this.responseCallbacks=new Map,this._messageIdx=0,this.nextMessageIdx=()=>++this._messageIdx,this.handleMessage=t=>{if(!t.type||!t.data)return;Ml.info("[received message]",t);const e=t.idx,n=this.responseCallbacks.get(e);switch(e&&this.responseCallbacks.delete(e),t.type){case ig.MESSAGE:if(!n)throw new Error("impossible state");this.emit(ig.MESSAGE,t),n(t.data.error,t);break;case ig.DISCONNECT:case ig.ACCOUNTS_CHANGED:case ig.CHAIN_CHANGED:this.emit(t.type,t.data);break;default:console.error("unknown message type",t)}},this.sendMessageRequest=async function(t){return new Promise((n,r)=>{(!t.idx||t.idx<=0)&&r(new Error("message idx not set"));const{idx:i}=t;e.responseCallbacks.get(i)?r(new Error("duplicate message idx, should never happen")):e.responseCallbacks.set(i,(t,e)=>{if(t)r(t);else{if(!e)throw new Error("no valid response to return");n(e)}}),e.sendMessage(t)})},this.stream.on("data",this.handleMessage)}sendMessage(t){this.stream.writable||console.error("window post message stream is not writable"),this.stream.write(t)}}function Zg(t){var e;if(null!=(e=window.ue)&&e.sequencewallettransport&&!window.logsOverriddenForUnreal){var n;const e=null==(n=window.ue)?void 0:n.sequencewallettransport;console.log=(...n)=>{e.logfromjs(`${t}: ${Xg(n)}`)},console.warn=(...n)=>{e.warnfromjs(`${t}: ${Xg(n)}`)},console.error=(...n)=>{e.errorfromjs(`${t}: ${Xg(n)}`)},window.logsOverriddenForUnreal=!0}}function Xg(t){return t.map(t=>"object"==typeof t?t instanceof Error?t.message:JSON.stringify(t):String(t)).join(" ")}let Qg;class tm extends dg{constructor(t){super(),this.walletURL=void 0,this.register=()=>{var t;Zg("dapp"),Qg&&(Qg.unregister(),Qg=this),null!=(t=window.ue)&&t.sequencewallettransport&&(window.ue.sequencewallettransport.onmessagefromwallet=this.onUnrealCallback),Qg=this,this._registered=!0,console.log("registering transport!")},this.unregister=()=>{var t,e;this._registered=!1,this.closeWallet(),Qg===this&&(Qg=void 0),(null==(t=window.ue)||null==(e=t.sequencewallettransport)?void 0:e.onmessagefromwallet)===this.onUnrealCallback&&delete window.ue.sequencewallettransport.onmessagefromwallet,this.events.removeAllListeners()},this.openWallet=(t,e,n)=>{if(this.isOpened())return void console.log("wallet already open!");console.log("opening wallet!");const r=new URL(this.walletURL.href),i=new rg;t&&(r.pathname=t.toLowerCase()),this._init=og.NIL,this._sessionId=`${performance.now()}`,i.set("sid",this._sessionId),e&&i.set("intent",Cl(e)),n&&i.set("net",`${n}`),r.search=i.toString(),console.log("opening wallet to",r.href),window.open(r.href)},this.onUnrealCallback=t=>{if(!t)throw new Error("ProviderMessage object is empty");this.handleMessage(t)},this.walletURL=new URL(t)}closeWallet(){this.close()}sendMessage(t){var e,n;const r="string"!=typeof t?JSON.stringify(t):t;console.log("Sending message to wallet:",r),null==(e=window.ue)||null==(n=e.sequencewallettransport)||n.sendmessagetowallet(r)}}class em extends Fg{constructor(t){super(t),this.onMessageFromUnreal=t=>{Ml.debug("RECEIVED MESSAGE",t),this.handleMessage(t)},this.getUnrealTransportSession=t=>{const e=new rg(t);return{sessionId:e.get("sid"),networkId:e.get("net"),intent:Tl(e.get("intent"))}},this._init=og.NIL}async register(t){var e;if(void 0===(null==(e=window.ue)?void 0:e.sequencewallettransport))return;Zg("wallet");const{search:n}=new URL(t||window.location.href);let r=this.getUnrealTransportSession(n);!!r.sessionId||(r=await this.getCachedTransportSession()),r?(window.ue.sequencewallettransport.onmessagefromsequencejs=this.onMessageFromUnreal,this._registered=!0,this.open(r).then(t=>{if(!t){var e;const t=`failed to open to network ${null==(e=r)?void 0:e.networkId}`;Ml.error(t),this.notifyClose({message:t}),window.close()}}).catch(t=>{var e;const n=`failed to open to network ${null==(e=r)?void 0:e.networkId}, due to: ${t}`;Ml.error(n),this.notifyClose({message:n}),window.close()})):Ml.error("unreal session is undefined")}unregister(){var t,e;(null==(t=window.ue)||null==(e=t.sequencewallettransport)?void 0:e.onmessagefromsequencejs)===this.onMessageFromUnreal&&delete window.ue.sequencewallettransport.onmessagefromsequencejs,this._registered=!1}sendMessage(t){var e,n;if(t.type!==ig.INIT&&this._init!==og.OK)return void Ml.error("impossible state, should not be calling postMessage until inited");const r=JSON.stringify(t);null==(e=window.ue)||null==(n=e.sequencewallettransport)||n.sendmessagetosequencejs(r)}}class nm{constructor(t){var e=this;this.wallet=void 0,this.recoverWalletConfig=async function(t,n,r,i,s){return s=s||await e.wallet.getWalletContext(),Rg(t,n,r,i,s)},this.recoverWalletConfigFromMessage=async function(t,n,r,i,s){return s=s||await e.wallet.getWalletContext(),Rg(t,Ol(Tg(n)),r,i,s)},this.recoverWalletConfigFromTypedData=async function(t,n,r,i,s){return s=s||await e.wallet.getWalletContext(),Rg(t,zl(n),r,i,s)},this.wallet=t}signMessage(t,e,n){const r=this.wallet.getSigner();if(!r)throw new Error("unable to get signer");return r.signMessage(t,e,n)}async signAuthMessage(t,e){const n=await this.wallet.getAuthSigner();if(!n)throw new Error("unable to get AuthChain signer");return n.signMessage(t,await n.getChainId(),e)}signTypedData(t,e,n,r,i){const s=this.wallet.getSigner();if(!s)throw new Error("unable to get signer");return s.signTypedData(t,e,n,r,i)}async signAuthTypedData(t,e,n,r){const i=await this.wallet.getAuthSigner();if(!i)throw new Error("unable to get AuthChain signer");return i.signTypedData(t,e,n,await i.getChainId(),r)}async isValidSignature(t,e,n,r,i){const s=this.wallet.getProvider(r);if(!s)throw new Error(`unable to get provider for chainId ${r}`);return Og(t,e,n,s,r,i)}async isValidMessageSignature(t,e,n,r,i){const s=this.wallet.getProvider(r);if(!s)throw new Error(`unable to get provider for chainId ${r}`);const o=Tg(e),a=Ol(o);return Og(t,a,n,s,r,i)}isValidTypedDataSignature(t,e,n,r,i){return this.isValidSignature(t,zl(e),n,r,i)}}class rm{constructor(t,e){var n=this;this.utils=void 0,this.config=void 0,this.session=void 0,this.connectedSites=void 0,this.transport=void 0,this.networks=void 0,this.providers=void 0,this.init=()=>{var t,e,n,r,i,o,a,c,l,h;this.transport.provider||(this.transport.messageProvider=new qg,null!=(t=this.config.transports)&&null!=(e=t.windowTransport)&&e.enabled&&"object"==typeof window&&(this.transport.windowMessageProvider=new Wg(this.config.walletAppURL),this.transport.messageProvider.add(this.transport.windowMessageProvider)),null!=(n=this.config.transports)&&null!=(r=n.proxyTransport)&&r.enabled&&(this.transport.proxyMessageProvider=new $g(this.config.transports.proxyTransport.appPort),this.transport.messageProvider.add(this.transport.proxyMessageProvider)),null!=(i=this.config.transports)&&null!=(o=i.extensionTransport)&&o.enabled&&(this.transport.extensionMessageProvider=new Jg(this.config.transports.extensionTransport.runtime),this.transport.messageProvider.add(this.transport.extensionMessageProvider)),null!=(a=this.config.transports)&&null!=(c=a.unrealTransport)&&c.enabled&&(this.transport.unrealMessageProvider=new tm(this.config.walletAppURL),this.transport.messageProvider.add(this.transport.unrealMessageProvider)),this.transport.messageProvider.register(),this.transport.allowProvider=(h=t=>{if("sequence_setDefaultNetwork"===t.method)return!0;const e=this.isConnected();if(!e)throw new Error("Sequence: wallet not connected");return e},t=>(e,n,r)=>{if(!h(e))throw new Error("allowProvider middleware precondition is unmet.");t(e,n,r)}),this.transport.networkProvider=(l=t=>this.networks&&0!==this.networks.length?this.networks.find(t=>t.isDefaultChain).chainId:0,t=>(e,n,r)=>{const i=l(),{id:o,method:a}=e;switch(a){case"net_version":return void n(void 0,{jsonrpc:"2.0",id:o,result:`${i}`});case"eth_chainId":return void n(void 0,{jsonrpc:"2.0",id:o,result:s.utils.hexlify(i)})}t(e,n,r)}),this.transport.cachedProvider=new Yp,this.transport.cachedProvider.onUpdate(()=>{this.session||(this.session={providerCache:{}}),this.session.providerCache=this.transport.cachedProvider.getCache(),this.saveSession(this.session)}),this.transport.router=new Hp([Qp,this.transport.networkProvider,this.transport.allowProvider,Xp,this.transport.cachedProvider],this.transport.messageProvider),this.transport.provider=new gg(this.transport.router),this.transport.messageProvider.on("open",t=>{const{session:e}=t;e?this.useSession(e,!0):(this.session&&this.session.accountAddress&&this.transport.messageProvider.emit("disconnect"),this.clearSession())}),this.transport.messageProvider.on("accountsChanged",(t,e)=>{e?t.length>0&&this.useSession({accountAddress:t[0]},!0):t&&0!==t.length&&""!==t[0]?this.useSession({accountAddress:t[0]},!0):this.clearSession()}),this.transport.messageProvider.on("networks",t=>{this.useSession({networks:t},!0)}),this.transport.messageProvider.on("walletContext",t=>{this.useSession({walletContext:t},!0)}))},this.loadSession=async function(t){const e=await Ug.getInstance().getItem("@sequence.session");if(e&&""!==e)try{const i=JSON.parse(e);if(i){if(void 0!==t){var r;const e="string"==typeof t?parseInt(t):t,n=n=>n.name===t||n.chainId===e,s=null==(r=i.networks)?void 0:r.find(n),o=null==s?void 0:s.isDefaultChain;if(i.networks&&s&&!o){const t=i.networks.map(t=>ng({},t,{isDefaultChain:n(t)}));i.networks=Dp(t),i.providerCache=void 0}}n.useSession(i,!0)}return i}catch(t){return void Ml.warn("loadSession failed, unable to parse session payload from storage.")}},this.connect=async function(t){if(!0===(null==t?void 0:t.refresh)&&n.disconnect(),n.isConnected()&&await n.isSiteConnected(null==t?void 0:t.origin)&&n.session&&(null==t||!t.authorize)&&(null==t||!t.askForEmail))return{connected:!0,session:n.session,chainId:s.utils.hexlify(await n.getChainId())};if(t&&t.authorize&&(!t.app||""===t.app))throw new Error("connecting with 'authorize' option also requires 'app' to be set");await n.openWallet(void 0,{type:"connect",options:t});const e=await n.transport.messageProvider.waitUntilConnected().catch(t=>t instanceof Error?{connected:!1,error:t.message}:{connected:!1,error:JSON.stringify(t)});if(e.connected){if(!e.session)throw new Error("impossible state, connect response is missing session");n.useSession(e.session,!0),n.addConnectedSite(null==t?void 0:t.origin)}return e},this.authorize=async function(t){return n.connect(ng({},t,{authorize:!0}))},this.getSession=()=>{if(this.isConnected())return this.session},this.getAddress=async function(){if(!n.isConnected())throw new Error("connect first");return n.getSession().accountAddress},this.getNetworks=async function(t){if(!n.isConnected()||!n.networks)throw new Error("connect first");if(t){const e=Fp(n.networks,t);return e?[e]:[]}return n.networks},this.getChainId=async function(){if(!n.networks||n.networks.length<1)throw new Error("networks have not been set by session. connect first.");const t=n.networks.find(t=>t.isDefaultChain);if(!t)throw new Error("networks must have a default chain specified");return t.chainId},this.getAuthChainId=async function(){if(!n.networks||n.networks.length<1)throw new Error("networks have not been set by session. connect first.");const t=n.networks.find(t=>t.isAuthChain);if(!t)throw new Error("networks must have an auth chain specified");return t.chainId},this.openWallet=async function(t,e,r){if("connect"!==(null==e?void 0:e.type)&&!n.isConnected())throw new Error("connect first");let i;return i=!n.networks||n.networks.length<1?n.config.defaultNetworkId:await n.getChainId(),n.transport.messageProvider.openWallet(t,e,r||i),await n.transport.messageProvider.waitUntilOpened(),!0},this.closeWallet=()=>{this.transport.messageProvider.closeWallet()},this.unregister=()=>{var t;this.disconnect(),null==(t=this.transport.messageProvider)||t.unregister()},this.saveSession=async function(t){Ml.debug("wallet provider: saving session");const e=JSON.stringify(t);await Ug.getInstance().setItem("@sequence.session",e)},this.useSession=async function(t,e=!0){n.session||(n.session={}),n.config.walletContext?n.session.walletContext=n.config.walletContext:t.walletContext&&(n.session.walletContext=t.walletContext),t.accountAddress&&n.useAccountAddress(t.accountAddress),t.networks&&n.useNetworks(t.networks),t.providerCache?n.transport.cachedProvider.setCache(t.providerCache):n.transport.cachedProvider.clearCache(),e&&n.saveSession(n.session)},this.config=ng({},im),e&&(this.config=ng({},this.config,e)),t?this.config.defaultNetworkId=t:this.config.defaultNetworkId||(this.config.defaultNetworkId="mainnet"),null!=e&&e.localStorage&&Ug.use(e.localStorage),this.transport={},this.networks=[],this.providers={},this.connectedSites=new Lg("@sequence.connectedSites",[]),this.utils=new nm(this),this.init()}async addConnectedSite(t){t=t||window.location.origin;const e=await this.connectedSites.get();if(e){if(e.includes(t))return;this.connectedSites.set([...e,t])}else this.connectedSites.set([t])}async removeConnectedSite(t){const e=await this.connectedSites.get();e&&this.connectedSites.set(e.filter(e=>e!==t))}getConnectedSites(){return this.connectedSites.get()}async isSiteConnected(t){const e=await this.connectedSites.get();return!!e&&e.includes(t||window.location.origin)}disconnect(){this.isOpened()&&this.closeWallet(),this.clearSession()}getProviderConfig(){return this.config}isOpened(){return this.transport.messageProvider.isOpened()}isConnected(){return void 0!==this.session&&void 0!==this.session.networks&&this.session.networks.length>0&&void 0!==this.networks&&this.networks.length>0&&!!this.session.accountAddress&&this.session.accountAddress.startsWith("0x")}getProvider(t){if(!this.isConnected()){if(t)throw new Error("session is empty. connect and try again.");return this.transport.provider}let e,n=this.networks.find(t=>t.isDefaultChain);if(t&&(n=Fp(this.networks,t),!n))throw new Error(`network ${t} is not in the network list`);if(this.providers[n.chainId])return this.providers[n.chainId];const r=n.provider?n.provider:new o.providers.JsonRpcProvider(n.rpcUrl,n.chainId);if(n.isDefaultChain){const t=new Hp([Qp,Xp,new Zp({accountAddress:this.session.accountAddress,walletContext:this.session.walletContext}),new eg(this.transport.provider),this.transport.cachedProvider],new Jp(r));e=new gg(t,n.chainId)}else{const t=new Hp([Qp,Xp,new Zp({accountAddress:this.session.accountAddress,walletContext:this.session.walletContext,chainId:n.chainId}),new eg(this.transport.provider),new Yp({defaultChainId:n.chainId})],new Jp(r));e=new gg(t,n.chainId)}return this.providers[n.chainId]=e,e}async getAuthProvider(){return this.getProvider((await this.getAuthNetwork()).chainId)}async getAuthNetwork(){return(await this.getNetworks()).find(t=>t.isAuthChain)}getAllProviders(){return this.providers}getSigner(t){return this.getProvider(t).getSigner()}async getAuthSigner(){return(await this.getAuthProvider()).getSigner()}getWalletConfig(t){return this.getSigner().getWalletConfig(t)}getWalletState(t){return this.getSigner().getWalletState(t)}getWalletContext(){return this.getSigner().getWalletContext()}isDeployed(t){return this.getSigner(t).isDeployed()}on(t,e){this.transport.messageProvider.on(t,e)}once(t,e){this.transport.messageProvider.once(t,e)}useAccountAddress(t){this.session||(this.session={}),this.session.accountAddress=s.utils.getAddress(t)}useNetworks(t){if(this.session||(this.session={}),this.session.networks=t,this.session.networks&&0!==this.session.networks.length)if(this.config.networks||this.config.networkRpcUrl){if(this.networks=t,this.config.networks&&(this.networks=t.map(t=>ng({},t)),this.config.networks.forEach(t=>{const e=Fp(this.networks,t.chainId||t.name);e&&((t,e)=>{if(t&&e){if(!t.chainId&&!t.name)throw new Error("failed to update network config: source config is missing chainId or name");if(t.chainId!==e.chainId&&t.name!==e.name)throw new Error("failed to update network config: one of chainId or name must match");t.rpcUrl&&(e.rpcUrl=t.rpcUrl,e.provider=void 0),t.provider&&(e.provider=t.provider),t.relayer&&(e.relayer=t.relayer)}})(t,e)}),Lp(this.networks,!0)),this.config.networkRpcUrl){const t=this.networks.find(t=>t.isDefaultChain);t&&(t.rpcUrl=this.config.networkRpcUrl)}}else this.networks=t}clearSession(){var t;Ml.debug("wallet provider: clearing session"),Ug.getInstance().removeItem("@sequence.session"),this.session=void 0,this.networks=[],this.providers={},null==(t=this.transport.cachedProvider)||t.clearCache()}}const im={walletAppURL:"https://sequence.app",transports:{windowTransport:{enabled:!0},proxyTransport:{enabled:!1}}};let sm;const om=async(t,e)=>sm||(sm=new rm(t,e),await sm.loadSession(t),sm),am=()=>{sm&&(sm.closeWallet(),sm.unregister())},cm=()=>{if(!sm)throw new Error("Wallet has not been initialized, call sequence.initWallet(network, config) first.");return sm};function lm(t,e){return e.forEach(function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach(function(n){if("default"!==n&&!(n in t)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})}),Object.freeze(t)}var hm=lm({__proto__:null},[r]),um=lm({__proto__:null},[i]),dm=lm({__proto__:null},[m]),fm=lm({__proto__:null},[h]),pm=lm({__proto__:null},[p]),gm=lm({__proto__:null},[u]),mm=lm({__proto__:null},[d]),ym=lm({__proto__:null},[l]),wm=lm({__proto__:null},[y]),bm=lm({__proto__:null},[w]),vm=lm({__proto__:null},[g]),Em=lm({__proto__:null},[f]),Im=lm({__proto__:null,isValidSignature:Og,isValidMessageSignature:xg,isValidTypedDataSignature:Sg,recoverWalletConfig:Rg,isWalletUpToDate:Bg},[c]),Am=Object.freeze({__proto__:null,abi:hm,api:um,auth:dm,config:fm,guard:pm,indexer:gm,metadata:mm,multicall:ym,network:wm,provider:bm,relayer:vm,transactions:Em,utils:Im,initWallet:om,getWallet:cm,Wallet:rm})},39902:(t,e,n)=>{var r,i=n(39907);!function(s){var o=Object.hasOwnProperty,a=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},c="object"==typeof i&&"function"==typeof i.nextTick,l="function"==typeof Symbol,h="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,d=l?h&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(t){var e=Object.getOwnPropertyNames(t);return e.push.apply(e,Object.getOwnPropertySymbols(t)),e}:Object.keys;function f(){this._events={},this._conf&&p.call(this,this._conf)}function p(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),t.maxListeners!==s&&(this._maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),t.ignoreErrors&&(this.ignoreErrors=t.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function g(t,e){var n="(node) warning: possible EventEmitter memory leak detected. "+t+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+e+"."),void 0!==i&&i.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=t,i.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var m=function(t,e,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[t];case 2:return[t,e];case 3:return[t,e,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function y(t,e){for(var n={},r=t.length,i=e?e.length:0,o=0;o<r;o++)n[t[o]]=o<i?e[o]:s;return n}function w(t,e,n){var r,i;if(this._emitter=t,this._target=e,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),e.addEventListener?(r=e.addEventListener,i=e.removeEventListener):e.addListener?(r=e.addListener,i=e.removeListener):e.on&&(r=e.on,i=e.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var s=t._observers;s?s.push(this):t._observers=[this]}function b(t,e,n,r){var i=Object.assign({},e);if(!t)return i;if("object"!=typeof t)throw TypeError("options must be an object");var a,c,l,h=Object.keys(t),u=h.length;function d(t){throw Error('Invalid "'+a+'" option value'+(t?". Reason: "+t:""))}for(var f=0;f<u;f++){if(a=h[f],!r&&!o.call(e,a))throw Error('Unknown "'+a+'" option');(c=t[a])!==s&&(l=n[a],i[a]=l?l(c,d):c)}return i}function v(t,e){return"function"==typeof t&&t.hasOwnProperty("prototype")||e("value must be a constructor"),t}function E(t){var e="value must be type of "+t.join("|"),n=t.length,r=t[0],i=t[1];return 1===n?function(t,n){if(typeof t===r)return t;n(e)}:2===n?function(t,n){var s=typeof t;if(s===r||s===i)return t;n(e)}:function(r,i){for(var s=typeof r,o=n;o-- >0;)if(s===t[o])return r;i(e)}}Object.assign(w.prototype,{subscribe:function(t,e,n){var r=this,i=this._target,s=this._emitter,o=this._listeners,a=function(){var r=m.apply(null,arguments),o={data:r,name:e,original:t};n?!1!==n.call(i,o)&&s.emit.apply(s,[o.name].concat(r)):s.emit.apply(s,[e].concat(r))};if(o[t])throw Error("Event '"+t+"' is already listening");this._listenersCount++,s._newListener&&s._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===e&&null===o[t]&&(o[t]=a,r._on.call(i,t,a))},s.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===e&&!s.hasListeners(n)&&o[t]&&(o[t]=null,r._off.call(i,t,a))},o[t]=null,s.on("removeListener",this._onRemoveListener)):(o[t]=a,r._on.call(i,t,a))},unsubscribe:function(t){var e,n,r,i=this,s=this._listeners,o=this._emitter,a=this._off,c=this._target;if(t&&"string"!=typeof t)throw TypeError("event must be a string");function l(){i._onNewListener&&(o.off("newListener",i._onNewListener),o.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var t=C.call(o,i);o._observers.splice(t,1)}if(t){if(!(e=s[t]))return;a.call(c,t,e),delete s[t],--this._listenersCount||l()}else{for(r=(n=d(s)).length;r-- >0;)t=n[r],a.call(c,t,s[t]);this._listeners={},this._listenersCount=0,l()}}});var I=E(["function"]),A=E(["object","function"]);function k(t,e,n){var r,i,s,o=0,a=new t(function(c,l,h){function u(){i&&(i=null),o&&(clearTimeout(o),o=0)}n=b(n,{timeout:0,overload:!1},{timeout:function(t,e){return("number"!=typeof(t*=1)||t<0||!Number.isFinite(t))&&e("timeout must be a positive number"),t}}),r=!n.overload&&"function"==typeof t.prototype.cancel&&"function"==typeof h;var d=function(t){u(),c(t)},f=function(t){u(),l(t)};r?e(d,f,h):(i=[function(t){f(t||Error("canceled"))}],e(d,f,function(t){if(s)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof t)throw TypeError("onCancel callback must be a function");i.push(t)}),s=!0),n.timeout>0&&(o=setTimeout(function(){var t=Error("timeout");t.code="ETIMEDOUT",o=0,a.cancel(t),l(t)},n.timeout))});return r||(a.cancel=function(t){if(i){for(var e=i.length,n=1;n<e;n++)i[n](t);i[0](t),i=null}}),a}function C(t){var e=this._observers;if(!e)return-1;for(var n=e.length,r=0;r<n;r++)if(e[r]._target===t)return r;return-1}function N(t,e,n,r,i){if(!n)return null;if(0===r){var s=typeof e;if("string"===s){var o,a,c=0,l=0,h=this.delimiter,u=h.length;if(-1!==(a=e.indexOf(h))){o=new Array(5);do{o[c++]=e.slice(l,a),l=a+u}while(-1!==(a=e.indexOf(h,l)));o[c++]=e.slice(l),e=o,i=c}else e=[e],i=1}else"object"===s?i=e.length:(e=[e],i=1)}var f,p,g,m,y,w,b,v=null,E=e[r],I=e[r+1];if(r===i)n._listeners&&("function"==typeof n._listeners?(t&&t.push(n._listeners),v=[n]):(t&&t.push.apply(t,n._listeners),v=[n]));else{if("*"===E){for(a=(w=d(n)).length;a-- >0;)"_listeners"!==(f=w[a])&&(b=N(t,e,n[f],r+1,i))&&(v?v.push.apply(v,b):v=b);return v}if("**"===E){for((y=r+1===i||r+2===i&&"*"===I)&&n._listeners&&(v=N(t,e,n,i,i)),a=(w=d(n)).length;a-- >0;)"_listeners"!==(f=w[a])&&("*"===f||"**"===f?(n[f]._listeners&&!y&&(b=N(t,e,n[f],i,i))&&(v?v.push.apply(v,b):v=b),b=N(t,e,n[f],r,i)):b=N(t,e,n[f],f===I?r+2:r,i),b&&(v?v.push.apply(v,b):v=b));return v}n[E]&&(v=N(t,e,n[E],r+1,i))}if((p=n["*"])&&N(t,e,p,r+1,i),g=n["**"])if(r<i)for(g._listeners&&N(t,e,g,i,i),a=(w=d(g)).length;a-- >0;)"_listeners"!==(f=w[a])&&(f===I?N(t,e,g[f],r+2,i):f===E?N(t,e,g[f],r+1,i):((m={})[f]=g[f],N(t,e,{"**":m},r+1,i)));else g._listeners?N(t,e,g,i,i):g["*"]&&g["*"]._listeners&&N(t,e,g["*"],i,i);return v}function T(t,e,n){var r,i,s=0,o=0,a=this.delimiter,c=a.length;if("string"==typeof t)if(-1!==(r=t.indexOf(a))){i=new Array(5);do{i[s++]=t.slice(o,r),o=r+c}while(-1!==(r=t.indexOf(a,o)));i[s++]=t.slice(o)}else i=[t],s=1;else i=t,s=t.length;if(s>1)for(r=0;r+1<s;r++)if("**"===i[r]&&"**"===i[r+1])return;var l,h=this.listenerTree;for(r=0;r<s;r++)if(h=h[l=i[r]]||(h[l]={}),r===s-1)return h._listeners?("function"==typeof h._listeners&&(h._listeners=[h._listeners]),n?h._listeners.unshift(e):h._listeners.push(e),!h._listeners.warned&&this._maxListeners>0&&h._listeners.length>this._maxListeners&&(h._listeners.warned=!0,g.call(this,h._listeners.length,l))):h._listeners=e,!0;return!0}function O(t,e,n,r){for(var i,s,o,a,c=d(t),l=c.length,h=t._listeners;l-- >0;)i=t[s=c[l]],o="_listeners"===s?n:n?n.concat(s):[s],a=r||"symbol"==typeof s,h&&e.push(a?o:o.join(this.delimiter)),"object"==typeof i&&O.call(this,i,e,o,a);return e}function x(t){for(var e,n,r,i=d(t),s=i.length;s-- >0;)(e=t[n=i[s]])&&(r=!0,"_listeners"===n||x(e)||delete t[n]);return r}function S(t,e,n){this.emitter=t,this.event=e,this.listener=n}function R(t,e,n){if(!0===n)o=!0;else if(!1===n)r=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var r=n.async,o=n.promisify,a=n.nextTick,l=n.objectify}if(r||a||o){var h=e,d=e._origin||e;if(a&&!c)throw Error("process.nextTick is not supported");o===s&&(o="AsyncFunction"===e.constructor.name),e=function(){var t=arguments,e=this,n=this.event;return o?a?Promise.resolve():new Promise(function(t){u(t)}).then(function(){return e.event=n,h.apply(e,t)}):(a?i.nextTick:u)(function(){e.event=n,h.apply(e,t)})},e._async=!0,e._origin=d}return[e,l?new S(this,t,e):this]}function _(t){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,p.call(this,t)}S.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},_.EventEmitter2=_,_.prototype.listenTo=function(t,e,n){if("object"!=typeof t)throw TypeError("target musts be an object");var r=this;function i(e){if("object"!=typeof e)throw TypeError("events must be an object");var i,s=n.reducers,o=C.call(r,t);i=-1===o?new w(r,t,n):r._observers[o];for(var a,c=d(e),l=c.length,h="function"==typeof s,u=0;u<l;u++)a=c[u],i.subscribe(a,e[a]||a,h?s:s&&s[a])}return n=b(n,{on:s,off:s,reducers:s},{on:I,off:I,reducers:A}),a(e)?i(y(e)):i("string"==typeof e?y(e.split(/\s+/)):e),this},_.prototype.stopListeningTo=function(t,e){var n=this._observers;if(!n)return!1;var r,i=n.length,s=!1;if(t&&"object"!=typeof t)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],t&&r._target!==t||(r.unsubscribe(e),s=!0);return s},_.prototype.delimiter=".",_.prototype.setMaxListeners=function(t){t!==s&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},_.prototype.getMaxListeners=function(){return this._maxListeners},_.prototype.event="",_.prototype.once=function(t,e,n){return this._once(t,e,!1,n)},_.prototype.prependOnceListener=function(t,e,n){return this._once(t,e,!0,n)},_.prototype._once=function(t,e,n,r){return this._many(t,1,e,n,r)},_.prototype.many=function(t,e,n,r){return this._many(t,e,n,!1,r)},_.prototype.prependMany=function(t,e,n,r){return this._many(t,e,n,!0,r)},_.prototype._many=function(t,e,n,r,i){var s=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function o(){return 0===--e&&s.off(t,o),n.apply(this,arguments)}return o._origin=n,this._on(t,o,r,i)},_.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||f.call(this);var t,e,n,r,i,s,o=arguments[0],a=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return!1;if(a&&(t=o,"newListener"!==o&&"removeListener"!==o&&"object"==typeof o)){if(n=o.length,l)for(r=0;r<n;r++)if("symbol"==typeof o[r]){s=!0;break}s||(o=o.join(this.delimiter))}var c,h=arguments.length;if(this._all&&this._all.length)for(r=0,n=(c=this._all.slice()).length;r<n;r++)switch(this.event=o,h){case 1:c[r].call(this,o);break;case 2:c[r].call(this,o,arguments[1]);break;case 3:c[r].call(this,o,arguments[1],arguments[2]);break;default:c[r].apply(this,arguments)}if(a)c=[],N.call(this,c,t,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[o])){switch(this.event=o,h){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=new Array(h-1),i=1;i<h;i++)e[i-1]=arguments[i];c.apply(this,e)}return!0}c&&(c=c.slice())}if(c&&c.length){if(h>3)for(e=new Array(h-1),i=1;i<h;i++)e[i-1]=arguments[i];for(r=0,n=c.length;r<n;r++)switch(this.event=o,h){case 1:c[r].call(this);break;case 2:c[r].call(this,arguments[1]);break;case 3:c[r].call(this,arguments[1],arguments[2]);break;default:c[r].apply(this,e)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===o)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},_.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||f.call(this);var t,e,n,r,i,s,o=arguments[0],a=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(a&&(t=o,"newListener"!==o&&"removeListener"!==o&&"object"==typeof o)){if(r=o.length,l)for(i=0;i<r;i++)if("symbol"==typeof o[i]){e=!0;break}e||(o=o.join(this.delimiter))}var c,h=[],u=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=o,u){case 1:h.push(this._all[i].call(this,o));break;case 2:h.push(this._all[i].call(this,o,arguments[1]));break;case 3:h.push(this._all[i].call(this,o,arguments[1],arguments[2]));break;default:h.push(this._all[i].apply(this,arguments))}if(a?(c=[],N.call(this,c,t,this.listenerTree,0)):c=this._events[o],"function"==typeof c)switch(this.event=o,u){case 1:h.push(c.call(this));break;case 2:h.push(c.call(this,arguments[1]));break;case 3:h.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(u-1),s=1;s<u;s++)n[s-1]=arguments[s];h.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),u>3)for(n=new Array(u-1),s=1;s<u;s++)n[s-1]=arguments[s];for(i=0,r=c.length;i<r;i++)switch(this.event=o,u){case 1:h.push(c[i].call(this));break;case 2:h.push(c[i].call(this,arguments[1]));break;case 3:h.push(c[i].call(this,arguments[1],arguments[2]));break;default:h.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===o)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(h)},_.prototype.on=function(t,e,n){return this._on(t,e,!1,n)},_.prototype.prependListener=function(t,e,n){return this._on(t,e,!0,n)},_.prototype.onAny=function(t){return this._onAny(t,!1)},_.prototype.prependAny=function(t){return this._onAny(t,!0)},_.prototype.addListener=_.prototype.on,_.prototype._onAny=function(t,e){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),e?this._all.unshift(t):this._all.push(t),this},_.prototype._on=function(t,e,n,r){if("function"==typeof t)return this._onAny(t,e),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");this._events||f.call(this);var i,o=this;return r!==s&&(e=(i=R.call(this,t,e,r))[0],o=i[1]),this._newListener&&this.emit("newListener",t,e),this.wildcard?(T.call(this,t,e,n),o):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),n?this._events[t].unshift(e):this._events[t].push(e),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,g.call(this,this._events[t].length,t))):this._events[t]=e,o)},_.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof t?t.split(this.delimiter):t.slice();if(!(r=N.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[t])return this;n=this._events[t],r.push({_listeners:n})}for(var s=0;s<r.length;s++){var o=r[s];if(n=o._listeners,a(n)){for(var c=-1,l=0,h=n.length;l<h;l++)if(n[l]===e||n[l].listener&&n[l].listener===e||n[l]._origin&&n[l]._origin===e){c=l;break}if(c<0)continue;return this.wildcard?o._listeners.splice(c,1):this._events[t].splice(c,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[t]),this._removeListener&&this.emit("removeListener",t,e),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete o._listeners:delete this._events[t],this._removeListener&&this.emit("removeListener",t,e))}return this.listenerTree&&x(this.listenerTree),this},_.prototype.offAny=function(t){var e,n=0,r=0;if(t&&this._all&&this._all.length>0){for(n=0,r=(e=this._all).length;n<r;n++)if(t===e[n])return e.splice(n,1),this._removeListener&&this.emit("removeListenerAny",t),this}else{if(e=this._all,this._removeListener)for(n=0,r=e.length;n<r;n++)this.emit("removeListenerAny",e[n]);this._all=[]}return this},_.prototype.removeListener=_.prototype.off,_.prototype.removeAllListeners=function(t){if(t===s)return!this._events||f.call(this),this;if(this.wildcard){var e,n=N.call(this,null,t,this.listenerTree,0);if(!n)return this;for(e=0;e<n.length;e++)n[e]._listeners=null;this.listenerTree&&x(this.listenerTree)}else this._events&&(this._events[t]=null);return this},_.prototype.listeners=function(t){var e,n,r,i,o,a=this._events;if(t===s){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(i=(e=d(a)).length,r=[];i-- >0;)"function"==typeof(n=a[e[i]])?r.push(n):r.push.apply(r,n);return r}if(this.wildcard){if(!(o=this.listenerTree))return[];var c=[],l="string"==typeof t?t.split(this.delimiter):t.slice();return N.call(this,c,l,o,0),c}return a&&(n=a[t])?"function"==typeof n?[n]:n:[]},_.prototype.eventNames=function(t){var e=this._events;return this.wildcard?O.call(this,this.listenerTree,[],null,t):e?d(e):[]},_.prototype.listenerCount=function(t){return this.listeners(t).length},_.prototype.hasListeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return N.call(this,e,n,this.listenerTree,0),e.length>0}var r=this._events,i=this._all;return!!(i&&i.length||r&&(t===s?d(r).length:r[t]))},_.prototype.listenersAny=function(){return this._all?this._all:[]},_.prototype.waitFor=function(t,e){var n=this,r=typeof e;return"number"===r?e={timeout:e}:"function"===r&&(e={filter:e}),k((e=b(e,{timeout:0,filter:s,handleError:!1,Promise,overload:!1},{filter:I,Promise:v})).Promise,function(r,i,s){function o(){var s=e.filter;if(!s||s.apply(n,arguments))if(n.off(t,o),e.handleError){var a=arguments[0];a?i(a):r(m.apply(null,arguments).slice(1))}else r(m.apply(null,arguments))}s(function(){n.off(t,o)}),n._on(t,o,!1)},{timeout:e.timeout,overload:e.overload})};var P=_.prototype;Object.defineProperties(_,{defaultMaxListeners:{get:function(){return P._maxListeners},set:function(t){if("number"!=typeof t||t<0||Number.isNaN(t))throw TypeError("n must be a non-negative number");P._maxListeners=t},enumerable:!0},once:{value:function(t,e,n){return k((n=b(n,{Promise,timeout:0,overload:!1},{Promise:v})).Promise,function(n,r,i){var s;if("function"==typeof t.addEventListener)return s=function(){n(m.apply(null,arguments))},i(function(){t.removeEventListener(e,s)}),void t.addEventListener(e,s,{once:!0});var o,a=function(){o&&t.removeListener("error",o),n(m.apply(null,arguments))};"error"!==e&&(o=function(n){t.removeListener(e,a),r(n)},t.once("error",o)),i(function(){o&&t.removeListener("error",o),t.removeListener(e,a)}),t.once(e,a)},{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(P,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(r=function(){return _}.call(e,n,e,t))===s||(t.exports=r)}()}}]);